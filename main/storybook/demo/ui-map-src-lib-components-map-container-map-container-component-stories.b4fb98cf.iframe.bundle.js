(self.webpackChunkgeonetwork_ui=self.webpackChunkgeonetwork_ui||[]).push([[4622],{"./libs/ui/map/src/lib/components/map-container/map-container.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{L:()=>MapContainerComponent});var asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var map_container_componentngResource=__webpack_require__("./libs/ui/map/src/lib/components/map-container/map-container.component.css?ngResource"),map_container_componentngResource_default=__webpack_require__.n(map_container_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),merge=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/merge.js"),fromEvent=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/fromEvent.js"),timer=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/timer.js"),of=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js"),map=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),switchMap=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/switchMap.js"),startWith=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/startWith.js"),delay=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/delay.js"),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),ngx_translate_core=__webpack_require__("./node_modules/@ngx-translate/core/fesm2020/ngx-translate-core.mjs"),dist=__webpack_require__("./node_modules/@geospatial-sdk/core/dist/index.js"),openlayers_dist=__webpack_require__("./node_modules/@geospatial-sdk/openlayers/dist/index.js"),map_settings_token=__webpack_require__("./libs/ui/map/src/lib/components/map-container/map-settings.token.ts"),ng_icons_core=__webpack_require__("./node_modules/@ng-icons/core/fesm2022/ng-icons-core.mjs"),ng_icons_material_icons_outline=__webpack_require__("./node_modules/@ng-icons/material-icons/fesm2022/ng-icons-material-icons-outline.mjs");const DEFAULT_BASEMAP_LAYER={type:"xyz",url:"https://{a-c}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}.png",attributions:'<span>© <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, © <a href="https://carto.com/">Carto</a></span>'},DEFAULT_VIEW={center:[0,15],zoom:2};let MapContainerComponent=class MapContainerComponent{get featuresClick(){return this._featuresClick||(this.openlayersMap.then((olMap=>{(0,openlayers_dist.KT)(olMap,dist.QS,(({features})=>this._featuresClick.emit(features)))})),this._featuresClick=new core.EventEmitter),this._featuresClick}get featuresHover(){return this._featuresHover||(this.openlayersMap.then((olMap=>{(0,openlayers_dist.KT)(olMap,dist.UH,(({features})=>this._featuresHover.emit(features)))})),this._featuresHover=new core.EventEmitter),this._featuresHover}get mapClick(){return this._mapClick||(this.openlayersMap.then((olMap=>{(0,openlayers_dist.KT)(olMap,dist.fD,(({coordinate})=>this._mapClick.emit(coordinate)))})),this._mapClick=new core.EventEmitter),this._mapClick}constructor(doNotUseDefaultBasemap,basemapLayers,mapViewConstraints){this.doNotUseDefaultBasemap=doNotUseDefaultBasemap,this.basemapLayers=basemapLayers,this.mapViewConstraints=mapViewConstraints,this.openlayersMap=new Promise((resolve=>{this.olMapResolver=resolve}))}ngAfterViewInit(){var _this=this;return(0,asyncToGenerator.A)((function*(){_this.olMap=yield(0,openlayers_dist.gJ)(_this.processContext(_this.context),_this.container.nativeElement),_this.displayMessage$=(0,merge.h)((0,fromEvent.R)(_this.olMap,"mapmuted").pipe((0,map.T)((()=>!0))),(0,fromEvent.R)(_this.olMap,"movestart").pipe((0,map.T)((()=>!1))),(0,fromEvent.R)(_this.olMap,"singleclick").pipe((0,map.T)((()=>!1)))).pipe((0,switchMap.n)((muted=>muted?(0,timer.O)(2e3).pipe((0,map.T)((()=>!1)),(0,startWith.Z)(!0),(0,delay.c)(400)):(0,of.of)(!1)))),_this.olMapResolver(_this.olMap)}))()}ngOnChanges(changes){var _this2=this;return(0,asyncToGenerator.A)((function*(){if("context"in changes&&!changes.context.isFirstChange()){const diff=(0,dist.mm)(_this2.processContext(changes.context.currentValue),_this2.processContext(changes.context.previousValue));yield(0,openlayers_dist.KP)(_this2.olMap,diff)}}))()}processContext(context){const processed=context?{...context,view:context.view??DEFAULT_VIEW}:{layers:[],view:DEFAULT_VIEW};return this.basemapLayers.length&&(processed.layers=[...this.basemapLayers,...processed.layers]),this.doNotUseDefaultBasemap||(processed.layers=[DEFAULT_BASEMAP_LAYER,...processed.layers]),this.mapViewConstraints.maxZoom&&(processed.view={maxZoom:this.mapViewConstraints.maxZoom,...processed.view}),this.mapViewConstraints.maxExtent&&(processed.view={maxExtent:this.mapViewConstraints.maxExtent,...processed.view}),!processed.view||"zoom"in processed.view||"center"in processed.view||(this.mapViewConstraints.maxExtent?processed.view={extent:this.mapViewConstraints.maxExtent,...processed.view}:processed.view={...DEFAULT_VIEW,...processed.view}),processed}static#_=this.ctorParameters=()=>[{type:Boolean,decorators:[{type:core.Inject,args:[map_settings_token.Mo]}]},{type:Array,decorators:[{type:core.Inject,args:[map_settings_token.p0]}]},{type:void 0,decorators:[{type:core.Inject,args:[map_settings_token.ay]}]}];static#_2=this.propDecorators={context:[{type:core.Input}],featuresClick:[{type:core.Output}],featuresHover:[{type:core.Output}],mapClick:[{type:core.Output}],container:[{type:core.ViewChild,args:["map"]}]}};MapContainerComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"gn-ui-map-container",template:'<div class="h-full w-full" #map></div>\n<div\n  class="absolute inset-0 p-2 rounded z-40 transition-all flex flex-col justify-center items-center text-primary font-sans pointer-events-none"\n  [ngClass]="\n    (displayMessage$ | async) ? \'visible opacity-100\' : \'invisible opacity-0\'\n  "\n>\n  <div\n    class="absolute z-[-1] inset-0 bg-gradient-to-b from-white to-primary-lightest opacity-60"\n  ></div>\n  <ng-icon\n    class="!w-16 !h-16 text-[64px] mb-4"\n    name="matSwipeOutline"\n  ></ng-icon>\n  <p translate>map.navigation.message</p>\n</div>\n',changeDetection:core.ChangeDetectionStrategy.OnPush,standalone:!0,imports:[common.CommonModule,ngx_translate_core.h,ng_icons_core.Uq],providers:[(0,ng_icons_core.EB)({matSwipeOutline:ng_icons_material_icons_outline.RKP}),(0,ng_icons_core.PG)({size:"1.5em"})],styles:[map_container_componentngResource_default()]}),(0,tslib_es6.Sn)("design:paramtypes",[Boolean,Array,Object])],MapContainerComponent)},"./libs/ui/map/src/lib/components/map-container/map-settings.token.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Mo:()=>DO_NOT_USE_DEFAULT_BASEMAP,ay:()=>MAP_VIEW_CONSTRAINTS,p0:()=>BASEMAP_LAYERS});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs");const DO_NOT_USE_DEFAULT_BASEMAP=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.InjectionToken("doNotUseDefaultBasemap",{factory:()=>!1}),BASEMAP_LAYERS=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.InjectionToken("basemapLayers",{factory:()=>[]}),MAP_VIEW_CONSTRAINTS=new _angular_core__WEBPACK_IMPORTED_MODULE_0__.InjectionToken("mapViewConstraints",{factory:()=>({})});new _angular_core__WEBPACK_IMPORTED_MODULE_0__.InjectionToken("vectorStyleDefault",{factory:()=>({fill:{color:"rgba(255, 255, 255, 0.2)"},stroke:{color:"#ffcc33",width:2}})})},"./libs/ui/map/src/lib/components/map-container/map-container.component.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Primary:()=>Primary,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _storybook_angular__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@storybook/angular/dist/index.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),_map_container_component__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./libs/ui/map/src/lib/components/map-container/map-container.component.ts"),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@ngx-translate/core/fesm2020/ngx-translate-core.mjs"),_geonetwork_ui_common_fixtures__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./libs/common/fixtures/src/index.ts");const __WEBPACK_DEFAULT_EXPORT__={title:"Map/Map Container",component:_map_container_component__WEBPACK_IMPORTED_MODULE_1__.L,decorators:[(0,_storybook_angular__WEBPACK_IMPORTED_MODULE_0__.applicationConfig)({providers:[(0,_angular_core__WEBPACK_IMPORTED_MODULE_3__.importProvidersFrom)(_ngx_translate_core__WEBPACK_IMPORTED_MODULE_4__.h.forRoot())]}),(0,_storybook_angular__WEBPACK_IMPORTED_MODULE_0__.componentWrapperDecorator)((story=>`\n          <div class="border border-gray-300" style="width: 500px; height: 300px; resize: both; overflow: auto">\n             ${story}\n          </div>`))],argTypes:{featuresClicked:{action:"featuresClicked"},featuresHover:{action:"featuresHover"},mapClick:{action:"mapClick"}}},Primary={args:{context:(0,_geonetwork_ui_common_fixtures__WEBPACK_IMPORTED_MODULE_2__.Vr)()}}},"./libs/ui/map/src/lib/components/map-container/map-container.component.css?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,"",""]),module.exports=___CSS_LOADER_EXPORT___.toString()}}]);