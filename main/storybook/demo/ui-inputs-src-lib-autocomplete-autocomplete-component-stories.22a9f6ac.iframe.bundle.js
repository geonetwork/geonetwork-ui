(self.webpackChunkgeonetwork_ui=self.webpackChunkgeonetwork_ui||[]).push([[5770],{"./libs/ui/inputs/src/lib/autocomplete/autocomplete.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{s:()=>AutocompleteComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var autocomplete_componentngResource=__webpack_require__("./libs/ui/inputs/src/lib/autocomplete/autocomplete.component.css?ngResource"),autocomplete_componentngResource_default=__webpack_require__.n(autocomplete_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),fesm2022_forms=__webpack_require__("./node_modules/@angular/forms/fesm2022/forms.mjs"),autocomplete=__webpack_require__("./node_modules/@angular/material/fesm2022/autocomplete.mjs"),ReplaySubject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/ReplaySubject.js"),Subscription=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subscription.js"),merge=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/merge.js"),of=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js"),first=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/first.js"),map=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),filter=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js"),distinctUntilChanged=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/distinctUntilChanged.js"),debounceTime=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/debounceTime.js"),tap=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/tap.js"),switchMap=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/switchMap.js"),catchError=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/catchError.js"),finalize=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/finalize.js"),take=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/take.js"),src=__webpack_require__("./libs/ui/widgets/src/index.ts"),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),ngx_translate_core=__webpack_require__("./node_modules/@ngx-translate/core/dist/fesm2022/ngx-translate-core.mjs"),button_component=__webpack_require__("./libs/ui/inputs/src/lib/button/button.component.ts"),ng_icons_core=__webpack_require__("./node_modules/@ng-icons/core/fesm2022/ng-icons-core.mjs"),ng_icons_iconoir=__webpack_require__("./node_modules/@ng-icons/iconoir/fesm2022/ng-icons-iconoir.mjs"),ng_icons_material_icons_baseline=__webpack_require__("./node_modules/@ng-icons/material-icons/fesm2022/ng-icons-material-icons-baseline.mjs");let AutocompleteComponent=class AutocompleteComponent{constructor(cdRef){this.cdRef=cdRef,this.clearOnSelection=!1,this.preventCompleteOnSelection=!1,this.autoFocus=!1,this.minCharacterCount=3,this.allowSubmit=!1,this.itemSelected=new core.EventEmitter,this.inputSubmitted=new core.EventEmitter,this.inputCleared=new core.EventEmitter,this.control=new fesm2022_forms.hs,this.cancelEnter=!0,this.selectionSubject=new ReplaySubject.m(1),this.lastInputValue$=new ReplaySubject.m(1),this.error=null,this.subscription=new Subscription.yU,this.displayWithFn=item=>item.toString(),this.displayWithFnInternal=item=>null==item?null:this.displayWithFn(item)}ngOnChanges(changes){const{value}=changes;if(value){this.displayWithFnInternal(value.previousValue)!==this.displayWithFnInternal(value.currentValue)&&this.updateInputValue(value.currentValue)}}ngOnInit(){const newValue$=(0,merge.h)((0,of.of)(""),this.inputCleared.pipe((0,map.T)((()=>""))),this.control.valueChanges.pipe((0,filter.p)((value=>"string"==typeof value)),(0,distinctUntilChanged.F)(),(0,debounceTime.B)(400))),externalValueChange$=this.control.valueChanges.pipe((0,filter.p)((value=>"object"==typeof value&&value.title)),(0,map.T)((item=>item.title))),suggestionsFromAction=(0,merge.h)(newValue$.pipe((0,filter.p)((value=>value.length>=this.minCharacterCount))),externalValueChange$).pipe((0,tap.M)((()=>{this.searching=!0,this.error=null})),(0,switchMap.n)((value=>this.action(value))),(0,catchError.W)((error=>(this.error=error.message,(0,of.of)([])))),(0,finalize.j)((()=>this.searching=!1)));this.suggestions$=(0,merge.h)(suggestionsFromAction,newValue$.pipe((0,filter.p)((value=>value.length<this.minCharacterCount)),(0,map.T)((()=>[])))),this.subscription.add(this.suggestions$.pipe((0,filter.p)((suggestions=>0===suggestions.length))).subscribe((()=>{this.triggerRef?.closePanel()}))),this.subscription.add(this.control.valueChanges.subscribe((any=>{""!==any&&(this.cancelEnter=!1)}))),this.control.valueChanges.pipe((0,filter.p)((value=>"string"==typeof value))).subscribe(this.lastInputValue$)}ngAfterViewInit(){this.autocomplete.optionSelected.subscribe(this.selectionSubject),this.autoFocus&&(this.inputRef.nativeElement.focus(),this.cdRef.detectChanges())}ngOnDestroy(){this.subscription?.unsubscribe()}updateInputValue(value){value&&this.control.setValue(value),this.inputRef&&(this.inputRef.nativeElement.value=value?.title||"")}clear(){this.inputRef.nativeElement.value="",this.inputCleared.emit(),this.selectionSubject.pipe((0,take.s)(1)).subscribe((selection=>selection&&selection.option.deselect())),this.inputRef.nativeElement.focus()}handleEnter(any){!this.cancelEnter&&this.allowSubmit&&this.inputSubmitted.emit(any)}handleClickSearch(){this.inputSubmitted.emit(this.inputRef.nativeElement.value)}handleSelection(event){this.cancelEnter=!0,this.itemSelected.emit(event.option.value),this.preventCompleteOnSelection?this.lastInputValue$.pipe((0,first.$)()).subscribe((lastInputValue=>{this.inputRef.nativeElement.value=lastInputValue})):this.clearOnSelection&&(this.inputRef.nativeElement.value="",this.control.setValue(""))}static{this.ctorParameters=()=>[{type:core.ChangeDetectorRef}]}static{this.propDecorators={placeholder:[{type:core.Input}],action:[{type:core.Input}],value:[{type:core.Input}],clearOnSelection:[{type:core.Input}],preventCompleteOnSelection:[{type:core.Input}],autoFocus:[{type:core.Input}],minCharacterCount:[{type:core.Input}],allowSubmit:[{type:core.Input}],itemSelected:[{type:core.Output}],inputSubmitted:[{type:core.Output}],inputCleared:[{type:core.Output}],triggerRef:[{type:core.ViewChild,args:[autocomplete.pN]}],autocomplete:[{type:core.ViewChild,args:[autocomplete.$3]}],inputRef:[{type:core.ViewChild,args:["searchInput"]}],displayWithFn:[{type:core.Input}]}}};AutocompleteComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"gn-ui-autocomplete",template:'<span class="w-full inline-block relative">\n  <div\n    class="absolute inset-y-[--icon-padding] left-[--icon-padding] w-[--icon-width] pointer-events-none"\n    *ngIf="!allowSubmit"\n  >\n    <ng-icon name="iconoirSearch" class="text-primary search"></ng-icon>\n  </div>\n  <input\n    #searchInput\n    type="text"\n    class="gn-ui-text-input"\n    [ngClass]="{\n      \'px-[--icon-width]\': !allowSubmit,\n    }"\n    [placeholder]="placeholder"\n    [formControl]="control"\n    [matAutocomplete]="auto"\n    (keyup.enter)="handleEnter(searchInput.value)"\n  />\n  <gn-ui-button\n    type="light"\n    extraClass="border-0 text-primary-lightest hover:text-primary focus:text-primary absolute inset-y-[--icon-padding] {{\n      allowSubmit\n        ? \'right-[calc(var(--icon-width)+var(--icon-padding))]\'\n        : \'right-[--icon-padding]\'\n    }}"\n    data-test="clear-btn"\n    *ngIf="searchInput.value"\n    aria-label="Clear"\n    (buttonClick)="clear()"\n  >\n    <ng-icon name="matClose"></ng-icon>\n  </gn-ui-button>\n  <gn-ui-button\n    type="light"\n    extraClass="border-0 border-l-[1px] border-gray-300 hover:border-gray-500 text-primary hover:text-primary-darkest focus:text-primary-darkest absolute inset-y-[--icon-padding] right-[--icon-padding]"\n    aria-label="Trigger search"\n    *ngIf="allowSubmit"\n    data-test="autocomplete-submit-btn"\n    (buttonClick)="handleClickSearch()"\n  >\n    <ng-icon name="iconoirSearch"></ng-icon>\n  </gn-ui-button>\n\n  <gn-ui-popup-alert\n    *ngIf="error"\n    class="absolute mt-2 w-full top-[100%] left-0"\n    icon="matErrorOutlineOutline"\n    position="top"\n    type="warning"\n  >\n    <span translate>search.autocomplete.error</span>\n    {{ error }}\n  </gn-ui-popup-alert>\n</span>\n\n<mat-autocomplete\n  #auto="matAutocomplete"\n  (optionSelected)="handleSelection($event)"\n  [displayWith]="displayWithFnInternal"\n>\n  <mat-option\n    *ngFor="let suggestion of suggestions$ | async"\n    [value]="suggestion"\n    class="p-2 suggestion"\n  >\n    {{ displayWithFnInternal(suggestion) }}\n  </mat-option>\n</mat-autocomplete>\n',changeDetection:core.ChangeDetectionStrategy.OnPush,standalone:!0,imports:[src.oz,autocomplete.jL,common.CommonModule,ngx_translate_core.h,fesm2022_forms.X1,button_component.Q,ng_icons_core.Uq],providers:[(0,ng_icons_core.EB)({iconoirSearch:ng_icons_iconoir.oub,matClose:ng_icons_material_icons_baseline.ju0}),(0,ng_icons_core.PG)({size:"1.5rem"})],styles:[autocomplete_componentngResource_default()]}),(0,tslib_es6.Sn)("design:paramtypes",[core.ChangeDetectorRef])],AutocompleteComponent)},"./libs/ui/inputs/src/lib/button/button.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Q:()=>ButtonComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var button_componentngResource=__webpack_require__("./libs/ui/inputs/src/lib/button/button.component.css?ngResource"),button_componentngResource_default=__webpack_require__.n(button_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),src=__webpack_require__("./libs/util/shared/src/index.ts");let ButtonComponent=class ButtonComponent{constructor(){this.btnClass="gn-ui-btn-default",this.disabled=!1,this.extraClass="",this.buttonClick=new core.EventEmitter}set type(value){switch(value){case"primary":this.btnClass="gn-ui-btn-primary";break;case"secondary":this.btnClass="gn-ui-btn-secondary";break;case"outline":this.btnClass="gn-ui-btn-outline";break;case"light":this.btnClass="gn-ui-btn-light";break;case"gray":this.btnClass="gn-ui-btn-gray";break;case"black":this.btnClass="gn-ui-btn-black";break;default:this.btnClass="gn-ui-btn-default"}}get classList(){return`${this.btnClass} ${this.extraClass}`}handleClick(event){this.buttonClick.emit(),event.preventDefault(),event.currentTarget.blur(),(0,src.Y8)(event)}static{this.propDecorators={type:[{type:core.Input}],disabled:[{type:core.Input}],extraClass:[{type:core.Input}],buttonClick:[{type:core.Output}]}}};ButtonComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"gn-ui-button",template:'<button\n  type="button"\n  [class]="classList"\n  [disabled]="disabled"\n  (click)="handleClick($event)"\n>\n  <ng-content></ng-content>\n</button>\n',changeDetection:core.ChangeDetectionStrategy.OnPush,standalone:!0,styles:[button_componentngResource_default()]})],ButtonComponent)},"./node_modules/rxjs/dist/esm5/internal/observable/throwError.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$:()=>throwError});var _Observable__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Observable.js"),_util_isFunction__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/util/isFunction.js");function throwError(errorOrErrorFactory,scheduler){var errorFactory=(0,_util_isFunction__WEBPACK_IMPORTED_MODULE_0__.T)(errorOrErrorFactory)?errorOrErrorFactory:function(){return errorOrErrorFactory},init=function(subscriber){return subscriber.error(errorFactory())};return new _Observable__WEBPACK_IMPORTED_MODULE_1__.c(scheduler?function(subscriber){return scheduler.schedule(init,0,subscriber)}:init)}},"./libs/ui/inputs/src/lib/autocomplete/autocomplete.component.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{NoMinimumCharacterCount:()=>NoMinimumCharacterCount,NoSubmit:()=>NoSubmit,SubmitAllowed:()=>SubmitAllowed,WithCustomStyle:()=>WithCustomStyle,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _storybook_angular__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@storybook/angular/dist/index.mjs"),_autocomplete_component__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./libs/ui/inputs/src/lib/autocomplete/autocomplete.component.ts"),rxjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/throwError.js"),rxjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js"),_ngx_translate_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@ngx-translate/core/dist/fesm2022/ngx-translate-core.mjs"),_geonetwork_ui_util_i18n__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./libs/util/i18n/src/index.ts"),_angular_platform_browser_animations__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@angular/platform-browser/fesm2022/animations.mjs");const __WEBPACK_DEFAULT_EXPORT__={title:"Inputs/AutocompleteComponent",component:_autocomplete_component__WEBPACK_IMPORTED_MODULE_1__.s,decorators:[(0,_storybook_angular__WEBPACK_IMPORTED_MODULE_0__.moduleMetadata)({imports:[_autocomplete_component__WEBPACK_IMPORTED_MODULE_1__.s,_geonetwork_ui_util_i18n__WEBPACK_IMPORTED_MODULE_2__.D7,_ngx_translate_core__WEBPACK_IMPORTED_MODULE_3__.h.forRoot(_geonetwork_ui_util_i18n__WEBPACK_IMPORTED_MODULE_2__.sU),_angular_platform_browser_animations__WEBPACK_IMPORTED_MODULE_4__.BrowserAnimationsModule]})]},initialItems=["Hello","world","from","storybook"];function filterResults(value){return initialItems.filter((item=>item.toLowerCase().includes(value?.toLowerCase())))}const SubmitAllowed={args:{placeholder:"Full text search",minCharacterCount:3,actionThrowsError:!1,clearOnSelection:!1,allowSubmit:!0},argTypes:{itemSelected:{action:"itemSelected"},inputSubmitted:{action:"inputSubmitted"},actionThrowsError:{type:"boolean"}},render:args=>({props:{...args,action:value=>args.actionThrowsError?(0,rxjs__WEBPACK_IMPORTED_MODULE_5__.$)((()=>new Error("Something went terribly wrong!"))):(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.of)(filterResults(value))}})},NoSubmit={args:{placeholder:"This will only show suggestions, there is no submit button",minCharacterCount:3,actionThrowsError:!1,clearOnSelection:!1,allowSubmit:!1},argTypes:{itemSelected:{action:"itemSelected"},inputSubmitted:{action:"inputSubmitted"},actionThrowsError:{type:"boolean"}},render:args=>({props:{...args,action:value=>args.actionThrowsError?(0,rxjs__WEBPACK_IMPORTED_MODULE_5__.$)((()=>new Error("Something went terribly wrong!"))):(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.of)(filterResults(value))}})},WithCustomStyle={...NoSubmit,render:args=>({props:args,styles:[":host { --gn-ui-text-input-rounded: 10px; --gn-ui-text-input-padding: 20px; --gn-ui-text-input-font-size: 18px }"]})},NoMinimumCharacterCount={args:{placeholder:"Click to show suggestions! selecting one should clear this field",minCharacterCount:0,clearOnSelection:!0},argTypes:{itemSelected:{action:"itemSelected"},inputSubmitted:{action:"inputSubmitted"}},render:args=>({props:{...args,action:value=>(0,rxjs__WEBPACK_IMPORTED_MODULE_6__.of)(filterResults(value))}})},__namedExportsOrder=["SubmitAllowed","NoSubmit","WithCustomStyle","NoMinimumCharacterCount"];SubmitAllowed.parameters={...SubmitAllowed.parameters,docs:{...SubmitAllowed.parameters?.docs,source:{originalSource:"{\n  args: {\n    placeholder: 'Full text search',\n    minCharacterCount: 3,\n    actionThrowsError: false,\n    clearOnSelection: false,\n    allowSubmit: true\n  },\n  argTypes: {\n    itemSelected: {\n      action: 'itemSelected'\n    },\n    inputSubmitted: {\n      action: 'inputSubmitted'\n    },\n    actionThrowsError: {\n      type: 'boolean'\n    }\n  },\n  render: args => ({\n    props: {\n      ...args,\n      action: (value: string) => args.actionThrowsError ? throwError(() => new Error('Something went terribly wrong!')) : of(filterResults(value))\n    }\n  })\n}",...SubmitAllowed.parameters?.docs?.source}}},NoSubmit.parameters={...NoSubmit.parameters,docs:{...NoSubmit.parameters?.docs,source:{originalSource:"{\n  args: {\n    placeholder: 'This will only show suggestions, there is no submit button',\n    minCharacterCount: 3,\n    actionThrowsError: false,\n    clearOnSelection: false,\n    allowSubmit: false\n  },\n  argTypes: {\n    itemSelected: {\n      action: 'itemSelected'\n    },\n    inputSubmitted: {\n      action: 'inputSubmitted'\n    },\n    actionThrowsError: {\n      type: 'boolean'\n    }\n  },\n  render: args => ({\n    props: {\n      ...args,\n      action: (value: string) => args.actionThrowsError ? throwError(() => new Error('Something went terribly wrong!')) : of(filterResults(value))\n    }\n  })\n}",...NoSubmit.parameters?.docs?.source}}},WithCustomStyle.parameters={...WithCustomStyle.parameters,docs:{...WithCustomStyle.parameters?.docs,source:{originalSource:"{\n  ...NoSubmit,\n  render: args => ({\n    props: args,\n    styles: [':host { --gn-ui-text-input-rounded: 10px; --gn-ui-text-input-padding: 20px; --gn-ui-text-input-font-size: 18px }']\n  })\n}",...WithCustomStyle.parameters?.docs?.source}}},NoMinimumCharacterCount.parameters={...NoMinimumCharacterCount.parameters,docs:{...NoMinimumCharacterCount.parameters?.docs,source:{originalSource:"{\n  args: {\n    placeholder: 'Click to show suggestions! selecting one should clear this field',\n    minCharacterCount: 0,\n    clearOnSelection: true\n  },\n  argTypes: {\n    itemSelected: {\n      action: 'itemSelected'\n    },\n    inputSubmitted: {\n      action: 'inputSubmitted'\n    }\n  },\n  render: args => ({\n    props: {\n      ...args,\n      action: (value: string) => of(filterResults(value))\n    }\n  })\n}",...NoMinimumCharacterCount.parameters?.docs?.source}}}},"./libs/ui/inputs/src/lib/autocomplete/autocomplete.component.css?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,"span {\n  --icon-padding: var(--gn-ui-text-input-border-size, 2px);\n  --icon-width: calc(var(--gn-ui-text-input-padding, 0.6em) * 2 + 1.25em);\n}\n/* this is because we don't want to change the popup alert font size */\nspan > *:not(gn-ui-popup-alert) {\n  font-size: var(--gn-ui-text-input-font-size, 1em);\n}\n\ninput:placeholder-shown {\n  text-overflow: ellipsis;\n}\ngn-ui-button {\n  --gn-ui-button-rounded: 0;\n  --gn-ui-button-width: var(--icon-width);\n  --gn-ui-button-padding: 0;\n  font-size: 1em;\n}\nng-icon.search {\n  margin-top: 0.6rem;\n  margin-left: 0.6rem;\n}\ngn-ui-button:last-of-type {\n  --gn-ui-button-rounded: 0 var(--gn-ui-text-input-rounded, 0.25em)\n    var(--gn-ui-text-input-rounded, 0.25em) 0;\n}\n\n.mat-mdc-option.suggestion.mat-mdc-option-active {\n  background-color: var(--color-primary-lightest);\n}\n",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./libs/ui/inputs/src/lib/button/button.component.css?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,"",""]),module.exports=___CSS_LOADER_EXPORT___.toString()}}]);