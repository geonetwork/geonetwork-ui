(self.webpackChunkgeonetwork_ui=self.webpackChunkgeonetwork_ui||[]).push([[6571],{"./libs/common/domain/src/lib/repository/records-repository.interface.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{w:()=>RecordsRepositoryInterface});class RecordsRepositoryInterface{}},"./libs/feature/notifications/src/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{I2:()=>NotificationsService});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),BehaviorSubject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js");let NotificationsService=class NotificationsService{constructor(){this.notifications$=new BehaviorSubject.t([])}showNotification(content,timeoutMs){const id=Math.floor(1e6*Math.random());this.notifications$.next([...this.notifications$.value,{...content,id}]),void 0!==timeoutMs&&setTimeout((()=>{this.removeNotificationById(id)}),timeoutMs)}removeNotificationById(id){this.notifications$.next(this.notifications$.value.filter((n=>n.id!==id)))}};NotificationsService=(0,tslib_es6.Cg)([(0,core.Injectable)({providedIn:"root"})],NotificationsService);let FeatureNotificationsModule=class FeatureNotificationsModule{};FeatureNotificationsModule=(0,tslib_es6.Cg)([(0,core.NgModule)({declarations:[],exports:[],imports:[],providers:[NotificationsService]})],FeatureNotificationsModule);var notifications_container_componentngResource=__webpack_require__("./libs/feature/notifications/src/lib/notifications-container/notifications-container.component.css?ngResource"),notifications_container_componentngResource_default=__webpack_require__.n(notifications_container_componentngResource),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),src=__webpack_require__("./libs/ui/elements/src/index.ts"),animations=__webpack_require__("./node_modules/@angular/animations/fesm2022/animations.mjs");let NotificationsContainerComponent=class NotificationsContainerComponent{constructor(notificationsService){this.notificationsService=notificationsService}trackById(index,notification){return notification.id}static#_=this.ctorParameters=()=>[{type:NotificationsService}]};NotificationsContainerComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"gn-ui-notifications-container",standalone:!0,imports:[common.CommonModule,src.zP],template:'<div class="flex flex-col gap-6 p-6 items-start pointer-events-none">\n  <gn-ui-notification\n    *ngFor="\n      let notification of notificationsService.notifications$ | async;\n      trackBy: trackById\n    "\n    class="max-w-full pointer-events-auto"\n    [text]="notification.text"\n    [type]="notification.type"\n    [title]="notification.title"\n    [closeMessage]="notification.closeMessage"\n    (notificationClose)="\n      notificationsService.removeNotificationById(notification.id)\n    "\n    [@enterExit]\n  ></gn-ui-notification>\n</div>\n',changeDetection:core.ChangeDetectionStrategy.OnPush,animations:[(0,animations.hZ)("enterExit",[(0,animations.kY)(":enter",[(0,animations.i0)("150ms",(0,animations.i7)([(0,animations.iF)({transform:"scale(1)",opacity:0}),(0,animations.iF)({transform:"scale(1.03)",opacity:.5}),(0,animations.iF)({transform:"scale(1)",opacity:1})]))]),(0,animations.kY)(":leave",[(0,animations.i0)("200ms",(0,animations.iF)({transform:"translateX(50px)",opacity:0}))])])],styles:[notifications_container_componentngResource_default()]}),(0,tslib_es6.Sn)("design:paramtypes",[NotificationsService])],NotificationsContainerComponent)},"./node_modules/basiclightbox/dist/basicLightbox.min.js":module=>{module.exports=function e(n,t,o){function r(c,u){if(!t[c]){if(!n[c]){if(i)return i(c,!0);var a=new Error("Cannot find module '"+c+"'");throw a.code="MODULE_NOT_FOUND",a}var l=t[c]={exports:{}};n[c][0].call(l.exports,(function(e){return r(n[c][1][e]||e)}),l,l.exports,e,n,t,o)}return t[c].exports}for(var i=void 0,c=0;c<o.length;c++)r(o[c]);return r}({1:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.create=t.visible=void 0;var o=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=document.createElement("div");return t.innerHTML=e.trim(),!0===n?t.children:t.firstChild},r=function(e,n){var t=e.children;return 1===t.length&&t[0].tagName===n},i=function(e){return null!=(e=e||document.querySelector(".basicLightbox"))&&!0===e.ownerDocument.body.contains(e)};t.visible=i,t.create=function(e,n){var t=function(e,n){var t=o('\n\t\t<div class="basicLightbox '.concat(n.className,'">\n\t\t\t<div class="basicLightbox__placeholder" role="dialog"></div>\n\t\t</div>\n\t')),i=t.querySelector(".basicLightbox__placeholder");e.forEach((function(e){return i.appendChild(e)}));var c=r(i,"IMG"),u=r(i,"VIDEO"),s=r(i,"IFRAME");return!0===c&&t.classList.add("basicLightbox--img"),!0===u&&t.classList.add("basicLightbox--video"),!0===s&&t.classList.add("basicLightbox--iframe"),t}(e=function(e){var n="string"==typeof e,t=e instanceof HTMLElement==1;if(!1===n&&!1===t)throw new Error("Content must be a DOM element/node or string");return!0===n?Array.from(o(e,!0)):"TEMPLATE"===e.tagName?[e.content.cloneNode(!0)]:Array.from(e.children)}(e),n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null==(e=Object.assign({},e)).closable&&(e.closable=!0),null==e.className&&(e.className=""),null==e.onShow&&(e.onShow=function(){}),null==e.onClose&&(e.onClose=function(){}),"boolean"!=typeof e.closable)throw new Error("Property `closable` must be a boolean");if("string"!=typeof e.className)throw new Error("Property `className` must be a string");if("function"!=typeof e.onShow)throw new Error("Property `onShow` must be a function");if("function"!=typeof e.onClose)throw new Error("Property `onClose` must be a function");return e}(n)),c=function(e){return!1!==n.onClose(u)&&function(e,n){return e.classList.remove("basicLightbox--visible"),setTimeout((function(){return!1===i(e)||e.parentElement.removeChild(e),n()}),410),!0}(t,(function(){if("function"==typeof e)return e(u)}))};!0===n.closable&&t.addEventListener("click",(function(e){e.target===t&&c()}));var u={element:function(){return t},visible:function(){return i(t)},show:function(e){return!1!==n.onShow(u)&&function(e,n){return document.body.appendChild(e),setTimeout((function(){requestAnimationFrame((function(){return e.classList.add("basicLightbox--visible"),n()}))}),10),!0}(t,(function(){if("function"==typeof e)return e(u)}))},close:c};return u}},{}]},{},[1])(1)},"./node_modules/rxjs/dist/esm5/internal/operators/throttleTime.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{c:()=>throttleTime});var scheduler_async=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/scheduler/async.js"),lift=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/util/lift.js"),OperatorSubscriber=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/OperatorSubscriber.js"),innerFrom=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/innerFrom.js");var timer=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/timer.js");function throttleTime(duration,scheduler,config){void 0===scheduler&&(scheduler=scheduler_async.E);var duration$=(0,timer.O)(duration,scheduler);return function throttle(durationSelector,config){return(0,lift.N)((function(source,subscriber){var _a=null!=config?config:{},_b=_a.leading,leading=void 0===_b||_b,_c=_a.trailing,trailing=void 0!==_c&&_c,hasValue=!1,sendValue=null,throttled=null,isComplete=!1,endThrottling=function(){null==throttled||throttled.unsubscribe(),throttled=null,trailing&&(send(),isComplete&&subscriber.complete())},cleanupThrottling=function(){throttled=null,isComplete&&subscriber.complete()},startThrottle=function(value){return throttled=(0,innerFrom.Tg)(durationSelector(value)).subscribe((0,OperatorSubscriber._)(subscriber,endThrottling,cleanupThrottling))},send=function(){if(hasValue){hasValue=!1;var value=sendValue;sendValue=null,subscriber.next(value),!isComplete&&startThrottle(value)}};source.subscribe((0,OperatorSubscriber._)(subscriber,(function(value){hasValue=!0,sendValue=value,(!throttled||throttled.closed)&&(leading?send():startThrottle(value))}),(function(){isComplete=!0,(!(trailing&&hasValue&&throttled)||throttled.closed)&&subscriber.complete()})))}))}((function(){return duration$}),config)}},"./libs/feature/editor/src/lib/components/import-record/import-record.component.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Primary:()=>Primary,default:()=>import_record_component_stories});var dist=__webpack_require__("./node_modules/@storybook/angular/dist/index.mjs"),tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var import_record_componentngResource=__webpack_require__("./libs/feature/editor/src/lib/components/import-record/import-record.component.css?ngResource"),import_record_componentngResource_default=__webpack_require__.n(import_record_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),icon=__webpack_require__("./node_modules/@angular/material/fesm2022/icon.mjs"),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),src=__webpack_require__("./libs/ui/inputs/src/index.ts"),elements_src=__webpack_require__("./libs/ui/elements/src/index.ts"),ngx_translate_core=__webpack_require__("./node_modules/@ngx-translate/core/fesm2020/ngx-translate-core.mjs"),notifications_src=__webpack_require__("./libs/feature/notifications/src/index.ts"),records_repository_interface=__webpack_require__("./libs/common/domain/src/lib/repository/records-repository.interface.ts"),router=__webpack_require__("./node_modules/@angular/router/fesm2022/router.mjs");let ImportRecordComponent=class ImportRecordComponent{constructor(router,translateService,cdr,notificationsService,recordsRepository){this.router=router,this.translateService=translateService,this.cdr=cdr,this.notificationsService=notificationsService,this.recordsRepository=recordsRepository,this.closeImportMenu=new core.EventEmitter,this.importMenuItems=[{label:this.translateService.instant("dashboard.importRecord.useModel"),icon:"highlight",action:()=>null,dataTest:"useAModelButton",disabled:!0},{label:this.translateService.instant("dashboard.importRecord.importExternal"),icon:"cloud_download",action:this.displayImportExternal.bind(this),dataTest:"importFromUrlButton"}],this.isRecordImportInProgress=!1,this.sectionDisplayed="mainMenu",this.externalImportBackLabel=this.translateService.instant("dashboard.importRecord.importExternalLabel")}displayMainMenu(){this.sectionDisplayed="mainMenu",this.cdr.markForCheck()}displayImportExternal(){this.sectionDisplayed="importExternalFile",this.cdr.markForCheck()}importRecord(url){this.isRecordImportInProgress=!0,this.recordsRepository.duplicateExternalRecord(url).subscribe({next:recordTempId=>{recordTempId&&(this.notificationsService.showNotification({type:"success",title:this.translateService.instant("editor.record.importFromExternalFile.success.title"),text:`${this.translateService.instant("editor.record.importFromExternalFile.success.body")}`},2500),this.router.navigate(["/edit",recordTempId]).catch((err=>console.error(err)))),this.closeImportMenu.next()},error:error=>{this.notificationsService.showNotification({type:"error",title:this.translateService.instant("editor.record.importFromExternalFile.failure.title"),text:`${this.translateService.instant("editor.record.importFromExternalFile.failure.body")} ${error.message??""}`},2500),this.isRecordImportInProgress=!1,this.cdr.markForCheck()}})}static#_=this.ctorParameters=()=>[{type:router.Ix},{type:ngx_translate_core.c$},{type:core.ChangeDetectorRef},{type:notifications_src.I2},{type:records_repository_interface.w}];static#_2=this.propDecorators={closeImportMenu:[{type:core.Output}]}};ImportRecordComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"gn-ui-import-record",template:'<ng-container [ngSwitch]="sectionDisplayed">\n  <ng-container *ngSwitchCase="\'mainMenu\'">\n    <div\n      data-test="importMenuMainSection"\n      class="mt-2 border border-gray-100 p-2 flex items-center bg-white shadow-2xl rounded-2xl"\n    >\n      <ul class="flex flex-col gap-2 w-full">\n        <li *ngFor="let menuItem of importMenuItems">\n          <gn-ui-button\n            [attr.data-test]="menuItem.dataTest"\n            type="light"\n            extraClass="flex flex-row items-center gap-2 w-full justify-start"\n            (buttonClick)="menuItem.action()"\n            [disabled]="menuItem.disabled"\n            [title]="\n              (menuItem.disabled ? \'editor.temporary.disabled\' : \'\') | translate\n            "\n            ><mat-icon class="material-symbols-outlined">\n              {{ menuItem.icon }} </mat-icon\n            ><span>{{ menuItem.label }}</span></gn-ui-button\n          >\n        </li>\n      </ul>\n    </div>\n  </ng-container>\n  <ng-container *ngSwitchCase="\'importExternalFile\'">\n    <div\n      data-test="importMenuImportExternalFileSection"\n      class="p-6 flex flex-col gap-2 mt-2 border border-gray-100 bg-white shadow-2xl rounded-2xl"\n    >\n      <div class="flex flex-row items-center gap-2">\n        <gn-ui-button\n          data-test="importMenuImportExternalFileSectionBackButton"\n          type="light"\n          (buttonClick)="displayMainMenu()"\n        >\n          <mat-icon class="material-symbols-outlined">arrow_back</mat-icon>\n        </gn-ui-button>\n        <span class="font-bold"> {{ externalImportBackLabel }}</span>\n      </div>\n      <gn-ui-url-input\n        (valueChange)="importRecord($event)"\n        [disabled]="isRecordImportInProgress"\n      ></gn-ui-url-input>\n    </div>\n  </ng-container>\n</ng-container>\n',changeDetection:core.ChangeDetectionStrategy.OnPush,standalone:!0,imports:[common.CommonModule,icon.m_,src.Qp,elements_src.Yg,src.$1,ngx_translate_core.h],styles:[import_record_componentngResource_default()]}),(0,tslib_es6.Sn)("design:paramtypes",[router.Ix,ngx_translate_core.c$,core.ChangeDetectorRef,notifications_src.I2,records_repository_interface.w])],ImportRecordComponent);var animations=__webpack_require__("./node_modules/@angular/platform-browser/fesm2022/animations.mjs"),i18n_src=__webpack_require__("./libs/util/i18n/src/index.ts"),of=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js");const import_record_component_stories={title:"Elements/ImportRecordComponent",component:ImportRecordComponent,decorators:[(0,dist.moduleMetadata)({imports:[common.CommonModule,icon.m_,src.Qp,elements_src.Yg,src.$1],providers:[{provide:records_repository_interface.w,useClass:class MockRecordsRepository{importRecordFromExternalFileUrlAsDraft(url){return(0,of.of)("mockedRecordTempId")}}}]}),(0,dist.applicationConfig)({providers:[(0,core.importProvidersFrom)(animations.BrowserAnimationsModule),(0,core.importProvidersFrom)(i18n_src.D7),(0,core.importProvidersFrom)(ngx_translate_core.h.forRoot())]}),(0,dist.componentWrapperDecorator)((story=>`<div style="max-width: 500px; margin: auto;">${story}</div>`))]},Primary={args:{}}},"./libs/feature/editor/src/lib/components/import-record/import-record.component.css?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,"",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./libs/feature/notifications/src/lib/notifications-container/notifications-container.component.css?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,"",""]),module.exports=___CSS_LOADER_EXPORT___.toString()}}]);