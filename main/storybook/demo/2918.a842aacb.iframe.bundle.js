"use strict";(self.webpackChunkgeonetwork_ui=self.webpackChunkgeonetwork_ui||[]).push([[2918],{"./node_modules/@camptocamp/ogc-client/dist/wmts/ol-tilegrid.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{buildOpenLayersTileGrid:()=>buildOpenLayersTileGrid});var asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),TileGrid=__webpack_require__("./node_modules/ol/tilegrid/TileGrid.js"),proj=__webpack_require__("./node_modules/ol/proj.js");class WMTSTileGrid extends TileGrid.Z{constructor(options){super({extent:options.extent,origin:options.origin,origins:options.origins,resolutions:options.resolutions,tileSize:options.tileSize,tileSizes:options.tileSizes,sizes:options.sizes}),this.matrixIds_=options.matrixIds}getMatrixId(z){return this.matrixIds_[z]}getMatrixIds(){return this.matrixIds_}}var proj4=__webpack_require__("./node_modules/ol/proj/proj4.js");var PJD_3PARAM=1,PJD_7PARAM=2,PJD_GRIDSHIFT=3,PJD_NODATUM=5,SRS_WGS84_SEMIMAJOR=6378137,SRS_WGS84_SEMIMINOR=6356752.314,SRS_WGS84_ESQUARED=.0066943799901413165,SEC_TO_RAD=484813681109536e-20,HALF_PI=Math.PI/2,SIXTH=.16666666666666666,RA4=.04722222222222222,RA6=.022156084656084655,EPSLN=1e-10,D2R=.017453292519943295,R2D=57.29577951308232,FORTPI=Math.PI/4,TWO_PI=2*Math.PI,SPI=3.14159265359,PrimeMeridian_exports={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667};const units={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var ignoredChar=/[\s_\-\/\(\)]/g;function match(obj,key){if(obj[key])return obj[key];for(var testkey,keys=Object.keys(obj),lkey=key.toLowerCase().replace(ignoredChar,""),i=-1;++i<keys.length;)if((testkey=keys[i]).toLowerCase().replace(ignoredChar,"")===lkey)return obj[testkey]}function projString(defData){var paramName,paramVal,paramOutname,self={},paramObj=defData.split("+").map((function(v){return v.trim()})).filter((function(a){return a})).reduce((function(p,a){var split=a.split("=");return split.push(!0),p[split[0].toLowerCase()]=split[1],p}),{}),params={proj:"projName",datum:"datumCode",rf:function(v){self.rf=parseFloat(v)},lat_0:function(v){self.lat0=v*D2R},lat_1:function(v){self.lat1=v*D2R},lat_2:function(v){self.lat2=v*D2R},lat_ts:function(v){self.lat_ts=v*D2R},lon_0:function(v){self.long0=v*D2R},lon_1:function(v){self.long1=v*D2R},lon_2:function(v){self.long2=v*D2R},alpha:function(v){self.alpha=parseFloat(v)*D2R},gamma:function(v){self.rectified_grid_angle=parseFloat(v)},lonc:function(v){self.longc=v*D2R},x_0:function(v){self.x0=parseFloat(v)},y_0:function(v){self.y0=parseFloat(v)},k_0:function(v){self.k0=parseFloat(v)},k:function(v){self.k0=parseFloat(v)},a:function(v){self.a=parseFloat(v)},b:function(v){self.b=parseFloat(v)},r_a:function(){self.R_A=!0},zone:function(v){self.zone=parseInt(v,10)},south:function(){self.utmSouth=!0},towgs84:function(v){self.datum_params=v.split(",").map((function(a){return parseFloat(a)}))},to_meter:function(v){self.to_meter=parseFloat(v)},units:function(v){self.units=v;var unit=match(units,v);unit&&(self.to_meter=unit.to_meter)},from_greenwich:function(v){self.from_greenwich=v*D2R},pm:function(v){var pm=match(PrimeMeridian_exports,v);self.from_greenwich=(pm||parseFloat(v))*D2R},nadgrids:function(v){"@null"===v?self.datumCode="none":self.nadgrids=v},axis:function(v){3===v.length&&-1!=="ewnsud".indexOf(v.substr(0,1))&&-1!=="ewnsud".indexOf(v.substr(1,1))&&-1!=="ewnsud".indexOf(v.substr(2,1))&&(self.axis=v)},approx:function(){self.approx=!0}};for(paramName in paramObj)paramVal=paramObj[paramName],paramName in params?"function"==typeof(paramOutname=params[paramName])?paramOutname(paramVal):self[paramOutname]=paramVal:self[paramName]=paramVal;return"string"==typeof self.datumCode&&"WGS84"!==self.datumCode&&(self.datumCode=self.datumCode.toLowerCase()),self}const parser=function parseString(txt){var parser=new Parser(txt);return parser.output()};var NEUTRAL=1,whitespace=/\s/,latin=/[A-Za-z]/,keyword=/[A-Za-z84_]/,endThings=/[,\]]/,digets=/[\d\.E\-\+]/;function Parser(text){if("string"!=typeof text)throw new Error("not a string");this.text=text.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=NEUTRAL}function mapit(obj,key,value){Array.isArray(key)&&(value.unshift(key),key=null);var thing=key?{}:obj,out=value.reduce((function(newObj,item){return sExpr(item,newObj),newObj}),thing);key&&(obj[key]=out)}function sExpr(v,obj){if(Array.isArray(v)){var key=v.shift();if("PARAMETER"===key&&(key=v.shift()),1===v.length)return Array.isArray(v[0])?(obj[key]={},void sExpr(v[0],obj[key])):void(obj[key]=v[0]);if(v.length)if("TOWGS84"!==key){if("AXIS"===key)return key in obj||(obj[key]=[]),void obj[key].push(v);var i;switch(Array.isArray(key)||(obj[key]={}),key){case"UNIT":case"PRIMEM":case"VERT_DATUM":return obj[key]={name:v[0].toLowerCase(),convert:v[1]},void(3===v.length&&sExpr(v[2],obj[key]));case"SPHEROID":case"ELLIPSOID":return obj[key]={name:v[0],a:v[1],rf:v[2]},void(4===v.length&&sExpr(v[3],obj[key]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return v[0]=["name",v[0]],void mapit(obj,key,v);default:for(i=-1;++i<v.length;)if(!Array.isArray(v[i]))return sExpr(v,obj[key]);return mapit(obj,key,v)}}else obj[key]=v;else obj[key]=!0}else obj[v]=!0}Parser.prototype.readCharicter=function(){var char=this.text[this.place++];if(4!==this.state)for(;whitespace.test(char);){if(this.place>=this.text.length)return;char=this.text[this.place++]}switch(this.state){case NEUTRAL:return this.neutral(char);case 2:return this.keyword(char);case 4:return this.quoted(char);case 5:return this.afterquote(char);case 3:return this.number(char);case-1:return}},Parser.prototype.afterquote=function(char){if('"'===char)return this.word+='"',void(this.state=4);if(endThings.test(char))return this.word=this.word.trim(),void this.afterItem(char);throw new Error("havn't handled \""+char+'" in afterquote yet, index '+this.place)},Parser.prototype.afterItem=function(char){return","===char?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=NEUTRAL)):"]"===char?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=NEUTRAL,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},Parser.prototype.number=function(char){if(!digets.test(char)){if(endThings.test(char))return this.word=parseFloat(this.word),void this.afterItem(char);throw new Error("havn't handled \""+char+'" in number yet, index '+this.place)}this.word+=char},Parser.prototype.quoted=function(char){'"'!==char?this.word+=char:this.state=5},Parser.prototype.keyword=function(char){if(keyword.test(char))this.word+=char;else{if("["===char){var newObjects=[];return newObjects.push(this.word),this.level++,null===this.root?this.root=newObjects:this.currentObject.push(newObjects),this.stack.push(this.currentObject),this.currentObject=newObjects,void(this.state=NEUTRAL)}if(!endThings.test(char))throw new Error("havn't handled \""+char+'" in keyword yet, index '+this.place);this.afterItem(char)}},Parser.prototype.neutral=function(char){if(latin.test(char))return this.word=char,void(this.state=2);if('"'===char)return this.word="",void(this.state=4);if(digets.test(char))return this.word=char,void(this.state=3);if(!endThings.test(char))throw new Error("havn't handled \""+char+'" in neutral yet, index '+this.place);this.afterItem(char)},Parser.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var wkt_parser_D2R=.017453292519943295;function d2r(input){return input*wkt_parser_D2R}function wkt_parser(wkt){var lisp=parser(wkt),type=lisp.shift(),name=lisp.shift();lisp.unshift(["name",name]),lisp.unshift(["type",type]);var obj={};return sExpr(lisp,obj),function cleanWKT(wkt){if("GEOGCS"===wkt.type?wkt.projName="longlat":"LOCAL_CS"===wkt.type?(wkt.projName="identity",wkt.local=!0):"object"==typeof wkt.PROJECTION?wkt.projName=Object.keys(wkt.PROJECTION)[0]:wkt.projName=wkt.PROJECTION,wkt.AXIS){for(var axisOrder="",i=0,ii=wkt.AXIS.length;i<ii;++i){var axis=[wkt.AXIS[i][0].toLowerCase(),wkt.AXIS[i][1].toLowerCase()];-1!==axis[0].indexOf("north")||("y"===axis[0]||"lat"===axis[0])&&"north"===axis[1]?axisOrder+="n":-1!==axis[0].indexOf("south")||("y"===axis[0]||"lat"===axis[0])&&"south"===axis[1]?axisOrder+="s":-1!==axis[0].indexOf("east")||("x"===axis[0]||"lon"===axis[0])&&"east"===axis[1]?axisOrder+="e":-1===axis[0].indexOf("west")&&("x"!==axis[0]&&"lon"!==axis[0]||"west"!==axis[1])||(axisOrder+="w")}2===axisOrder.length&&(axisOrder+="u"),3===axisOrder.length&&(wkt.axis=axisOrder)}wkt.UNIT&&(wkt.units=wkt.UNIT.name.toLowerCase(),"metre"===wkt.units&&(wkt.units="meter"),wkt.UNIT.convert&&("GEOGCS"===wkt.type?wkt.DATUM&&wkt.DATUM.SPHEROID&&(wkt.to_meter=wkt.UNIT.convert*wkt.DATUM.SPHEROID.a):wkt.to_meter=wkt.UNIT.convert));var geogcs=wkt.GEOGCS;function toMeter(input){return input*(wkt.to_meter||1)}"GEOGCS"===wkt.type&&(geogcs=wkt),geogcs&&(geogcs.DATUM?wkt.datumCode=geogcs.DATUM.name.toLowerCase():wkt.datumCode=geogcs.name.toLowerCase(),"d_"===wkt.datumCode.slice(0,2)&&(wkt.datumCode=wkt.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==wkt.datumCode&&"new_zealand_1949"!==wkt.datumCode||(wkt.datumCode="nzgd49"),"wgs_1984"!==wkt.datumCode&&"world_geodetic_system_1984"!==wkt.datumCode||("Mercator_Auxiliary_Sphere"===wkt.PROJECTION&&(wkt.sphere=!0),wkt.datumCode="wgs84"),"_ferro"===wkt.datumCode.slice(-6)&&(wkt.datumCode=wkt.datumCode.slice(0,-6)),"_jakarta"===wkt.datumCode.slice(-8)&&(wkt.datumCode=wkt.datumCode.slice(0,-8)),~wkt.datumCode.indexOf("belge")&&(wkt.datumCode="rnb72"),geogcs.DATUM&&geogcs.DATUM.SPHEROID&&(wkt.ellps=geogcs.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===wkt.ellps.toLowerCase().slice(0,13)&&(wkt.ellps="intl"),wkt.a=geogcs.DATUM.SPHEROID.a,wkt.rf=parseFloat(geogcs.DATUM.SPHEROID.rf,10)),geogcs.DATUM&&geogcs.DATUM.TOWGS84&&(wkt.datum_params=geogcs.DATUM.TOWGS84),~wkt.datumCode.indexOf("osgb_1936")&&(wkt.datumCode="osgb36"),~wkt.datumCode.indexOf("osni_1952")&&(wkt.datumCode="osni52"),(~wkt.datumCode.indexOf("tm65")||~wkt.datumCode.indexOf("geodetic_datum_of_1965"))&&(wkt.datumCode="ire65"),"ch1903+"===wkt.datumCode&&(wkt.datumCode="ch1903"),~wkt.datumCode.indexOf("israel")&&(wkt.datumCode="isr93")),wkt.b&&!isFinite(wkt.b)&&(wkt.b=wkt.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",d2r],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",d2r],["x0","false_easting",toMeter],["y0","false_northing",toMeter],["long0","central_meridian",d2r],["lat0","latitude_of_origin",d2r],["lat0","standard_parallel_1",d2r],["lat1","standard_parallel_1",d2r],["lat2","standard_parallel_2",d2r],["azimuth","Azimuth"],["alpha","azimuth",d2r],["srsCode","name"]].forEach((function(a){return function rename(obj,params){var outName=params[0],inName=params[1];!(outName in obj)&&inName in obj&&(obj[outName]=obj[inName],3===params.length&&(obj[outName]=params[2](obj[outName])))}(wkt,a)})),wkt.long0||!wkt.longc||"Albers_Conic_Equal_Area"!==wkt.projName&&"Lambert_Azimuthal_Equal_Area"!==wkt.projName||(wkt.long0=wkt.longc),wkt.lat_ts||!wkt.lat1||"Stereographic_South_Pole"!==wkt.projName&&"Polar Stereographic (variant B)"!==wkt.projName?!wkt.lat_ts&&wkt.lat0&&"Polar_Stereographic"===wkt.projName&&(wkt.lat_ts=wkt.lat0,wkt.lat0=d2r(wkt.lat0>0?90:-90)):(wkt.lat0=d2r(wkt.lat1>0?90:-90),wkt.lat_ts=wkt.lat1)}(obj),obj}function defs(name){var that=this;if(2===arguments.length){var def=arguments[1];"string"==typeof def?"+"===def.charAt(0)?defs[name]=projString(arguments[1]):defs[name]=wkt_parser(arguments[1]):defs[name]=def}else if(1===arguments.length){if(Array.isArray(name))return name.map((function(v){Array.isArray(v)?defs.apply(that,v):defs(v)}));if("string"==typeof name){if(name in defs)return defs[name]}else"EPSG"in name?defs["EPSG:"+name.EPSG]=name:"ESRI"in name?defs["ESRI:"+name.ESRI]=name:"IAU2000"in name?defs["IAU2000:"+name.IAU2000]=name:console.log(name);return}}!function global(defs){defs("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),defs("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),defs("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),defs.WGS84=defs["EPSG:4326"],defs["EPSG:3785"]=defs["EPSG:3857"],defs.GOOGLE=defs["EPSG:3857"],defs["EPSG:900913"]=defs["EPSG:3857"],defs["EPSG:102113"]=defs["EPSG:3857"]}(defs);const lib_defs=defs;var codeWords=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];var codes=["3857","900913","3785","102113"];const parseCode=function parse(code){if(!function testObj(code){return"string"==typeof code}(code))return code;if(function testDef(code){return code in lib_defs}(code))return lib_defs[code];if(function testWKT(code){return codeWords.some((function(word){return code.indexOf(word)>-1}))}(code)){var out=wkt_parser(code);if(function checkMercator(item){var auth=match(item,"authority");if(auth){var code=match(auth,"epsg");return code&&codes.indexOf(code)>-1}}(out))return lib_defs["EPSG:3857"];var maybeProjStr=function checkProjStr(item){var ext=match(item,"extension");if(ext)return match(ext,"proj4")}(out);return maybeProjStr?projString(maybeProjStr):out}return function testProj(code){return"+"===code[0]}(code)?projString(code):void 0};function extend(destination,source){var value,property;if(destination=destination||{},!source)return destination;for(property in source)void 0!==(value=source[property])&&(destination[property]=value);return destination}function msfnz(eccent,sinphi,cosphi){var con=eccent*sinphi;return cosphi/Math.sqrt(1-con*con)}function sign(x){return x<0?-1:1}function adjust_lon(x){return Math.abs(x)<=SPI?x:x-sign(x)*TWO_PI}function tsfnz(eccent,phi,sinphi){var con=eccent*sinphi,com=.5*eccent;return con=Math.pow((1-con)/(1+con),com),Math.tan(.5*(HALF_PI-phi))/con}function phi2z(eccent,ts){for(var con,dphi,eccnth=.5*eccent,phi=HALF_PI-2*Math.atan(ts),i=0;i<=15;i++)if(con=eccent*Math.sin(phi),phi+=dphi=HALF_PI-2*Math.atan(ts*Math.pow((1-con)/(1+con),eccnth))-phi,Math.abs(dphi)<=1e-10)return phi;return-9999}function identity(pt){return pt}var projs=[{init:function init(){var con=this.b/this.a;this.es=1-con*con,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=msfnz(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function forward(p){var x,y,lon=p.x,lat=p.y;if(lat*R2D>90&&lat*R2D<-90&&lon*R2D>180&&lon*R2D<-180)return null;if(Math.abs(Math.abs(lat)-HALF_PI)<=EPSLN)return null;if(this.sphere)x=this.x0+this.a*this.k0*adjust_lon(lon-this.long0),y=this.y0+this.a*this.k0*Math.log(Math.tan(FORTPI+.5*lat));else{var sinphi=Math.sin(lat),ts=tsfnz(this.e,lat,sinphi);x=this.x0+this.a*this.k0*adjust_lon(lon-this.long0),y=this.y0-this.a*this.k0*Math.log(ts)}return p.x=x,p.y=y,p},inverse:function inverse(p){var lon,lat,x=p.x-this.x0,y=p.y-this.y0;if(this.sphere)lat=HALF_PI-2*Math.atan(Math.exp(-y/(this.a*this.k0)));else{var ts=Math.exp(-y/(this.a*this.k0));if(-9999===(lat=phi2z(this.e,ts)))return null}return lon=adjust_lon(this.long0+x/(this.a*this.k0)),p.x=lon,p.y=lat,p},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function longlat_init(){},forward:identity,inverse:identity,names:["longlat","identity"]}],projections_names={},projStore=[];function add(proj,i){var len=projStore.length;return proj.names?(projStore[len]=proj,proj.names.forEach((function(n){projections_names[n.toLowerCase()]=len})),this):(console.log(i),!0)}const projections={start:function start(){projs.forEach(add)},add,get:function get(name){if(!name)return!1;var n=name.toLowerCase();return void 0!==projections_names[n]&&projStore[projections_names[n]]?projStore[projections_names[n]]:void 0}};var Ellipsoid_exports={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:6378249.2,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},WGS84=Ellipsoid_exports.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};Ellipsoid_exports.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var Datum_exports={};Datum_exports.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},Datum_exports.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},Datum_exports.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},Datum_exports.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},Datum_exports.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},Datum_exports.potsdam={towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},Datum_exports.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},Datum_exports.hermannskogel={towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},Datum_exports.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},Datum_exports.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},Datum_exports.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},Datum_exports.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},Datum_exports.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},Datum_exports.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},Datum_exports.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},Datum_exports.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},Datum_exports.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};const lib_datum=function datum(datumCode,datum_params,a,b,es,ep2,nadgrids){var out={};return out.datum_type=void 0===datumCode||"none"===datumCode?PJD_NODATUM:4,datum_params&&(out.datum_params=datum_params.map(parseFloat),0===out.datum_params[0]&&0===out.datum_params[1]&&0===out.datum_params[2]||(out.datum_type=PJD_3PARAM),out.datum_params.length>3&&(0===out.datum_params[3]&&0===out.datum_params[4]&&0===out.datum_params[5]&&0===out.datum_params[6]||(out.datum_type=PJD_7PARAM,out.datum_params[3]*=SEC_TO_RAD,out.datum_params[4]*=SEC_TO_RAD,out.datum_params[5]*=SEC_TO_RAD,out.datum_params[6]=out.datum_params[6]/1e6+1))),nadgrids&&(out.datum_type=PJD_GRIDSHIFT,out.grids=nadgrids),out.a=a,out.b=b,out.es=es,out.ep2=ep2,out};var loadedNadgrids={};function parseNadgridString(value){if(0===value.length)return null;var optional="@"===value[0];return optional&&(value=value.slice(1)),"null"===value?{name:"null",mandatory:!optional,grid:null,isNull:!0}:{name:value,mandatory:!optional,grid:loadedNadgrids[value]||null,isNull:!1}}function secondsToRadians(seconds){return seconds/3600*Math.PI/180}function decodeString(view,start,end){return String.fromCharCode.apply(null,new Uint8Array(view.buffer.slice(start,end)))}function mapNodes(nodes){return nodes.map((function(r){return[secondsToRadians(r.longitudeShift),secondsToRadians(r.latitudeShift)]}))}function readGridHeader(view,offset,isLittleEndian){return{name:decodeString(view,offset+8,offset+16).trim(),parent:decodeString(view,offset+24,offset+24+8).trim(),lowerLatitude:view.getFloat64(offset+72,isLittleEndian),upperLatitude:view.getFloat64(offset+88,isLittleEndian),lowerLongitude:view.getFloat64(offset+104,isLittleEndian),upperLongitude:view.getFloat64(offset+120,isLittleEndian),latitudeInterval:view.getFloat64(offset+136,isLittleEndian),longitudeInterval:view.getFloat64(offset+152,isLittleEndian),gridNodeCount:view.getInt32(offset+168,isLittleEndian)}}function readGridNodes(view,offset,gridHeader,isLittleEndian){for(var nodesOffset=offset+176,gridShiftRecords=[],i=0;i<gridHeader.gridNodeCount;i++){var record={latitudeShift:view.getFloat32(nodesOffset+16*i,isLittleEndian),longitudeShift:view.getFloat32(nodesOffset+16*i+4,isLittleEndian),latitudeAccuracy:view.getFloat32(nodesOffset+16*i+8,isLittleEndian),longitudeAccuracy:view.getFloat32(nodesOffset+16*i+12,isLittleEndian)};gridShiftRecords.push(record)}return gridShiftRecords}function Projection(srsCode,callback){if(!(this instanceof Projection))return new Projection(srsCode);callback=callback||function(error){if(error)throw error};var json=parseCode(srsCode);if("object"==typeof json){var ourProj=Projection.projections.get(json.projName);if(ourProj){if(json.datumCode&&"none"!==json.datumCode){var datumDef=match(Datum_exports,json.datumCode);datumDef&&(json.datum_params=json.datum_params||(datumDef.towgs84?datumDef.towgs84.split(","):null),json.ellps=datumDef.ellipse,json.datumName=datumDef.datumName?datumDef.datumName:json.datumCode)}json.k0=json.k0||1,json.axis=json.axis||"enu",json.ellps=json.ellps||"wgs84",json.lat1=json.lat1||json.lat0;var sphere_=function sphere(a,b,rf,ellps,sphere){if(!a){var ellipse=match(Ellipsoid_exports,ellps);ellipse||(ellipse=WGS84),a=ellipse.a,b=ellipse.b,rf=ellipse.rf}return rf&&!b&&(b=(1-1/rf)*a),(0===rf||Math.abs(a-b)<EPSLN)&&(sphere=!0,b=a),{a,b,rf,sphere}}(json.a,json.b,json.rf,json.ellps,json.sphere),ecc=function eccentricity(a,b,rf,R_A){var a2=a*a,b2=b*b,es=(a2-b2)/a2,e=0;return R_A?(a2=(a*=1-es*(SIXTH+es*(RA4+es*RA6)))*a,es=0):e=Math.sqrt(es),{es,e,ep2:(a2-b2)/b2}}(sphere_.a,sphere_.b,sphere_.rf,json.R_A),nadgrids=function getNadgrids(nadgrids){return void 0===nadgrids?null:nadgrids.split(",").map(parseNadgridString)}(json.nadgrids),datumObj=json.datum||lib_datum(json.datumCode,json.datum_params,sphere_.a,sphere_.b,ecc.es,ecc.ep2,nadgrids);extend(this,json),extend(this,ourProj),this.a=sphere_.a,this.b=sphere_.b,this.rf=sphere_.rf,this.sphere=sphere_.sphere,this.es=ecc.es,this.e=ecc.e,this.ep2=ecc.ep2,this.datum=datumObj,this.init(),callback(null,this)}else callback(srsCode)}else callback(srsCode)}Projection.projections=projections,Projection.projections.start();const Proj=Projection;function geodeticToGeocentric(p,es,a){var Rn,Sin_Lat,Sin2_Lat,Cos_Lat,Longitude=p.x,Latitude=p.y,Height=p.z?p.z:0;if(Latitude<-HALF_PI&&Latitude>-1.001*HALF_PI)Latitude=-HALF_PI;else if(Latitude>HALF_PI&&Latitude<1.001*HALF_PI)Latitude=HALF_PI;else{if(Latitude<-HALF_PI)return{x:-1/0,y:-1/0,z:p.z};if(Latitude>HALF_PI)return{x:1/0,y:1/0,z:p.z}}return Longitude>Math.PI&&(Longitude-=2*Math.PI),Sin_Lat=Math.sin(Latitude),Cos_Lat=Math.cos(Latitude),Sin2_Lat=Sin_Lat*Sin_Lat,{x:((Rn=a/Math.sqrt(1-es*Sin2_Lat))+Height)*Cos_Lat*Math.cos(Longitude),y:(Rn+Height)*Cos_Lat*Math.sin(Longitude),z:(Rn*(1-es)+Height)*Sin_Lat}}function geocentricToGeodetic(p,es,a,b){var P,RR,CT,ST,RX,RK,RN,CPHI0,SPHI0,CPHI,SPHI,SDPHI,iter,Longitude,Height,X=p.x,Y=p.y,Z=p.z?p.z:0;if(P=Math.sqrt(X*X+Y*Y),RR=Math.sqrt(X*X+Y*Y+Z*Z),P/a<1e-12){if(Longitude=0,RR/a<1e-12)return HALF_PI,Height=-b,{x:p.x,y:p.y,z:p.z}}else Longitude=Math.atan2(Y,X);CT=Z/RR,CPHI0=(ST=P/RR)*(1-es)*(RX=1/Math.sqrt(1-es*(2-es)*ST*ST)),SPHI0=CT*RX,iter=0;do{iter++,RK=es*(RN=a/Math.sqrt(1-es*SPHI0*SPHI0))/(RN+(Height=P*CPHI0+Z*SPHI0-RN*(1-es*SPHI0*SPHI0))),SDPHI=(SPHI=CT*(RX=1/Math.sqrt(1-RK*(2-RK)*ST*ST)))*CPHI0-(CPHI=ST*(1-RK)*RX)*SPHI0,CPHI0=CPHI,SPHI0=SPHI}while(SDPHI*SDPHI>1e-24&&iter<30);return{x:Longitude,y:Math.atan(SPHI/Math.abs(CPHI)),z:Height}}function checkParams(type){return type===PJD_3PARAM||type===PJD_7PARAM}function datum_transform(source,dest,point){if(function compareDatums(source,dest){return source.datum_type===dest.datum_type&&!(source.a!==dest.a||Math.abs(source.es-dest.es)>5e-11)&&(source.datum_type===PJD_3PARAM?source.datum_params[0]===dest.datum_params[0]&&source.datum_params[1]===dest.datum_params[1]&&source.datum_params[2]===dest.datum_params[2]:source.datum_type!==PJD_7PARAM||source.datum_params[0]===dest.datum_params[0]&&source.datum_params[1]===dest.datum_params[1]&&source.datum_params[2]===dest.datum_params[2]&&source.datum_params[3]===dest.datum_params[3]&&source.datum_params[4]===dest.datum_params[4]&&source.datum_params[5]===dest.datum_params[5]&&source.datum_params[6]===dest.datum_params[6])}(source,dest))return point;if(source.datum_type===PJD_NODATUM||dest.datum_type===PJD_NODATUM)return point;var source_a=source.a,source_es=source.es;if(source.datum_type===PJD_GRIDSHIFT){if(0!==applyGridShift(source,!1,point))return;source_a=SRS_WGS84_SEMIMAJOR,source_es=SRS_WGS84_ESQUARED}var dest_a=dest.a,dest_b=dest.b,dest_es=dest.es;if(dest.datum_type===PJD_GRIDSHIFT&&(dest_a=SRS_WGS84_SEMIMAJOR,dest_b=SRS_WGS84_SEMIMINOR,dest_es=SRS_WGS84_ESQUARED),source_es===dest_es&&source_a===dest_a&&!checkParams(source.datum_type)&&!checkParams(dest.datum_type))return point;if((point=geodeticToGeocentric(point,source_es,source_a),checkParams(source.datum_type)&&(point=function geocentricToWgs84(p,datum_type,datum_params){if(datum_type===PJD_3PARAM)return{x:p.x+datum_params[0],y:p.y+datum_params[1],z:p.z+datum_params[2]};if(datum_type===PJD_7PARAM){var Dx_BF=datum_params[0],Dy_BF=datum_params[1],Dz_BF=datum_params[2],Rx_BF=datum_params[3],Ry_BF=datum_params[4],Rz_BF=datum_params[5],M_BF=datum_params[6];return{x:M_BF*(p.x-Rz_BF*p.y+Ry_BF*p.z)+Dx_BF,y:M_BF*(Rz_BF*p.x+p.y-Rx_BF*p.z)+Dy_BF,z:M_BF*(-Ry_BF*p.x+Rx_BF*p.y+p.z)+Dz_BF}}}(point,source.datum_type,source.datum_params)),checkParams(dest.datum_type)&&(point=function geocentricFromWgs84(p,datum_type,datum_params){if(datum_type===PJD_3PARAM)return{x:p.x-datum_params[0],y:p.y-datum_params[1],z:p.z-datum_params[2]};if(datum_type===PJD_7PARAM){var Dx_BF=datum_params[0],Dy_BF=datum_params[1],Dz_BF=datum_params[2],Rx_BF=datum_params[3],Ry_BF=datum_params[4],Rz_BF=datum_params[5],M_BF=datum_params[6],x_tmp=(p.x-Dx_BF)/M_BF,y_tmp=(p.y-Dy_BF)/M_BF,z_tmp=(p.z-Dz_BF)/M_BF;return{x:x_tmp+Rz_BF*y_tmp-Ry_BF*z_tmp,y:-Rz_BF*x_tmp+y_tmp+Rx_BF*z_tmp,z:Ry_BF*x_tmp-Rx_BF*y_tmp+z_tmp}}}(point,dest.datum_type,dest.datum_params)),point=geocentricToGeodetic(point,dest_es,dest_a,dest_b),dest.datum_type===PJD_GRIDSHIFT)&&0!==applyGridShift(dest,!0,point))return;return point}function applyGridShift(source,inverse,point){if(null===source.grids||0===source.grids.length)return console.log("Grid shift grids not found"),-1;var input={x:-point.x,y:point.y},output={x:Number.NaN,y:Number.NaN},attemptedGrids=[];outer:for(var i=0;i<source.grids.length;i++){var grid=source.grids[i];if(attemptedGrids.push(grid.name),grid.isNull){output=input;break}if(grid.mandatory,null!==grid.grid)for(var subgrids=grid.grid.subgrids,j=0,jj=subgrids.length;j<jj;j++){var subgrid=subgrids[j],epsilon=(Math.abs(subgrid.del[1])+Math.abs(subgrid.del[0]))/1e4,minX=subgrid.ll[0]-epsilon,minY=subgrid.ll[1]-epsilon,maxX=subgrid.ll[0]+(subgrid.lim[0]-1)*subgrid.del[0]+epsilon,maxY=subgrid.ll[1]+(subgrid.lim[1]-1)*subgrid.del[1]+epsilon;if(!(minY>input.y||minX>input.x||maxY<input.y||maxX<input.x)&&(output=applySubgridShift(input,inverse,subgrid),!isNaN(output.x)))break outer}else if(grid.mandatory)return console.log("Unable to find mandatory grid '"+grid.name+"'"),-1}return isNaN(output.x)?(console.log("Failed to find a grid shift table for location '"+-input.x*R2D+" "+input.y*R2D+" tried: '"+attemptedGrids+"'"),-1):(point.x=-output.x,point.y=output.y,0)}function applySubgridShift(pin,inverse,ct){var val={x:Number.NaN,y:Number.NaN};if(isNaN(pin.x))return val;var tb={x:pin.x,y:pin.y};tb.x-=ct.ll[0],tb.y-=ct.ll[1],tb.x=adjust_lon(tb.x-Math.PI)+Math.PI;var t=nadInterpolate(tb,ct);if(inverse){if(isNaN(t.x))return val;t.x=tb.x-t.x,t.y=tb.y-t.y;var dif,del,i=9;do{if(del=nadInterpolate(t,ct),isNaN(del.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}dif={x:tb.x-(del.x+t.x),y:tb.y-(del.y+t.y)},t.x+=dif.x,t.y+=dif.y}while(i--&&Math.abs(dif.x)>1e-12&&Math.abs(dif.y)>1e-12);if(i<0)return console.log("Inverse grid shift iterator failed to converge."),val;val.x=adjust_lon(t.x+ct.ll[0]),val.y=t.y+ct.ll[1]}else isNaN(t.x)||(val.x=pin.x+t.x,val.y=pin.y+t.y);return val}function nadInterpolate(pin,ct){var inx,t={x:pin.x/ct.del[0],y:pin.y/ct.del[1]},indx_x=Math.floor(t.x),indx_y=Math.floor(t.y),frct_x=t.x-1*indx_x,frct_y=t.y-1*indx_y,val={x:Number.NaN,y:Number.NaN};if(indx_x<0||indx_x>=ct.lim[0])return val;if(indx_y<0||indx_y>=ct.lim[1])return val;inx=indx_y*ct.lim[0]+indx_x;var f00_x=ct.cvs[inx][0],f00_y=ct.cvs[inx][1];inx++;var f10_x=ct.cvs[inx][0],f10_y=ct.cvs[inx][1];inx+=ct.lim[0];var f11_x=ct.cvs[inx][0],f11_y=ct.cvs[inx][1];inx--;var f01_x=ct.cvs[inx][0],f01_y=ct.cvs[inx][1],m11=frct_x*frct_y,m10=frct_x*(1-frct_y),m00=(1-frct_x)*(1-frct_y),m01=(1-frct_x)*frct_y;return val.x=m00*f00_x+m10*f10_x+m01*f01_x+m11*f11_x,val.y=m00*f00_y+m10*f10_y+m01*f01_y+m11*f11_y,val}function adjust_axis(crs,denorm,point){var v,t,i,xin=point.x,yin=point.y,zin=point.z||0,out={};for(i=0;i<3;i++)if(!denorm||2!==i||void 0!==point.z)switch(0===i?(v=xin,t=-1!=="ew".indexOf(crs.axis[i])?"x":"y"):1===i?(v=yin,t=-1!=="ns".indexOf(crs.axis[i])?"y":"x"):(v=zin,t="z"),crs.axis[i]){case"e":case"n":out[t]=v;break;case"w":case"s":out[t]=-v;break;case"u":void 0!==point[t]&&(out.z=v);break;case"d":void 0!==point[t]&&(out.z=-v);break;default:return null}return out}function toPoint(array){var out={x:array[0],y:array[1]};return array.length>2&&(out.z=array[2]),array.length>3&&(out.m=array[3]),out}function checkCoord(num){if("function"==typeof Number.isFinite){if(Number.isFinite(num))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof num||num!=num||!isFinite(num))throw new TypeError("coordinates must be finite numbers")}function transform(source,dest,point,enforceAxis){var wgs84,hasZ=void 0!==(point=Array.isArray(point)?toPoint(point):{x:point.x,y:point.y,z:point.z,m:point.m}).z;if(function checkSanity(point){checkCoord(point.x),checkCoord(point.y)}(point),source.datum&&dest.datum&&function checkNotWGS(source,dest){return(source.datum.datum_type===PJD_3PARAM||source.datum.datum_type===PJD_7PARAM||source.datum.datum_type===PJD_GRIDSHIFT)&&"WGS84"!==dest.datumCode||(dest.datum.datum_type===PJD_3PARAM||dest.datum.datum_type===PJD_7PARAM||dest.datum.datum_type===PJD_GRIDSHIFT)&&"WGS84"!==source.datumCode}(source,dest)&&(point=transform(source,wgs84=new Proj("WGS84"),point,enforceAxis),source=wgs84),enforceAxis&&"enu"!==source.axis&&(point=adjust_axis(source,!1,point)),"longlat"===source.projName)point={x:point.x*D2R,y:point.y*D2R,z:point.z||0};else if(source.to_meter&&(point={x:point.x*source.to_meter,y:point.y*source.to_meter,z:point.z||0}),!(point=source.inverse(point)))return;if(source.from_greenwich&&(point.x+=source.from_greenwich),point=datum_transform(source.datum,dest.datum,point))return dest.from_greenwich&&(point={x:point.x-dest.from_greenwich,y:point.y,z:point.z||0}),"longlat"===dest.projName?point={x:point.x*R2D,y:point.y*R2D,z:point.z||0}:(point=dest.forward(point),dest.to_meter&&(point={x:point.x/dest.to_meter,y:point.y/dest.to_meter,z:point.z||0})),enforceAxis&&"enu"!==dest.axis?adjust_axis(dest,!0,point):(point&&!hasZ&&delete point.z,point)}var wgs84=Proj("WGS84");function transformer(from,to,coords,enforceAxis){var transformedArray,out,keys;return Array.isArray(coords)?(transformedArray=transform(from,to,coords,enforceAxis)||{x:NaN,y:NaN},coords.length>2?void 0!==from.name&&"geocent"===from.name||void 0!==to.name&&"geocent"===to.name?"number"==typeof transformedArray.z?[transformedArray.x,transformedArray.y,transformedArray.z].concat(coords.splice(3)):[transformedArray.x,transformedArray.y,coords[2]].concat(coords.splice(3)):[transformedArray.x,transformedArray.y].concat(coords.splice(2)):[transformedArray.x,transformedArray.y]):(out=transform(from,to,coords,enforceAxis),2===(keys=Object.keys(coords)).length||keys.forEach((function(key){if(void 0!==from.name&&"geocent"===from.name||void 0!==to.name&&"geocent"===to.name){if("x"===key||"y"===key||"z"===key)return}else if("x"===key||"y"===key)return;out[key]=coords[key]})),out)}function checkProj(item){return item instanceof Proj?item:item.oProj?item.oProj:Proj(item)}const core=function core_proj4(fromProj,toProj,coord){fromProj=checkProj(fromProj);var obj,single=!1;return void 0===toProj?(toProj=fromProj,fromProj=wgs84,single=!0):(void 0!==toProj.x||Array.isArray(toProj))&&(coord=toProj,toProj=fromProj,fromProj=wgs84,single=!0),toProj=checkProj(toProj),coord?transformer(fromProj,toProj,coord):(obj={forward:function(coords,enforceAxis){return transformer(fromProj,toProj,coords,enforceAxis)},inverse:function(coords,enforceAxis){return transformer(toProj,fromProj,coords,enforceAxis)}},single&&(obj.oProj=toProj),obj)};var NUM_100K_SETS=6,SET_ORIGIN_COLUMN_LETTERS="AJSAJS",SET_ORIGIN_ROW_LETTERS="AFAFAF",A=65,I=73,O=79,V=86,Z=90;const mgrs={forward:mgrs_forward,inverse:function mgrs_inverse(mgrs){var bbox=UTMtoLL(decode(mgrs.toUpperCase()));if(bbox.lat&&bbox.lon)return[bbox.lon,bbox.lat,bbox.lon,bbox.lat];return[bbox.left,bbox.bottom,bbox.right,bbox.top]},toPoint:mgrs_toPoint};function mgrs_forward(ll,accuracy){return accuracy=accuracy||5,function encode(utm,accuracy){var seasting="00000"+utm.easting,snorthing="00000"+utm.northing;return utm.zoneNumber+utm.zoneLetter+function get100kID(easting,northing,zoneNumber){var setParm=get100kSetForZone(zoneNumber),setColumn=Math.floor(easting/1e5),setRow=Math.floor(northing/1e5)%20;return function getLetter100kID(column,row,parm){var index=parm-1,colOrigin=SET_ORIGIN_COLUMN_LETTERS.charCodeAt(index),rowOrigin=SET_ORIGIN_ROW_LETTERS.charCodeAt(index),colInt=colOrigin+column-1,rowInt=rowOrigin+row,rollover=!1;colInt>Z&&(colInt=colInt-Z+A-1,rollover=!0);(colInt===I||colOrigin<I&&colInt>I||(colInt>I||colOrigin<I)&&rollover)&&colInt++;(colInt===O||colOrigin<O&&colInt>O||(colInt>O||colOrigin<O)&&rollover)&&++colInt===I&&colInt++;colInt>Z&&(colInt=colInt-Z+A-1);rowInt>V?(rowInt=rowInt-V+A-1,rollover=!0):rollover=!1;(rowInt===I||rowOrigin<I&&rowInt>I||(rowInt>I||rowOrigin<I)&&rollover)&&rowInt++;(rowInt===O||rowOrigin<O&&rowInt>O||(rowInt>O||rowOrigin<O)&&rollover)&&++rowInt===I&&rowInt++;rowInt>V&&(rowInt=rowInt-V+A-1);return String.fromCharCode(colInt)+String.fromCharCode(rowInt)}(setColumn,setRow,setParm)}(utm.easting,utm.northing,utm.zoneNumber)+seasting.substr(seasting.length-5,accuracy)+snorthing.substr(snorthing.length-5,accuracy)}(function LLtoUTM(ll){var eccPrimeSquared,N,T,C,A,M,LongOriginRad,ZoneNumber,Lat=ll.lat,Long=ll.lon,a=6378137,eccSquared=.00669438,k0=.9996,LatRad=degToRad(Lat),LongRad=degToRad(Long);ZoneNumber=Math.floor((Long+180)/6)+1,180===Long&&(ZoneNumber=60);Lat>=56&&Lat<64&&Long>=3&&Long<12&&(ZoneNumber=32);Lat>=72&&Lat<84&&(Long>=0&&Long<9?ZoneNumber=31:Long>=9&&Long<21?ZoneNumber=33:Long>=21&&Long<33?ZoneNumber=35:Long>=33&&Long<42&&(ZoneNumber=37));LongOriginRad=degToRad(6*(ZoneNumber-1)-180+3),eccPrimeSquared=eccSquared/(1-eccSquared),N=a/Math.sqrt(1-eccSquared*Math.sin(LatRad)*Math.sin(LatRad)),T=Math.tan(LatRad)*Math.tan(LatRad),C=eccPrimeSquared*Math.cos(LatRad)*Math.cos(LatRad),A=Math.cos(LatRad)*(LongRad-LongOriginRad),M=a*((1-eccSquared/4-3*eccSquared*eccSquared/64-5*eccSquared*eccSquared*eccSquared/256)*LatRad-(3*eccSquared/8+3*eccSquared*eccSquared/32+45*eccSquared*eccSquared*eccSquared/1024)*Math.sin(2*LatRad)+(15*eccSquared*eccSquared/256+45*eccSquared*eccSquared*eccSquared/1024)*Math.sin(4*LatRad)-35*eccSquared*eccSquared*eccSquared/3072*Math.sin(6*LatRad));var UTMEasting=k0*N*(A+(1-T+C)*A*A*A/6+(5-18*T+T*T+72*C-58*eccPrimeSquared)*A*A*A*A*A/120)+5e5,UTMNorthing=k0*(M+N*Math.tan(LatRad)*(A*A/2+(5-T+9*C+4*C*C)*A*A*A*A/24+(61-58*T+T*T+600*C-330*eccPrimeSquared)*A*A*A*A*A*A/720));Lat<0&&(UTMNorthing+=1e7);return{northing:Math.round(UTMNorthing),easting:Math.round(UTMEasting),zoneNumber:ZoneNumber,zoneLetter:getLetterDesignator(Lat)}}({lat:ll[1],lon:ll[0]}),accuracy)}function mgrs_toPoint(mgrs){var bbox=UTMtoLL(decode(mgrs.toUpperCase()));return bbox.lat&&bbox.lon?[bbox.lon,bbox.lat]:[(bbox.left+bbox.right)/2,(bbox.top+bbox.bottom)/2]}function degToRad(deg){return deg*(Math.PI/180)}function radToDeg(rad){return rad/Math.PI*180}function UTMtoLL(utm){var UTMNorthing=utm.northing,UTMEasting=utm.easting,zoneLetter=utm.zoneLetter,zoneNumber=utm.zoneNumber;if(zoneNumber<0||zoneNumber>60)return null;var N1,T1,C1,R1,D,LongOrigin,mu,phi1Rad,a=6378137,e1=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),x=UTMEasting-5e5,y=UTMNorthing;zoneLetter<"N"&&(y-=1e7),LongOrigin=6*(zoneNumber-1)-180+3,phi1Rad=(mu=y/.9996/6367449.145945056)+(3*e1/2-27*e1*e1*e1/32)*Math.sin(2*mu)+(21*e1*e1/16-55*e1*e1*e1*e1/32)*Math.sin(4*mu)+151*e1*e1*e1/96*Math.sin(6*mu),N1=a/Math.sqrt(1-.00669438*Math.sin(phi1Rad)*Math.sin(phi1Rad)),T1=Math.tan(phi1Rad)*Math.tan(phi1Rad),C1=.006739496752268451*Math.cos(phi1Rad)*Math.cos(phi1Rad),R1=.99330562*a/Math.pow(1-.00669438*Math.sin(phi1Rad)*Math.sin(phi1Rad),1.5),D=x/(.9996*N1);var lat=phi1Rad-N1*Math.tan(phi1Rad)/R1*(D*D/2-(5+3*T1+10*C1-4*C1*C1-.06065547077041606)*D*D*D*D/24+(61+90*T1+298*C1+45*T1*T1-1.6983531815716497-3*C1*C1)*D*D*D*D*D*D/720);lat=radToDeg(lat);var result,lon=(D-(1+2*T1+C1)*D*D*D/6+(5-2*C1+28*T1-3*C1*C1+.05391597401814761+24*T1*T1)*D*D*D*D*D/120)/Math.cos(phi1Rad);if(lon=LongOrigin+radToDeg(lon),utm.accuracy){var topRight=UTMtoLL({northing:utm.northing+utm.accuracy,easting:utm.easting+utm.accuracy,zoneLetter:utm.zoneLetter,zoneNumber:utm.zoneNumber});result={top:topRight.lat,right:topRight.lon,bottom:lat,left:lon}}else result={lat,lon};return result}function getLetterDesignator(lat){var LetterDesignator="Z";return 84>=lat&&lat>=72?LetterDesignator="X":72>lat&&lat>=64?LetterDesignator="W":64>lat&&lat>=56?LetterDesignator="V":56>lat&&lat>=48?LetterDesignator="U":48>lat&&lat>=40?LetterDesignator="T":40>lat&&lat>=32?LetterDesignator="S":32>lat&&lat>=24?LetterDesignator="R":24>lat&&lat>=16?LetterDesignator="Q":16>lat&&lat>=8?LetterDesignator="P":8>lat&&lat>=0?LetterDesignator="N":0>lat&&lat>=-8?LetterDesignator="M":-8>lat&&lat>=-16?LetterDesignator="L":-16>lat&&lat>=-24?LetterDesignator="K":-24>lat&&lat>=-32?LetterDesignator="J":-32>lat&&lat>=-40?LetterDesignator="H":-40>lat&&lat>=-48?LetterDesignator="G":-48>lat&&lat>=-56?LetterDesignator="F":-56>lat&&lat>=-64?LetterDesignator="E":-64>lat&&lat>=-72?LetterDesignator="D":-72>lat&&lat>=-80&&(LetterDesignator="C"),LetterDesignator}function get100kSetForZone(i){var setParm=i%NUM_100K_SETS;return 0===setParm&&(setParm=NUM_100K_SETS),setParm}function decode(mgrsString){if(mgrsString&&0===mgrsString.length)throw"MGRSPoint coverting from nothing";for(var testChar,length=mgrsString.length,hunK=null,sb="",i=0;!/[A-Z]/.test(testChar=mgrsString.charAt(i));){if(i>=2)throw"MGRSPoint bad conversion from: "+mgrsString;sb+=testChar,i++}var zoneNumber=parseInt(sb,10);if(0===i||i+3>length)throw"MGRSPoint bad conversion from: "+mgrsString;var zoneLetter=mgrsString.charAt(i++);if(zoneLetter<="A"||"B"===zoneLetter||"Y"===zoneLetter||zoneLetter>="Z"||"I"===zoneLetter||"O"===zoneLetter)throw"MGRSPoint zone letter "+zoneLetter+" not handled: "+mgrsString;hunK=mgrsString.substring(i,i+=2);for(var set=get100kSetForZone(zoneNumber),east100k=function getEastingFromChar(e,set){var curCol=SET_ORIGIN_COLUMN_LETTERS.charCodeAt(set-1),eastingValue=1e5,rewindMarker=!1;for(;curCol!==e.charCodeAt(0);){if(++curCol===I&&curCol++,curCol===O&&curCol++,curCol>Z){if(rewindMarker)throw"Bad character: "+e;curCol=A,rewindMarker=!0}eastingValue+=1e5}return eastingValue}(hunK.charAt(0),set),north100k=function getNorthingFromChar(n,set){if(n>"V")throw"MGRSPoint given invalid Northing "+n;var curRow=SET_ORIGIN_ROW_LETTERS.charCodeAt(set-1),northingValue=0,rewindMarker=!1;for(;curRow!==n.charCodeAt(0);){if(++curRow===I&&curRow++,curRow===O&&curRow++,curRow>V){if(rewindMarker)throw"Bad character: "+n;curRow=A,rewindMarker=!0}northingValue+=1e5}return northingValue}(hunK.charAt(1),set);north100k<getMinNorthing(zoneLetter);)north100k+=2e6;var remainder=length-i;if(remainder%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+mgrsString;var accuracyBonus,sepEastingString,sepNorthingString,sep=remainder/2,sepEasting=0,sepNorthing=0;return sep>0&&(accuracyBonus=1e5/Math.pow(10,sep),sepEastingString=mgrsString.substring(i,i+sep),sepEasting=parseFloat(sepEastingString)*accuracyBonus,sepNorthingString=mgrsString.substring(i+sep),sepNorthing=parseFloat(sepNorthingString)*accuracyBonus),{easting:sepEasting+east100k,northing:sepNorthing+north100k,zoneLetter,zoneNumber,accuracy:accuracyBonus}}function getMinNorthing(zoneLetter){var northing;switch(zoneLetter){case"C":northing=11e5;break;case"D":northing=2e6;break;case"E":northing=28e5;break;case"F":northing=37e5;break;case"G":northing=46e5;break;case"H":northing=55e5;break;case"J":northing=64e5;break;case"K":northing=73e5;break;case"L":northing=82e5;break;case"M":northing=91e5;break;case"N":northing=0;break;case"P":northing=8e5;break;case"Q":northing=17e5;break;case"R":northing=26e5;break;case"S":northing=35e5;break;case"T":northing=44e5;break;case"U":northing=53e5;break;case"V":northing=62e5;break;case"W":northing=7e6;break;case"X":northing=79e5;break;default:northing=-1}if(northing>=0)return northing;throw"Invalid zone letter: "+zoneLetter}function Point(x,y,z){if(!(this instanceof Point))return new Point(x,y,z);if(Array.isArray(x))this.x=x[0],this.y=x[1],this.z=x[2]||0;else if("object"==typeof x)this.x=x.x,this.y=x.y,this.z=x.z||0;else if("string"==typeof x&&void 0===y){var coords=x.split(",");this.x=parseFloat(coords[0],10),this.y=parseFloat(coords[1],10),this.z=parseFloat(coords[2],10)||0}else this.x=x,this.y=y,this.z=z||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}Point.fromMGRS=function(mgrsStr){return new Point(mgrs_toPoint(mgrsStr))},Point.prototype.toMGRS=function(accuracy){return mgrs_forward([this.x,this.y],accuracy)};const lib_Point=Point;var C00=1,C02=.25,C04=.046875,C06=.01953125,C08=.01068115234375,C22=.75,C44=.46875,C46=.013020833333333334,C48=.007120768229166667,C66=.3645833333333333,C68=.005696614583333333,C88=.3076171875;function pj_enfn(es){var en=[];en[0]=C00-es*(C02+es*(C04+es*(C06+es*C08))),en[1]=es*(C22-es*(C04+es*(C06+es*C08)));var t=es*es;return en[2]=t*(C44-es*(C46+es*C48)),t*=es,en[3]=t*(C66-es*C68),en[4]=t*es*C88,en}function pj_mlfn(phi,sphi,cphi,en){return cphi*=sphi,sphi*=sphi,en[0]*phi-cphi*(en[1]+sphi*(en[2]+sphi*(en[3]+sphi*en[4])))}var MAX_ITER=20;function pj_inv_mlfn(arg,es,en){for(var k=1/(1-es),phi=arg,i=MAX_ITER;i;--i){var s=Math.sin(phi),t=1-es*s*s;if(phi-=t=(pj_mlfn(phi,s,Math.cos(phi),en)-arg)*(t*Math.sqrt(t))*k,Math.abs(t)<EPSLN)return phi}return phi}const tmerc={init:function tmerc_init(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=pj_enfn(this.es),this.ml0=pj_mlfn(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function tmerc_forward(p){var con,x,y,lon=p.x,lat=p.y,delta_lon=adjust_lon(lon-this.long0),sin_phi=Math.sin(lat),cos_phi=Math.cos(lat);if(this.es){var al=cos_phi*delta_lon,als=Math.pow(al,2),c=this.ep2*Math.pow(cos_phi,2),cs=Math.pow(c,2),tq=Math.abs(cos_phi)>EPSLN?Math.tan(lat):0,t=Math.pow(tq,2),ts=Math.pow(t,2);con=1-this.es*Math.pow(sin_phi,2),al/=Math.sqrt(con);var ml=pj_mlfn(lat,sin_phi,cos_phi,this.en);x=this.a*(this.k0*al*(1+als/6*(1-t+c+als/20*(5-18*t+ts+14*c-58*t*c+als/42*(61+179*ts-ts*t-479*t)))))+this.x0,y=this.a*(this.k0*(ml-this.ml0+sin_phi*delta_lon*al/2*(1+als/12*(5-t+9*c+4*cs+als/30*(61+ts-58*t+270*c-330*t*c+als/56*(1385+543*ts-ts*t-3111*t))))))+this.y0}else{var b=cos_phi*Math.sin(delta_lon);if(Math.abs(Math.abs(b)-1)<EPSLN)return 93;if(x=.5*this.a*this.k0*Math.log((1+b)/(1-b))+this.x0,y=cos_phi*Math.cos(delta_lon)/Math.sqrt(1-Math.pow(b,2)),(b=Math.abs(y))>=1){if(b-1>EPSLN)return 93;y=0}else y=Math.acos(y);lat<0&&(y=-y),y=this.a*this.k0*(y-this.lat0)+this.y0}return p.x=x,p.y=y,p},inverse:function tmerc_inverse(p){var con,phi,lat,lon,x=(p.x-this.x0)*(1/this.a),y=(p.y-this.y0)*(1/this.a);if(this.es)if(phi=pj_inv_mlfn(con=this.ml0+y/this.k0,this.es,this.en),Math.abs(phi)<HALF_PI){var sin_phi=Math.sin(phi),cos_phi=Math.cos(phi),tan_phi=Math.abs(cos_phi)>EPSLN?Math.tan(phi):0,c=this.ep2*Math.pow(cos_phi,2),cs=Math.pow(c,2),t=Math.pow(tan_phi,2),ts=Math.pow(t,2);con=1-this.es*Math.pow(sin_phi,2);var d=x*Math.sqrt(con)/this.k0,ds=Math.pow(d,2);lat=phi-(con*=tan_phi)*ds/(1-this.es)*.5*(1-ds/12*(5+3*t-9*c*t+c-4*cs-ds/30*(61+90*t-252*c*t+45*ts+46*c-ds/56*(1385+3633*t+4095*ts+1574*ts*t)))),lon=adjust_lon(this.long0+d*(1-ds/6*(1+2*t+c-ds/20*(5+28*t+24*ts+8*c*t+6*c-ds/42*(61+662*t+1320*ts+720*ts*t))))/cos_phi)}else lat=HALF_PI*sign(y),lon=0;else{var f=Math.exp(x/this.k0),g=.5*(f-1/f),temp=this.lat0+y/this.k0,h=Math.cos(temp);con=Math.sqrt((1-Math.pow(h,2))/(1+Math.pow(g,2))),lat=Math.asin(con),y<0&&(lat=-lat),lon=0===g&&0===h?0:adjust_lon(Math.atan2(g,h)+this.long0)}return p.x=lon,p.y=lat,p},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function sinh(x){var r=Math.exp(x);return r=(r-1/r)/2}function hypot(x,y){x=Math.abs(x),y=Math.abs(y);var a=Math.max(x,y),b=Math.min(x,y)/(a||1);return a*Math.sqrt(1+Math.pow(b,2))}function asinhy(x){var y=Math.abs(x);return y=function log1py(x){var y=1+x,z=y-1;return 0===z?x:x*Math.log(y)/z}(y*(1+y/(hypot(1,y)+1))),x<0?-y:y}function gatg(pp,B){for(var h,cos_2B=2*Math.cos(2*B),i=pp.length-1,h1=pp[i],h2=0;--i>=0;)h=cos_2B*h1-h2+pp[i],h2=h1,h1=h;return B+h*Math.sin(2*B)}function clens_cmplx(pp,arg_r,arg_i){for(var hr2,hi2,sin_arg_r=Math.sin(arg_r),cos_arg_r=Math.cos(arg_r),sinh_arg_i=sinh(arg_i),cosh_arg_i=function cosh(x){var r=Math.exp(x);return(r+1/r)/2}(arg_i),r=2*cos_arg_r*cosh_arg_i,i=-2*sin_arg_r*sinh_arg_i,j=pp.length-1,hr=pp[j],hi1=0,hr1=0,hi=0;--j>=0;)hr2=hr1,hi2=hi1,hr=r*(hr1=hr)-hr2-i*(hi1=hi)+pp[j],hi=i*hr1-hi2+r*hi1;return[(r=sin_arg_r*cosh_arg_i)*hr-(i=cos_arg_r*sinh_arg_i)*hi,r*hi+i*hr]}const etmerc={init:function etmerc_init(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(tmerc.init.apply(this),this.forward=tmerc.forward,this.inverse=tmerc.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var f=this.es/(1+Math.sqrt(1-this.es)),n=f/(2-f),np=n;this.cgb[0]=n*(2+n*(-2/3+n*(n*(116/45+n*(26/45+n*(-2854/675)))-2))),this.cbg[0]=n*(n*(2/3+n*(4/3+n*(-82/45+n*(32/45+n*(4642/4725)))))-2),np*=n,this.cgb[1]=np*(7/3+n*(n*(-227/45+n*(2704/315+n*(2323/945)))-1.6)),this.cbg[1]=np*(5/3+n*(-16/15+n*(-13/9+n*(904/315+n*(-1522/945))))),np*=n,this.cgb[2]=np*(56/15+n*(-136/35+n*(-1262/105+n*(73814/2835)))),this.cbg[2]=np*(-26/15+n*(34/21+n*(1.6+n*(-12686/2835)))),np*=n,this.cgb[3]=np*(4279/630+n*(-332/35+n*(-399572/14175))),this.cbg[3]=np*(1237/630+n*(n*(-24832/14175)-2.4)),np*=n,this.cgb[4]=np*(4174/315+n*(-144838/6237)),this.cbg[4]=np*(-734/315+n*(109598/31185)),np*=n,this.cgb[5]=np*(601676/22275),this.cbg[5]=np*(444337/155925),np=Math.pow(n,2),this.Qn=this.k0/(1+n)*(1+np*(1/4+np*(1/64+np/256))),this.utg[0]=n*(n*(2/3+n*(-37/96+n*(1/360+n*(81/512+n*(-96199/604800)))))-.5),this.gtu[0]=n*(.5+n*(-2/3+n*(5/16+n*(41/180+n*(-127/288+n*(7891/37800)))))),this.utg[1]=np*(-1/48+n*(-1/15+n*(437/1440+n*(-46/105+n*(1118711/3870720))))),this.gtu[1]=np*(13/48+n*(n*(557/1440+n*(281/630+n*(-1983433/1935360)))-.6)),np*=n,this.utg[2]=np*(-17/480+n*(37/840+n*(209/4480+n*(-5569/90720)))),this.gtu[2]=np*(61/240+n*(-103/140+n*(15061/26880+n*(167603/181440)))),np*=n,this.utg[3]=np*(-4397/161280+n*(11/504+n*(830251/7257600))),this.gtu[3]=np*(49561/161280+n*(-179/168+n*(6601661/7257600))),np*=n,this.utg[4]=np*(-4583/161280+n*(108847/3991680)),this.gtu[4]=np*(34729/80640+n*(-3418889/1995840)),np*=n,this.utg[5]=np*(-20648693/638668800),this.gtu[5]=.6650675310896665*np;var Z=gatg(this.cbg,this.lat0);this.Zb=-this.Qn*(Z+function clens(pp,arg_r){for(var hr,r=2*Math.cos(arg_r),i=pp.length-1,hr1=pp[i],hr2=0;--i>=0;)hr=r*hr1-hr2+pp[i],hr2=hr1,hr1=hr;return Math.sin(arg_r)*hr}(this.gtu,2*Z))},forward:function etmerc_forward(p){var Ce=adjust_lon(p.x-this.long0),Cn=p.y;Cn=gatg(this.cbg,Cn);var sin_Cn=Math.sin(Cn),cos_Cn=Math.cos(Cn),sin_Ce=Math.sin(Ce),cos_Ce=Math.cos(Ce);Cn=Math.atan2(sin_Cn,cos_Ce*cos_Cn),Ce=Math.atan2(sin_Ce*cos_Cn,hypot(sin_Cn,cos_Cn*cos_Ce)),Ce=asinhy(Math.tan(Ce));var x,y,tmp=clens_cmplx(this.gtu,2*Cn,2*Ce);return Cn+=tmp[0],Ce+=tmp[1],Math.abs(Ce)<=2.623395162778?(x=this.a*(this.Qn*Ce)+this.x0,y=this.a*(this.Qn*Cn+this.Zb)+this.y0):(x=1/0,y=1/0),p.x=x,p.y=y,p},inverse:function etmerc_inverse(p){var lon,lat,Ce=(p.x-this.x0)*(1/this.a),Cn=(p.y-this.y0)*(1/this.a);if(Cn=(Cn-this.Zb)/this.Qn,Ce/=this.Qn,Math.abs(Ce)<=2.623395162778){var tmp=clens_cmplx(this.utg,2*Cn,2*Ce);Cn+=tmp[0],Ce+=tmp[1],Ce=Math.atan(sinh(Ce));var sin_Cn=Math.sin(Cn),cos_Cn=Math.cos(Cn),sin_Ce=Math.sin(Ce),cos_Ce=Math.cos(Ce);Cn=Math.atan2(sin_Cn*cos_Ce,hypot(sin_Ce,cos_Ce*cos_Cn)),lon=adjust_lon((Ce=Math.atan2(sin_Ce,cos_Ce*cos_Cn))+this.long0),lat=gatg(this.cgb,Cn)}else lon=1/0,lat=1/0;return p.x=lon,p.y=lat,p},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"]};const utm={init:function utm_init(){var zone=function adjust_zone(zone,lon){if(void 0===zone){if((zone=Math.floor(30*(adjust_lon(lon)+Math.PI)/Math.PI)+1)<0)return 0;if(zone>60)return 60}return zone}(this.zone,this.long0);if(void 0===zone)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(zone)-183)*D2R,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,etmerc.init.apply(this),this.forward=etmerc.forward,this.inverse=etmerc.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function srat(esinp,exp){return Math.pow((1-esinp)/(1+esinp),exp)}const gauss={init:function gauss_init(){var sphi=Math.sin(this.lat0),cphi=Math.cos(this.lat0);cphi*=cphi,this.rc=Math.sqrt(1-this.es)/(1-this.es*sphi*sphi),this.C=Math.sqrt(1+this.es*cphi*cphi/(1-this.es)),this.phic0=Math.asin(sphi/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+FORTPI)/(Math.pow(Math.tan(.5*this.lat0+FORTPI),this.C)*srat(this.e*sphi,this.ratexp))},forward:function gauss_forward(p){var lon=p.x,lat=p.y;return p.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*lat+FORTPI),this.C)*srat(this.e*Math.sin(lat),this.ratexp))-HALF_PI,p.x=this.C*lon,p},inverse:function gauss_inverse(p){for(var lon=p.x/this.C,lat=p.y,num=Math.pow(Math.tan(.5*lat+FORTPI)/this.K,1/this.C),i=20;i>0&&(lat=2*Math.atan(num*srat(this.e*Math.sin(p.y),-.5*this.e))-HALF_PI,!(Math.abs(lat-p.y)<1e-14));--i)p.y=lat;return i?(p.x=lon,p.y=lat,p):null},names:["gauss"]};const sterea={init:function sterea_init(){gauss.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function sterea_forward(p){var sinc,cosc,cosl,k;return p.x=adjust_lon(p.x-this.long0),gauss.forward.apply(this,[p]),sinc=Math.sin(p.y),cosc=Math.cos(p.y),cosl=Math.cos(p.x),k=this.k0*this.R2/(1+this.sinc0*sinc+this.cosc0*cosc*cosl),p.x=k*cosc*Math.sin(p.x),p.y=k*(this.cosc0*sinc-this.sinc0*cosc*cosl),p.x=this.a*p.x+this.x0,p.y=this.a*p.y+this.y0,p},inverse:function sterea_inverse(p){var sinc,cosc,lon,lat,rho;if(p.x=(p.x-this.x0)/this.a,p.y=(p.y-this.y0)/this.a,p.x/=this.k0,p.y/=this.k0,rho=Math.sqrt(p.x*p.x+p.y*p.y)){var c=2*Math.atan2(rho,this.R2);sinc=Math.sin(c),cosc=Math.cos(c),lat=Math.asin(cosc*this.sinc0+p.y*sinc*this.cosc0/rho),lon=Math.atan2(p.x*sinc,rho*this.cosc0*cosc-p.y*this.sinc0*sinc)}else lat=this.phic0,lon=0;return p.x=lon,p.y=lat,gauss.inverse.apply(this,[p]),p.x=adjust_lon(p.x+this.long0),p},names:["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]};const stere={init:function stere_init(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=EPSLN&&(this.k0=.5*(1+sign(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=EPSLN&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=EPSLN&&Math.abs(Math.cos(this.lat_ts))>EPSLN&&(this.k0=.5*this.cons*msfnz(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/tsfnz(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=msfnz(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-HALF_PI,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function stere_forward(p){var A,X,sinX,cosX,ts,rh,lon=p.x,lat=p.y,sinlat=Math.sin(lat),coslat=Math.cos(lat),dlon=adjust_lon(lon-this.long0);return Math.abs(Math.abs(lon-this.long0)-Math.PI)<=EPSLN&&Math.abs(lat+this.lat0)<=EPSLN?(p.x=NaN,p.y=NaN,p):this.sphere?(A=2*this.k0/(1+this.sinlat0*sinlat+this.coslat0*coslat*Math.cos(dlon)),p.x=this.a*A*coslat*Math.sin(dlon)+this.x0,p.y=this.a*A*(this.coslat0*sinlat-this.sinlat0*coslat*Math.cos(dlon))+this.y0,p):(X=2*Math.atan(this.ssfn_(lat,sinlat,this.e))-HALF_PI,cosX=Math.cos(X),sinX=Math.sin(X),Math.abs(this.coslat0)<=EPSLN?(ts=tsfnz(this.e,lat*this.con,this.con*sinlat),rh=2*this.a*this.k0*ts/this.cons,p.x=this.x0+rh*Math.sin(lon-this.long0),p.y=this.y0-this.con*rh*Math.cos(lon-this.long0),p):(Math.abs(this.sinlat0)<EPSLN?(A=2*this.a*this.k0/(1+cosX*Math.cos(dlon)),p.y=A*sinX):(A=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*sinX+this.cosX0*cosX*Math.cos(dlon))),p.y=A*(this.cosX0*sinX-this.sinX0*cosX*Math.cos(dlon))+this.y0),p.x=A*cosX*Math.sin(dlon)+this.x0,p))},inverse:function stere_inverse(p){var lon,lat,ts,ce,Chi;p.x-=this.x0,p.y-=this.y0;var rh=Math.sqrt(p.x*p.x+p.y*p.y);if(this.sphere){var c=2*Math.atan(rh/(2*this.a*this.k0));return lon=this.long0,lat=this.lat0,rh<=EPSLN?(p.x=lon,p.y=lat,p):(lat=Math.asin(Math.cos(c)*this.sinlat0+p.y*Math.sin(c)*this.coslat0/rh),lon=Math.abs(this.coslat0)<EPSLN?this.lat0>0?adjust_lon(this.long0+Math.atan2(p.x,-1*p.y)):adjust_lon(this.long0+Math.atan2(p.x,p.y)):adjust_lon(this.long0+Math.atan2(p.x*Math.sin(c),rh*this.coslat0*Math.cos(c)-p.y*this.sinlat0*Math.sin(c))),p.x=lon,p.y=lat,p)}if(Math.abs(this.coslat0)<=EPSLN){if(rh<=EPSLN)return lat=this.lat0,lon=this.long0,p.x=lon,p.y=lat,p;p.x*=this.con,p.y*=this.con,ts=rh*this.cons/(2*this.a*this.k0),lat=this.con*phi2z(this.e,ts),lon=this.con*adjust_lon(this.con*this.long0+Math.atan2(p.x,-1*p.y))}else ce=2*Math.atan(rh*this.cosX0/(2*this.a*this.k0*this.ms1)),lon=this.long0,rh<=EPSLN?Chi=this.X0:(Chi=Math.asin(Math.cos(ce)*this.sinX0+p.y*Math.sin(ce)*this.cosX0/rh),lon=adjust_lon(this.long0+Math.atan2(p.x*Math.sin(ce),rh*this.cosX0*Math.cos(ce)-p.y*this.sinX0*Math.sin(ce)))),lat=-1*phi2z(this.e,Math.tan(.5*(HALF_PI+Chi)));return p.x=lon,p.y=lat,p},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)","Polar_Stereographic"],ssfn_:function ssfn_(phit,sinphi,eccen){return sinphi*=eccen,Math.tan(.5*(HALF_PI+phit))*Math.pow((1-sinphi)/(1+sinphi),.5*eccen)}};const somerc={init:function somerc_init(){var phy0=this.lat0;this.lambda0=this.long0;var sinPhy0=Math.sin(phy0),semiMajorAxis=this.a,flattening=1/this.rf,e2=2*flattening-Math.pow(flattening,2),e=this.e=Math.sqrt(e2);this.R=this.k0*semiMajorAxis*Math.sqrt(1-e2)/(1-e2*Math.pow(sinPhy0,2)),this.alpha=Math.sqrt(1+e2/(1-e2)*Math.pow(Math.cos(phy0),4)),this.b0=Math.asin(sinPhy0/this.alpha);var k1=Math.log(Math.tan(Math.PI/4+this.b0/2)),k2=Math.log(Math.tan(Math.PI/4+phy0/2)),k3=Math.log((1+e*sinPhy0)/(1-e*sinPhy0));this.K=k1-this.alpha*k2+this.alpha*e/2*k3},forward:function somerc_forward(p){var Sa1=Math.log(Math.tan(Math.PI/4-p.y/2)),Sa2=this.e/2*Math.log((1+this.e*Math.sin(p.y))/(1-this.e*Math.sin(p.y))),S=-this.alpha*(Sa1+Sa2)+this.K,b=2*(Math.atan(Math.exp(S))-Math.PI/4),I=this.alpha*(p.x-this.lambda0),rotI=Math.atan(Math.sin(I)/(Math.sin(this.b0)*Math.tan(b)+Math.cos(this.b0)*Math.cos(I))),rotB=Math.asin(Math.cos(this.b0)*Math.sin(b)-Math.sin(this.b0)*Math.cos(b)*Math.cos(I));return p.y=this.R/2*Math.log((1+Math.sin(rotB))/(1-Math.sin(rotB)))+this.y0,p.x=this.R*rotI+this.x0,p},inverse:function somerc_inverse(p){for(var Y=p.x-this.x0,X=p.y-this.y0,rotI=Y/this.R,rotB=2*(Math.atan(Math.exp(X/this.R))-Math.PI/4),b=Math.asin(Math.cos(this.b0)*Math.sin(rotB)+Math.sin(this.b0)*Math.cos(rotB)*Math.cos(rotI)),I=Math.atan(Math.sin(rotI)/(Math.cos(this.b0)*Math.cos(rotI)-Math.sin(this.b0)*Math.tan(rotB))),lambda=this.lambda0+I/this.alpha,S=0,phy=b,prevPhy=-1e3,iteration=0;Math.abs(phy-prevPhy)>1e-7;){if(++iteration>20)return;S=1/this.alpha*(Math.log(Math.tan(Math.PI/4+b/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(phy))/2)),prevPhy=phy,phy=2*Math.atan(Math.exp(S))-Math.PI/2}return p.x=lambda,p.y=phy,p},names:["somerc"]};const omerc={init:function omerc_init(){var con,com,cosph0,D,F,H,L,sinph0,p,J,gamma0,gamma=0,lamc=0,lam1=0,lam2=0,phi1=0,phi2=0,alpha_c=0;this.no_off=function isTypeA(P){var projectionName="object"==typeof P.PROJECTION?Object.keys(P.PROJECTION)[0]:P.PROJECTION;return"no_uoff"in P||"no_off"in P||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(projectionName)}(this),this.no_rot="no_rot"in this;var alp=!1;"alpha"in this&&(alp=!0);var gam=!1;if("rectified_grid_angle"in this&&(gam=!0),alp&&(alpha_c=this.alpha),gam&&(gamma=this.rectified_grid_angle*D2R),alp||gam)lamc=this.longc;else if(lam1=this.long1,phi1=this.lat1,lam2=this.long2,phi2=this.lat2,Math.abs(phi1-phi2)<=1e-7||(con=Math.abs(phi1))<=1e-7||Math.abs(con-HALF_PI)<=1e-7||Math.abs(Math.abs(this.lat0)-HALF_PI)<=1e-7||Math.abs(Math.abs(phi2)-HALF_PI)<=1e-7)throw new Error;var one_es=1-this.es;com=Math.sqrt(one_es),Math.abs(this.lat0)>EPSLN?(sinph0=Math.sin(this.lat0),cosph0=Math.cos(this.lat0),con=1-this.es*sinph0*sinph0,this.B=cosph0*cosph0,this.B=Math.sqrt(1+this.es*this.B*this.B/one_es),this.A=this.B*this.k0*com/con,(F=(D=this.B*com/(cosph0*Math.sqrt(con)))*D-1)<=0?F=0:(F=Math.sqrt(F),this.lat0<0&&(F=-F)),this.E=F+=D,this.E*=Math.pow(tsfnz(this.e,this.lat0,sinph0),this.B)):(this.B=1/com,this.A=this.k0,this.E=D=F=1),alp||gam?(alp?(gamma0=Math.asin(Math.sin(alpha_c)/D),gam||(gamma=alpha_c)):(gamma0=gamma,alpha_c=Math.asin(D*Math.sin(gamma0))),this.lam0=lamc-Math.asin(.5*(F-1/F)*Math.tan(gamma0))/this.B):(H=Math.pow(tsfnz(this.e,phi1,Math.sin(phi1)),this.B),L=Math.pow(tsfnz(this.e,phi2,Math.sin(phi2)),this.B),F=this.E/H,p=(L-H)/(L+H),J=((J=this.E*this.E)-L*H)/(J+L*H),(con=lam1-lam2)<-Math.pi?lam2-=TWO_PI:con>Math.pi&&(lam2+=TWO_PI),this.lam0=adjust_lon(.5*(lam1+lam2)-Math.atan(J*Math.tan(.5*this.B*(lam1-lam2))/p)/this.B),gamma0=Math.atan(2*Math.sin(this.B*adjust_lon(lam1-this.lam0))/(F-1/F)),gamma=alpha_c=Math.asin(D*Math.sin(gamma0))),this.singam=Math.sin(gamma0),this.cosgam=Math.cos(gamma0),this.sinrot=Math.sin(gamma),this.cosrot=Math.cos(gamma),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A,this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(D*D-1)/Math.cos(alpha_c))),this.lat0<0&&(this.u_0=-this.u_0)),F=.5*gamma0,this.v_pole_n=this.ArB*Math.log(Math.tan(FORTPI-F)),this.v_pole_s=this.ArB*Math.log(Math.tan(FORTPI+F))},forward:function omerc_forward(p){var S,T,U,V,W,temp,u,v,coords={};if(p.x=p.x-this.lam0,Math.abs(Math.abs(p.y)-HALF_PI)>EPSLN){if(S=.5*((W=this.E/Math.pow(tsfnz(this.e,p.y,Math.sin(p.y)),this.B))-(temp=1/W)),T=.5*(W+temp),V=Math.sin(this.B*p.x),U=(S*this.singam-V*this.cosgam)/T,Math.abs(Math.abs(U)-1)<EPSLN)throw new Error;v=.5*this.ArB*Math.log((1-U)/(1+U)),temp=Math.cos(this.B*p.x),u=Math.abs(temp)<1e-7?this.A*p.x:this.ArB*Math.atan2(S*this.cosgam+V*this.singam,temp)}else v=p.y>0?this.v_pole_n:this.v_pole_s,u=this.ArB*p.y;return this.no_rot?(coords.x=u,coords.y=v):(u-=this.u_0,coords.x=v*this.cosrot+u*this.sinrot,coords.y=u*this.cosrot-v*this.sinrot),coords.x=this.a*coords.x+this.x0,coords.y=this.a*coords.y+this.y0,coords},inverse:function omerc_inverse(p){var u,v,Qp,Sp,Tp,Vp,Up,coords={};if(p.x=(p.x-this.x0)*(1/this.a),p.y=(p.y-this.y0)*(1/this.a),this.no_rot?(v=p.y,u=p.x):(v=p.x*this.cosrot-p.y*this.sinrot,u=p.y*this.cosrot+p.x*this.sinrot+this.u_0),Sp=.5*((Qp=Math.exp(-this.BrA*v))-1/Qp),Tp=.5*(Qp+1/Qp),Up=((Vp=Math.sin(this.BrA*u))*this.cosgam+Sp*this.singam)/Tp,Math.abs(Math.abs(Up)-1)<EPSLN)coords.x=0,coords.y=Up<0?-HALF_PI:HALF_PI;else{if(coords.y=this.E/Math.sqrt((1+Up)/(1-Up)),coords.y=phi2z(this.e,Math.pow(coords.y,1/this.B)),coords.y===1/0)throw new Error;coords.x=-this.rB*Math.atan2(Sp*this.cosgam-Vp*this.singam,Math.cos(this.BrA*u))}return coords.x+=this.lam0,coords},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]};const lcc={init:function lcc_init(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<EPSLN)){var temp=this.b/this.a;this.e=Math.sqrt(1-temp*temp);var sin1=Math.sin(this.lat1),cos1=Math.cos(this.lat1),ms1=msfnz(this.e,sin1,cos1),ts1=tsfnz(this.e,this.lat1,sin1),sin2=Math.sin(this.lat2),cos2=Math.cos(this.lat2),ms2=msfnz(this.e,sin2,cos2),ts2=tsfnz(this.e,this.lat2,sin2),ts0=tsfnz(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>EPSLN?this.ns=Math.log(ms1/ms2)/Math.log(ts1/ts2):this.ns=sin1,isNaN(this.ns)&&(this.ns=sin1),this.f0=ms1/(this.ns*Math.pow(ts1,this.ns)),this.rh=this.a*this.f0*Math.pow(ts0,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function lcc_forward(p){var lon=p.x,lat=p.y;Math.abs(2*Math.abs(lat)-Math.PI)<=EPSLN&&(lat=sign(lat)*(HALF_PI-2*EPSLN));var ts,rh1,con=Math.abs(Math.abs(lat)-HALF_PI);if(con>EPSLN)ts=tsfnz(this.e,lat,Math.sin(lat)),rh1=this.a*this.f0*Math.pow(ts,this.ns);else{if((con=lat*this.ns)<=0)return null;rh1=0}var theta=this.ns*adjust_lon(lon-this.long0);return p.x=this.k0*(rh1*Math.sin(theta))+this.x0,p.y=this.k0*(this.rh-rh1*Math.cos(theta))+this.y0,p},inverse:function lcc_inverse(p){var rh1,con,ts,lat,lon,x=(p.x-this.x0)/this.k0,y=this.rh-(p.y-this.y0)/this.k0;this.ns>0?(rh1=Math.sqrt(x*x+y*y),con=1):(rh1=-Math.sqrt(x*x+y*y),con=-1);var theta=0;if(0!==rh1&&(theta=Math.atan2(con*x,con*y)),0!==rh1||this.ns>0){if(con=1/this.ns,ts=Math.pow(rh1/(this.a*this.f0),con),-9999===(lat=phi2z(this.e,ts)))return null}else lat=-HALF_PI;return lon=adjust_lon(theta/this.ns+this.long0),p.x=lon,p.y=lat,p},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]};const krovak={init:function krovak_init(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function krovak_forward(p){var gfi,u,deltav,s,d,eps,ro,lon=p.x,lat=p.y,delta_lon=adjust_lon(lon-this.long0);return gfi=Math.pow((1+this.e*Math.sin(lat))/(1-this.e*Math.sin(lat)),this.alfa*this.e/2),u=2*(Math.atan(this.k*Math.pow(Math.tan(lat/2+this.s45),this.alfa)/gfi)-this.s45),deltav=-delta_lon*this.alfa,s=Math.asin(Math.cos(this.ad)*Math.sin(u)+Math.sin(this.ad)*Math.cos(u)*Math.cos(deltav)),d=Math.asin(Math.cos(u)*Math.sin(deltav)/Math.cos(s)),eps=this.n*d,ro=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(s/2+this.s45),this.n),p.y=ro*Math.cos(eps)/1,p.x=ro*Math.sin(eps)/1,this.czech||(p.y*=-1,p.x*=-1),p},inverse:function krovak_inverse(p){var u,deltav,s,d,ro,fi1,ok,tmp=p.x;p.x=p.y,p.y=tmp,this.czech||(p.y*=-1,p.x*=-1),ro=Math.sqrt(p.x*p.x+p.y*p.y),d=Math.atan2(p.y,p.x)/Math.sin(this.s0),s=2*(Math.atan(Math.pow(this.ro0/ro,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),u=Math.asin(Math.cos(this.ad)*Math.sin(s)-Math.sin(this.ad)*Math.cos(s)*Math.cos(d)),deltav=Math.asin(Math.cos(s)*Math.sin(d)/Math.cos(u)),p.x=this.long0-deltav/this.alfa,fi1=u,ok=0;var iter=0;do{p.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(u/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(fi1))/(1-this.e*Math.sin(fi1)),this.e/2))-this.s45),Math.abs(fi1-p.y)<1e-10&&(ok=1),fi1=p.y,iter+=1}while(0===ok&&iter<15);return iter>=15?null:p},names:["Krovak","krovak"]};function mlfn(e0,e1,e2,e3,phi){return e0*phi-e1*Math.sin(2*phi)+e2*Math.sin(4*phi)-e3*Math.sin(6*phi)}function e0fn(x){return 1-.25*x*(1+x/16*(3+1.25*x))}function e1fn(x){return.375*x*(1+.25*x*(1+.46875*x))}function e2fn(x){return.05859375*x*x*(1+.75*x)}function e3fn(x){return x*x*x*(35/3072)}function gN(a,e,sinphi){var temp=e*sinphi;return a/Math.sqrt(1-temp*temp)}function adjust_lat(x){return Math.abs(x)<HALF_PI?x:x-sign(x)*Math.PI}function imlfn(ml,e0,e1,e2,e3){var phi,dphi;phi=ml/e0;for(var i=0;i<15;i++)if(phi+=dphi=(ml-(e0*phi-e1*Math.sin(2*phi)+e2*Math.sin(4*phi)-e3*Math.sin(6*phi)))/(e0-2*e1*Math.cos(2*phi)+4*e2*Math.cos(4*phi)-6*e3*Math.cos(6*phi)),Math.abs(dphi)<=1e-10)return phi;return NaN}const cass={init:function cass_init(){this.sphere||(this.e0=e0fn(this.es),this.e1=e1fn(this.es),this.e2=e2fn(this.es),this.e3=e3fn(this.es),this.ml0=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function cass_forward(p){var x,y,lam=p.x,phi=p.y;if(lam=adjust_lon(lam-this.long0),this.sphere)x=this.a*Math.asin(Math.cos(phi)*Math.sin(lam)),y=this.a*(Math.atan2(Math.tan(phi),Math.cos(lam))-this.lat0);else{var sinphi=Math.sin(phi),cosphi=Math.cos(phi),nl=gN(this.a,this.e,sinphi),tl=Math.tan(phi)*Math.tan(phi),al=lam*Math.cos(phi),asq=al*al,cl=this.es*cosphi*cosphi/(1-this.es);x=nl*al*(1-asq*tl*(1/6-(8-tl+8*cl)*asq/120)),y=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,phi)-this.ml0+nl*sinphi/cosphi*asq*(.5+(5-tl+6*cl)*asq/24)}return p.x=x+this.x0,p.y=y+this.y0,p},inverse:function cass_inverse(p){p.x-=this.x0,p.y-=this.y0;var phi,lam,x=p.x/this.a,y=p.y/this.a;if(this.sphere){var dd=y+this.lat0;phi=Math.asin(Math.sin(dd)*Math.cos(x)),lam=Math.atan2(Math.tan(x),Math.cos(dd))}else{var phi1=imlfn(this.ml0/this.a+y,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(phi1)-HALF_PI)<=EPSLN)return p.x=this.long0,p.y=HALF_PI,y<0&&(p.y*=-1),p;var nl1=gN(this.a,this.e,Math.sin(phi1)),rl1=nl1*nl1*nl1/this.a/this.a*(1-this.es),tl1=Math.pow(Math.tan(phi1),2),dl=x*this.a/nl1,dsq=dl*dl;phi=phi1-nl1*Math.tan(phi1)/rl1*dl*dl*(.5-(1+3*tl1)*dl*dl/24),lam=dl*(1-dsq*(tl1/3+(1+3*tl1)*tl1*dsq/15))/Math.cos(phi1)}return p.x=adjust_lon(lam+this.long0),p.y=adjust_lat(phi),p},names:["Cassini","Cassini_Soldner","cass"]};function qsfnz(eccent,sinphi){var con;return eccent>1e-7?(1-eccent*eccent)*(sinphi/(1-(con=eccent*sinphi)*con)-.5/eccent*Math.log((1-con)/(1+con))):2*sinphi}var P00=.3333333333333333,P01=.17222222222222222,P02=.10257936507936508,P10=.06388888888888888,P11=.0664021164021164,P20=.016415012942191543;const laea={init:function laea_init(){var sinphi,t=Math.abs(this.lat0);if(Math.abs(t-HALF_PI)<EPSLN?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(t)<EPSLN?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=qsfnz(this.e,1),this.mmf=.5/(1-this.es),this.apa=function authset(es){var t,APA=[];return APA[0]=es*P00,t=es*es,APA[0]+=t*P01,APA[1]=t*P10,t*=es,APA[0]+=t*P02,APA[1]+=t*P11,APA[2]=t*P20,APA}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),sinphi=Math.sin(this.lat0),this.sinb1=qsfnz(this.e,sinphi)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*sinphi*sinphi)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function laea_forward(p){var x,y,coslam,sinlam,sinphi,q,sinb,cosb,b,cosphi,lam=p.x,phi=p.y;if(lam=adjust_lon(lam-this.long0),this.sphere){if(sinphi=Math.sin(phi),cosphi=Math.cos(phi),coslam=Math.cos(lam),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((y=this.mode===this.EQUIT?1+cosphi*coslam:1+this.sinph0*sinphi+this.cosph0*cosphi*coslam)<=EPSLN)return null;x=(y=Math.sqrt(2/y))*cosphi*Math.sin(lam),y*=this.mode===this.EQUIT?sinphi:this.cosph0*sinphi-this.sinph0*cosphi*coslam}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(coslam=-coslam),Math.abs(phi+this.lat0)<EPSLN)return null;y=FORTPI-.5*phi,x=(y=2*(this.mode===this.S_POLE?Math.cos(y):Math.sin(y)))*Math.sin(lam),y*=coslam}}else{switch(sinb=0,cosb=0,b=0,coslam=Math.cos(lam),sinlam=Math.sin(lam),sinphi=Math.sin(phi),q=qsfnz(this.e,sinphi),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(sinb=q/this.qp,cosb=Math.sqrt(1-sinb*sinb)),this.mode){case this.OBLIQ:b=1+this.sinb1*sinb+this.cosb1*cosb*coslam;break;case this.EQUIT:b=1+cosb*coslam;break;case this.N_POLE:b=HALF_PI+phi,q=this.qp-q;break;case this.S_POLE:b=phi-HALF_PI,q=this.qp+q}if(Math.abs(b)<EPSLN)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:b=Math.sqrt(2/b),y=this.mode===this.OBLIQ?this.ymf*b*(this.cosb1*sinb-this.sinb1*cosb*coslam):(b=Math.sqrt(2/(1+cosb*coslam)))*sinb*this.ymf,x=this.xmf*b*cosb*sinlam;break;case this.N_POLE:case this.S_POLE:q>=0?(x=(b=Math.sqrt(q))*sinlam,y=coslam*(this.mode===this.S_POLE?b:-b)):x=y=0}}return p.x=this.a*x+this.x0,p.y=this.a*y+this.y0,p},inverse:function laea_inverse(p){p.x-=this.x0,p.y-=this.y0;var lam,phi,cCe,sCe,q,rho,ab,x=p.x/this.a,y=p.y/this.a;if(this.sphere){var rh,cosz=0,sinz=0;if((phi=.5*(rh=Math.sqrt(x*x+y*y)))>1)return null;switch(phi=2*Math.asin(phi),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(sinz=Math.sin(phi),cosz=Math.cos(phi)),this.mode){case this.EQUIT:phi=Math.abs(rh)<=EPSLN?0:Math.asin(y*sinz/rh),x*=sinz,y=cosz*rh;break;case this.OBLIQ:phi=Math.abs(rh)<=EPSLN?this.lat0:Math.asin(cosz*this.sinph0+y*sinz*this.cosph0/rh),x*=sinz*this.cosph0,y=(cosz-Math.sin(phi)*this.sinph0)*rh;break;case this.N_POLE:y=-y,phi=HALF_PI-phi;break;case this.S_POLE:phi-=HALF_PI}lam=0!==y||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(x,y):0}else{if(ab=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(x/=this.dd,y*=this.dd,(rho=Math.sqrt(x*x+y*y))<EPSLN)return p.x=this.long0,p.y=this.lat0,p;sCe=2*Math.asin(.5*rho/this.rq),cCe=Math.cos(sCe),x*=sCe=Math.sin(sCe),this.mode===this.OBLIQ?(ab=cCe*this.sinb1+y*sCe*this.cosb1/rho,q=this.qp*ab,y=rho*this.cosb1*cCe-y*this.sinb1*sCe):(ab=y*sCe/rho,q=this.qp*ab,y=rho*cCe)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(y=-y),!(q=x*x+y*y))return p.x=this.long0,p.y=this.lat0,p;ab=1-q/this.qp,this.mode===this.S_POLE&&(ab=-ab)}lam=Math.atan2(x,y),phi=function authlat(beta,APA){var t=beta+beta;return beta+APA[0]*Math.sin(t)+APA[1]*Math.sin(t+t)+APA[2]*Math.sin(t+t+t)}(Math.asin(ab),this.apa)}return p.x=adjust_lon(this.long0+lam),p.y=phi,p},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function asinz(x){return Math.abs(x)>1&&(x=x>1?1:-1),Math.asin(x)}const aea={init:function aea_init(){Math.abs(this.lat1+this.lat2)<EPSLN||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=msfnz(this.e3,this.sin_po,this.cos_po),this.qs1=qsfnz(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=msfnz(this.e3,this.sin_po,this.cos_po),this.qs2=qsfnz(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=qsfnz(this.e3,this.sin_po),Math.abs(this.lat1-this.lat2)>EPSLN?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function aea_forward(p){var lon=p.x,lat=p.y;this.sin_phi=Math.sin(lat),this.cos_phi=Math.cos(lat);var qs=qsfnz(this.e3,this.sin_phi),rh1=this.a*Math.sqrt(this.c-this.ns0*qs)/this.ns0,theta=this.ns0*adjust_lon(lon-this.long0),x=rh1*Math.sin(theta)+this.x0,y=this.rh-rh1*Math.cos(theta)+this.y0;return p.x=x,p.y=y,p},inverse:function aea_inverse(p){var rh1,qs,con,theta,lon,lat;return p.x-=this.x0,p.y=this.rh-p.y+this.y0,this.ns0>=0?(rh1=Math.sqrt(p.x*p.x+p.y*p.y),con=1):(rh1=-Math.sqrt(p.x*p.x+p.y*p.y),con=-1),theta=0,0!==rh1&&(theta=Math.atan2(con*p.x,con*p.y)),con=rh1*this.ns0/this.a,this.sphere?lat=Math.asin((this.c-con*con)/(2*this.ns0)):(qs=(this.c-con*con)/this.ns0,lat=this.phi1z(this.e3,qs)),lon=adjust_lon(theta/this.ns0+this.long0),p.x=lon,p.y=lat,p},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function phi1z(eccent,qs){var sinphi,con,com,dphi,phi=asinz(.5*qs);if(eccent<EPSLN)return phi;for(var eccnts=eccent*eccent,i=1;i<=25;i++)if(phi+=dphi=.5*(com=1-(con=eccent*(sinphi=Math.sin(phi)))*con)*com/Math.cos(phi)*(qs/(1-eccnts)-sinphi/com+.5/eccent*Math.log((1-con)/(1+con))),Math.abs(dphi)<=1e-7)return phi;return null}};const gnom={init:function gnom_init(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function gnom_forward(p){var sinphi,cosphi,dlon,coslon,g,x,y,lon=p.x,lat=p.y;return dlon=adjust_lon(lon-this.long0),sinphi=Math.sin(lat),cosphi=Math.cos(lat),coslon=Math.cos(dlon),1,(g=this.sin_p14*sinphi+this.cos_p14*cosphi*coslon)>0||Math.abs(g)<=EPSLN?(x=this.x0+1*this.a*cosphi*Math.sin(dlon)/g,y=this.y0+1*this.a*(this.cos_p14*sinphi-this.sin_p14*cosphi*coslon)/g):(x=this.x0+this.infinity_dist*cosphi*Math.sin(dlon),y=this.y0+this.infinity_dist*(this.cos_p14*sinphi-this.sin_p14*cosphi*coslon)),p.x=x,p.y=y,p},inverse:function gnom_inverse(p){var rh,sinc,cosc,c,lon,lat;return p.x=(p.x-this.x0)/this.a,p.y=(p.y-this.y0)/this.a,p.x/=this.k0,p.y/=this.k0,(rh=Math.sqrt(p.x*p.x+p.y*p.y))?(c=Math.atan2(rh,this.rc),sinc=Math.sin(c),lat=asinz((cosc=Math.cos(c))*this.sin_p14+p.y*sinc*this.cos_p14/rh),lon=Math.atan2(p.x*sinc,rh*this.cos_p14*cosc-p.y*this.sin_p14*sinc),lon=adjust_lon(this.long0+lon)):(lat=this.phic0,lon=0),p.x=lon,p.y=lat,p},names:["gnom"]};const cea={init:function cea_init(){this.sphere||(this.k0=msfnz(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function cea_forward(p){var x,y,lon=p.x,lat=p.y,dlon=adjust_lon(lon-this.long0);if(this.sphere)x=this.x0+this.a*dlon*Math.cos(this.lat_ts),y=this.y0+this.a*Math.sin(lat)/Math.cos(this.lat_ts);else{var qs=qsfnz(this.e,Math.sin(lat));x=this.x0+this.a*this.k0*dlon,y=this.y0+this.a*qs*.5/this.k0}return p.x=x,p.y=y,p},inverse:function cea_inverse(p){var lon,lat;return p.x-=this.x0,p.y-=this.y0,this.sphere?(lon=adjust_lon(this.long0+p.x/this.a/Math.cos(this.lat_ts)),lat=Math.asin(p.y/this.a*Math.cos(this.lat_ts))):(lat=function iqsfnz(eccent,q){var temp=1-(1-eccent*eccent)/(2*eccent)*Math.log((1-eccent)/(1+eccent));if(Math.abs(Math.abs(q)-temp)<1e-6)return q<0?-1*HALF_PI:HALF_PI;for(var dphi,sin_phi,cos_phi,con,phi=Math.asin(.5*q),i=0;i<30;i++)if(sin_phi=Math.sin(phi),cos_phi=Math.cos(phi),con=eccent*sin_phi,phi+=dphi=Math.pow(1-con*con,2)/(2*cos_phi)*(q/(1-eccent*eccent)-sin_phi/(1-con*con)+.5/eccent*Math.log((1-con)/(1+con))),Math.abs(dphi)<=1e-10)return phi;return NaN}(this.e,2*p.y*this.k0/this.a),lon=adjust_lon(this.long0+p.x/(this.a*this.k0))),p.x=lon,p.y=lat,p},names:["cea"]};const eqc={init:function eqc_init(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function eqc_forward(p){var lon=p.x,lat=p.y,dlon=adjust_lon(lon-this.long0),dlat=adjust_lat(lat-this.lat0);return p.x=this.x0+this.a*dlon*this.rc,p.y=this.y0+this.a*dlat,p},inverse:function eqc_inverse(p){var x=p.x,y=p.y;return p.x=adjust_lon(this.long0+(x-this.x0)/(this.a*this.rc)),p.y=adjust_lat(this.lat0+(y-this.y0)/this.a),p},names:["Equirectangular","Equidistant_Cylindrical","eqc"]};const poly={init:function poly_init(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=e0fn(this.es),this.e1=e1fn(this.es),this.e2=e2fn(this.es),this.e3=e3fn(this.es),this.ml0=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function poly_forward(p){var x,y,el,lon=p.x,lat=p.y,dlon=adjust_lon(lon-this.long0);if(el=dlon*Math.sin(lat),this.sphere)Math.abs(lat)<=EPSLN?(x=this.a*dlon,y=-1*this.a*this.lat0):(x=this.a*Math.sin(el)/Math.tan(lat),y=this.a*(adjust_lat(lat-this.lat0)+(1-Math.cos(el))/Math.tan(lat)));else if(Math.abs(lat)<=EPSLN)x=this.a*dlon,y=-1*this.ml0;else{var nl=gN(this.a,this.e,Math.sin(lat))/Math.tan(lat);x=nl*Math.sin(el),y=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,lat)-this.ml0+nl*(1-Math.cos(el))}return p.x=x+this.x0,p.y=y+this.y0,p},inverse:function poly_inverse(p){var lon,lat,x,y,i,al,bl,phi,dphi;if(x=p.x-this.x0,y=p.y-this.y0,this.sphere)if(Math.abs(y+this.a*this.lat0)<=EPSLN)lon=adjust_lon(x/this.a+this.long0),lat=0;else{var tanphi;for(al=this.lat0+y/this.a,bl=x*x/this.a/this.a+al*al,phi=al,i=20;i;--i)if(phi+=dphi=-1*(al*(phi*(tanphi=Math.tan(phi))+1)-phi-.5*(phi*phi+bl)*tanphi)/((phi-al)/tanphi-1),Math.abs(dphi)<=EPSLN){lat=phi;break}lon=adjust_lon(this.long0+Math.asin(x*Math.tan(phi)/this.a)/Math.sin(lat))}else if(Math.abs(y+this.ml0)<=EPSLN)lat=0,lon=adjust_lon(this.long0+x/this.a);else{var cl,mln,mlnp,ma,con;for(al=(this.ml0+y)/this.a,bl=x*x/this.a/this.a+al*al,phi=al,i=20;i;--i)if(con=this.e*Math.sin(phi),cl=Math.sqrt(1-con*con)*Math.tan(phi),mln=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,phi),mlnp=this.e0-2*this.e1*Math.cos(2*phi)+4*this.e2*Math.cos(4*phi)-6*this.e3*Math.cos(6*phi),phi-=dphi=(al*(cl*(ma=mln/this.a)+1)-ma-.5*cl*(ma*ma+bl))/(this.es*Math.sin(2*phi)*(ma*ma+bl-2*al*ma)/(4*cl)+(al-ma)*(cl*mlnp-2/Math.sin(2*phi))-mlnp),Math.abs(dphi)<=EPSLN){lat=phi;break}cl=Math.sqrt(1-this.es*Math.pow(Math.sin(lat),2))*Math.tan(lat),lon=adjust_lon(this.long0+Math.asin(x*cl/this.a)/Math.sin(lat))}return p.x=lon,p.y=lat,p},names:["Polyconic","poly"]};const nzmg={init:function nzmg_init(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function nzmg_forward(p){var n,lon=p.x,delta_lat=p.y-this.lat0,delta_lon=lon-this.long0,d_phi=delta_lat/SEC_TO_RAD*1e-5,d_lambda=delta_lon,d_phi_n=1,d_psi=0;for(n=1;n<=10;n++)d_phi_n*=d_phi,d_psi+=this.A[n]*d_phi_n;var th_n_im1,th_re=d_psi,th_im=d_lambda,th_n_re=1,th_n_im=0,z_re=0,z_im=0;for(n=1;n<=6;n++)th_n_im1=th_n_im*th_re+th_n_re*th_im,th_n_re=th_n_re*th_re-th_n_im*th_im,th_n_im=th_n_im1,z_re=z_re+this.B_re[n]*th_n_re-this.B_im[n]*th_n_im,z_im=z_im+this.B_im[n]*th_n_re+this.B_re[n]*th_n_im;return p.x=z_im*this.a+this.x0,p.y=z_re*this.a+this.y0,p},inverse:function nzmg_inverse(p){var n,z_n_im1,x=p.x,y=p.y,delta_x=x-this.x0,z_re=(y-this.y0)/this.a,z_im=delta_x/this.a,z_n_re=1,z_n_im=0,th_re=0,th_im=0;for(n=1;n<=6;n++)z_n_im1=z_n_im*z_re+z_n_re*z_im,z_n_re=z_n_re*z_re-z_n_im*z_im,z_n_im=z_n_im1,th_re=th_re+this.C_re[n]*z_n_re-this.C_im[n]*z_n_im,th_im=th_im+this.C_im[n]*z_n_re+this.C_re[n]*z_n_im;for(var i=0;i<this.iterations;i++){var th_n_im1,th_n_re=th_re,th_n_im=th_im,num_re=z_re,num_im=z_im;for(n=2;n<=6;n++)th_n_im1=th_n_im*th_re+th_n_re*th_im,th_n_re=th_n_re*th_re-th_n_im*th_im,th_n_im=th_n_im1,num_re+=(n-1)*(this.B_re[n]*th_n_re-this.B_im[n]*th_n_im),num_im+=(n-1)*(this.B_im[n]*th_n_re+this.B_re[n]*th_n_im);th_n_re=1,th_n_im=0;var den_re=this.B_re[1],den_im=this.B_im[1];for(n=2;n<=6;n++)th_n_im1=th_n_im*th_re+th_n_re*th_im,th_n_re=th_n_re*th_re-th_n_im*th_im,th_n_im=th_n_im1,den_re+=n*(this.B_re[n]*th_n_re-this.B_im[n]*th_n_im),den_im+=n*(this.B_im[n]*th_n_re+this.B_re[n]*th_n_im);var den2=den_re*den_re+den_im*den_im;th_re=(num_re*den_re+num_im*den_im)/den2,th_im=(num_im*den_re-num_re*den_im)/den2}var d_psi=th_re,d_lambda=th_im,d_psi_n=1,d_phi=0;for(n=1;n<=9;n++)d_psi_n*=d_psi,d_phi+=this.D[n]*d_psi_n;var lat=this.lat0+d_phi*SEC_TO_RAD*1e5,lon=this.long0+d_lambda;return p.x=lon,p.y=lat,p},names:["New_Zealand_Map_Grid","nzmg"]};const mill={init:function mill_init(){},forward:function mill_forward(p){var lon=p.x,lat=p.y,dlon=adjust_lon(lon-this.long0),x=this.x0+this.a*dlon,y=this.y0+this.a*Math.log(Math.tan(Math.PI/4+lat/2.5))*1.25;return p.x=x,p.y=y,p},inverse:function mill_inverse(p){p.x-=this.x0,p.y-=this.y0;var lon=adjust_lon(this.long0+p.x/this.a),lat=2.5*(Math.atan(Math.exp(.8*p.y/this.a))-Math.PI/4);return p.x=lon,p.y=lat,p},names:["Miller_Cylindrical","mill"]};const sinu={init:function sinu_init(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=pj_enfn(this.es)},forward:function sinu_forward(p){var x,y,lon=p.x,lat=p.y;if(lon=adjust_lon(lon-this.long0),this.sphere){if(this.m)for(var k=this.n*Math.sin(lat),i=20;i;--i){var V=(this.m*lat+Math.sin(lat)-k)/(this.m+Math.cos(lat));if(lat-=V,Math.abs(V)<EPSLN)break}else lat=1!==this.n?Math.asin(this.n*Math.sin(lat)):lat;x=this.a*this.C_x*lon*(this.m+Math.cos(lat)),y=this.a*this.C_y*lat}else{var s=Math.sin(lat),c=Math.cos(lat);y=this.a*pj_mlfn(lat,s,c,this.en),x=this.a*lon*c/Math.sqrt(1-this.es*s*s)}return p.x=x,p.y=y,p},inverse:function sinu_inverse(p){var lat,lon,s;return p.x-=this.x0,lon=p.x/this.a,p.y-=this.y0,lat=p.y/this.a,this.sphere?(lat/=this.C_y,lon/=this.C_x*(this.m+Math.cos(lat)),this.m?lat=asinz((this.m*lat+Math.sin(lat))/this.n):1!==this.n&&(lat=asinz(Math.sin(lat)/this.n)),lon=adjust_lon(lon+this.long0),lat=adjust_lat(lat)):(lat=pj_inv_mlfn(p.y/this.a,this.es,this.en),(s=Math.abs(lat))<HALF_PI?(s=Math.sin(lat),lon=adjust_lon(this.long0+p.x*Math.sqrt(1-this.es*s*s)/(this.a*Math.cos(lat)))):s-EPSLN<HALF_PI&&(lon=this.long0)),p.x=lon,p.y=lat,p},names:["Sinusoidal","sinu"]};const moll={init:function moll_init(){},forward:function moll_forward(p){for(var lon=p.x,lat=p.y,delta_lon=adjust_lon(lon-this.long0),theta=lat,con=Math.PI*Math.sin(lat);;){var delta_theta=-(theta+Math.sin(theta)-con)/(1+Math.cos(theta));if(theta+=delta_theta,Math.abs(delta_theta)<EPSLN)break}theta/=2,Math.PI/2-Math.abs(lat)<EPSLN&&(delta_lon=0);var x=.900316316158*this.a*delta_lon*Math.cos(theta)+this.x0,y=1.4142135623731*this.a*Math.sin(theta)+this.y0;return p.x=x,p.y=y,p},inverse:function moll_inverse(p){var theta,arg;p.x-=this.x0,p.y-=this.y0,arg=p.y/(1.4142135623731*this.a),Math.abs(arg)>.999999999999&&(arg=.999999999999),theta=Math.asin(arg);var lon=adjust_lon(this.long0+p.x/(.900316316158*this.a*Math.cos(theta)));lon<-Math.PI&&(lon=-Math.PI),lon>Math.PI&&(lon=Math.PI),arg=(2*theta+Math.sin(2*theta))/Math.PI,Math.abs(arg)>1&&(arg=1);var lat=Math.asin(arg);return p.x=lon,p.y=lat,p},names:["Mollweide","moll"]};const eqdc={init:function eqdc_init(){Math.abs(this.lat1+this.lat2)<EPSLN||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=e0fn(this.es),this.e1=e1fn(this.es),this.e2=e2fn(this.es),this.e3=e3fn(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=msfnz(this.e,this.sinphi,this.cosphi),this.ml1=mlfn(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<EPSLN?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=msfnz(this.e,this.sinphi,this.cosphi),this.ml2=mlfn(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function eqdc_forward(p){var rh1,lon=p.x,lat=p.y;if(this.sphere)rh1=this.a*(this.g-lat);else{var ml=mlfn(this.e0,this.e1,this.e2,this.e3,lat);rh1=this.a*(this.g-ml)}var theta=this.ns*adjust_lon(lon-this.long0),x=this.x0+rh1*Math.sin(theta),y=this.y0+this.rh-rh1*Math.cos(theta);return p.x=x,p.y=y,p},inverse:function eqdc_inverse(p){var con,rh1,lat,lon;p.x-=this.x0,p.y=this.rh-p.y+this.y0,this.ns>=0?(rh1=Math.sqrt(p.x*p.x+p.y*p.y),con=1):(rh1=-Math.sqrt(p.x*p.x+p.y*p.y),con=-1);var theta=0;return 0!==rh1&&(theta=Math.atan2(con*p.x,con*p.y)),this.sphere?(lon=adjust_lon(this.long0+theta/this.ns),lat=adjust_lat(this.g-rh1/this.a),p.x=lon,p.y=lat,p):(lat=imlfn(this.g-rh1/this.a,this.e0,this.e1,this.e2,this.e3),lon=adjust_lon(this.long0+theta/this.ns),p.x=lon,p.y=lat,p)},names:["Equidistant_Conic","eqdc"]};const vandg={init:function vandg_init(){this.R=this.a},forward:function vandg_forward(p){var x,y,lon=p.x,lat=p.y,dlon=adjust_lon(lon-this.long0);Math.abs(lat)<=EPSLN&&(x=this.x0+this.R*dlon,y=this.y0);var theta=asinz(2*Math.abs(lat/Math.PI));(Math.abs(dlon)<=EPSLN||Math.abs(Math.abs(lat)-HALF_PI)<=EPSLN)&&(x=this.x0,y=lat>=0?this.y0+Math.PI*this.R*Math.tan(.5*theta):this.y0+Math.PI*this.R*-Math.tan(.5*theta));var al=.5*Math.abs(Math.PI/dlon-dlon/Math.PI),asq=al*al,sinth=Math.sin(theta),costh=Math.cos(theta),g=costh/(sinth+costh-1),gsq=g*g,m=g*(2/sinth-1),msq=m*m,con=Math.PI*this.R*(al*(g-msq)+Math.sqrt(asq*(g-msq)*(g-msq)-(msq+asq)*(gsq-msq)))/(msq+asq);dlon<0&&(con=-con),x=this.x0+con;var q=asq+g;return con=Math.PI*this.R*(m*q-al*Math.sqrt((msq+asq)*(asq+1)-q*q))/(msq+asq),y=lat>=0?this.y0+con:this.y0-con,p.x=x,p.y=y,p},inverse:function vandg_inverse(p){var lon,lat,xx,yy,xys,c1,c2,c3,a1,m1,con,th1;return p.x-=this.x0,p.y-=this.y0,con=Math.PI*this.R,xys=(xx=p.x/con)*xx+(yy=p.y/con)*yy,con=3*(yy*yy/(c3=-2*(c1=-Math.abs(yy)*(1+xys))+1+2*yy*yy+xys*xys)+(2*(c2=c1-2*yy*yy+xx*xx)*c2*c2/c3/c3/c3-9*c1*c2/c3/c3)/27)/(a1=(c1-c2*c2/3/c3)/c3)/(m1=2*Math.sqrt(-a1/3)),Math.abs(con)>1&&(con=con>=0?1:-1),th1=Math.acos(con)/3,lat=p.y>=0?(-m1*Math.cos(th1+Math.PI/3)-c2/3/c3)*Math.PI:-(-m1*Math.cos(th1+Math.PI/3)-c2/3/c3)*Math.PI,lon=Math.abs(xx)<EPSLN?this.long0:adjust_lon(this.long0+Math.PI*(xys-1+Math.sqrt(1+2*(xx*xx-yy*yy)+xys*xys))/2/xx),p.x=lon,p.y=lat,p},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]};const aeqd={init:function aeqd_init(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function aeqd_forward(p){var e0,e1,e2,e3,Mlp,Ml,tanphi,Nl1,Nl,psi,Az,G,H,GH,Hs,c,kp,cos_c,s,s2,s3,s4,lon=p.x,lat=p.y,sinphi=Math.sin(p.y),cosphi=Math.cos(p.y),dlon=adjust_lon(lon-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=EPSLN?(p.x=this.x0+this.a*(HALF_PI-lat)*Math.sin(dlon),p.y=this.y0-this.a*(HALF_PI-lat)*Math.cos(dlon),p):Math.abs(this.sin_p12+1)<=EPSLN?(p.x=this.x0+this.a*(HALF_PI+lat)*Math.sin(dlon),p.y=this.y0+this.a*(HALF_PI+lat)*Math.cos(dlon),p):(cos_c=this.sin_p12*sinphi+this.cos_p12*cosphi*Math.cos(dlon),kp=(c=Math.acos(cos_c))?c/Math.sin(c):1,p.x=this.x0+this.a*kp*cosphi*Math.sin(dlon),p.y=this.y0+this.a*kp*(this.cos_p12*sinphi-this.sin_p12*cosphi*Math.cos(dlon)),p):(e0=e0fn(this.es),e1=e1fn(this.es),e2=e2fn(this.es),e3=e3fn(this.es),Math.abs(this.sin_p12-1)<=EPSLN?(Mlp=this.a*mlfn(e0,e1,e2,e3,HALF_PI),Ml=this.a*mlfn(e0,e1,e2,e3,lat),p.x=this.x0+(Mlp-Ml)*Math.sin(dlon),p.y=this.y0-(Mlp-Ml)*Math.cos(dlon),p):Math.abs(this.sin_p12+1)<=EPSLN?(Mlp=this.a*mlfn(e0,e1,e2,e3,HALF_PI),Ml=this.a*mlfn(e0,e1,e2,e3,lat),p.x=this.x0+(Mlp+Ml)*Math.sin(dlon),p.y=this.y0+(Mlp+Ml)*Math.cos(dlon),p):(tanphi=sinphi/cosphi,Nl1=gN(this.a,this.e,this.sin_p12),Nl=gN(this.a,this.e,sinphi),psi=Math.atan((1-this.es)*tanphi+this.es*Nl1*this.sin_p12/(Nl*cosphi)),s=0===(Az=Math.atan2(Math.sin(dlon),this.cos_p12*Math.tan(psi)-this.sin_p12*Math.cos(dlon)))?Math.asin(this.cos_p12*Math.sin(psi)-this.sin_p12*Math.cos(psi)):Math.abs(Math.abs(Az)-Math.PI)<=EPSLN?-Math.asin(this.cos_p12*Math.sin(psi)-this.sin_p12*Math.cos(psi)):Math.asin(Math.sin(dlon)*Math.cos(psi)/Math.sin(Az)),G=this.e*this.sin_p12/Math.sqrt(1-this.es),c=Nl1*s*(1-(s2=s*s)*(Hs=(H=this.e*this.cos_p12*Math.cos(Az)/Math.sqrt(1-this.es))*H)*(1-Hs)/6+(s3=s2*s)/8*(GH=G*H)*(1-2*Hs)+(s4=s3*s)/120*(Hs*(4-7*Hs)-3*G*G*(1-7*Hs))-s4*s/48*GH),p.x=this.x0+c*Math.sin(Az),p.y=this.y0+c*Math.cos(Az),p))},inverse:function aeqd_inverse(p){var rh,z,sinz,cosz,lon,lat,con,e0,e1,e2,e3,Mlp,N1,psi,Az,cosAz,tmp,A,B,D,Ee,F,sinpsi;if(p.x-=this.x0,p.y-=this.y0,this.sphere){if((rh=Math.sqrt(p.x*p.x+p.y*p.y))>2*HALF_PI*this.a)return;return z=rh/this.a,sinz=Math.sin(z),cosz=Math.cos(z),lon=this.long0,Math.abs(rh)<=EPSLN?lat=this.lat0:(lat=asinz(cosz*this.sin_p12+p.y*sinz*this.cos_p12/rh),con=Math.abs(this.lat0)-HALF_PI,lon=Math.abs(con)<=EPSLN?this.lat0>=0?adjust_lon(this.long0+Math.atan2(p.x,-p.y)):adjust_lon(this.long0-Math.atan2(-p.x,p.y)):adjust_lon(this.long0+Math.atan2(p.x*sinz,rh*this.cos_p12*cosz-p.y*this.sin_p12*sinz))),p.x=lon,p.y=lat,p}return e0=e0fn(this.es),e1=e1fn(this.es),e2=e2fn(this.es),e3=e3fn(this.es),Math.abs(this.sin_p12-1)<=EPSLN?(lat=imlfn(((Mlp=this.a*mlfn(e0,e1,e2,e3,HALF_PI))-(rh=Math.sqrt(p.x*p.x+p.y*p.y)))/this.a,e0,e1,e2,e3),lon=adjust_lon(this.long0+Math.atan2(p.x,-1*p.y)),p.x=lon,p.y=lat,p):Math.abs(this.sin_p12+1)<=EPSLN?(Mlp=this.a*mlfn(e0,e1,e2,e3,HALF_PI),lat=imlfn(((rh=Math.sqrt(p.x*p.x+p.y*p.y))-Mlp)/this.a,e0,e1,e2,e3),lon=adjust_lon(this.long0+Math.atan2(p.x,p.y)),p.x=lon,p.y=lat,p):(rh=Math.sqrt(p.x*p.x+p.y*p.y),Az=Math.atan2(p.x,p.y),N1=gN(this.a,this.e,this.sin_p12),cosAz=Math.cos(Az),A=-(tmp=this.e*this.cos_p12*cosAz)*tmp/(1-this.es),B=3*this.es*(1-A)*this.sin_p12*this.cos_p12*cosAz/(1-this.es),F=1-A*(Ee=(D=rh/N1)-A*(1+A)*Math.pow(D,3)/6-B*(1+3*A)*Math.pow(D,4)/24)*Ee/2-D*Ee*Ee*Ee/6,psi=Math.asin(this.sin_p12*Math.cos(Ee)+this.cos_p12*Math.sin(Ee)*cosAz),lon=adjust_lon(this.long0+Math.asin(Math.sin(Az)*Math.sin(Ee)/Math.cos(psi))),sinpsi=Math.sin(psi),lat=Math.atan2((sinpsi-this.es*F*this.sin_p12)*Math.tan(psi),sinpsi*(1-this.es)),p.x=lon,p.y=lat,p)},names:["Azimuthal_Equidistant","aeqd"]};const ortho={init:function ortho_init(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function ortho_forward(p){var sinphi,cosphi,dlon,coslon,g,x,y,lon=p.x,lat=p.y;return dlon=adjust_lon(lon-this.long0),sinphi=Math.sin(lat),cosphi=Math.cos(lat),coslon=Math.cos(dlon),1,((g=this.sin_p14*sinphi+this.cos_p14*cosphi*coslon)>0||Math.abs(g)<=EPSLN)&&(x=1*this.a*cosphi*Math.sin(dlon),y=this.y0+1*this.a*(this.cos_p14*sinphi-this.sin_p14*cosphi*coslon)),p.x=x,p.y=y,p},inverse:function ortho_inverse(p){var rh,z,sinz,cosz,con,lon,lat;return p.x-=this.x0,p.y-=this.y0,z=asinz((rh=Math.sqrt(p.x*p.x+p.y*p.y))/this.a),sinz=Math.sin(z),cosz=Math.cos(z),lon=this.long0,Math.abs(rh)<=EPSLN?(lat=this.lat0,p.x=lon,p.y=lat,p):(lat=asinz(cosz*this.sin_p14+p.y*sinz*this.cos_p14/rh),con=Math.abs(this.lat0)-HALF_PI,Math.abs(con)<=EPSLN?(lon=this.lat0>=0?adjust_lon(this.long0+Math.atan2(p.x,-p.y)):adjust_lon(this.long0-Math.atan2(-p.x,p.y)),p.x=lon,p.y=lat,p):(lon=adjust_lon(this.long0+Math.atan2(p.x*sinz,rh*this.cos_p14*cosz-p.y*this.sin_p14*sinz)),p.x=lon,p.y=lat,p))},names:["ortho"]};var FACE_ENUM_FRONT=1,FACE_ENUM_RIGHT=2,FACE_ENUM_BACK=3,FACE_ENUM_LEFT=4,FACE_ENUM_TOP=5,FACE_ENUM_BOTTOM=6,AREA_ENUM={AREA_0:1,AREA_1:2,AREA_2:3,AREA_3:4};function qsc_fwd_equat_face_theta(phi,y,x,area){var theta;return phi<EPSLN?(area.value=AREA_ENUM.AREA_0,theta=0):(theta=Math.atan2(y,x),Math.abs(theta)<=FORTPI?area.value=AREA_ENUM.AREA_0:theta>FORTPI&&theta<=HALF_PI+FORTPI?(area.value=AREA_ENUM.AREA_1,theta-=HALF_PI):theta>HALF_PI+FORTPI||theta<=-(HALF_PI+FORTPI)?(area.value=AREA_ENUM.AREA_2,theta=theta>=0?theta-SPI:theta+SPI):(area.value=AREA_ENUM.AREA_3,theta+=HALF_PI)),theta}function qsc_shift_lon_origin(lon,offset){var slon=lon+offset;return slon<-SPI?slon+=TWO_PI:slon>+SPI&&(slon-=TWO_PI),slon}const qsc={init:function qsc_init(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=HALF_PI-FORTPI/2?this.face=FACE_ENUM_TOP:this.lat0<=-(HALF_PI-FORTPI/2)?this.face=FACE_ENUM_BOTTOM:Math.abs(this.long0)<=FORTPI?this.face=FACE_ENUM_FRONT:Math.abs(this.long0)<=HALF_PI+FORTPI?this.face=this.long0>0?FACE_ENUM_RIGHT:FACE_ENUM_LEFT:this.face=FACE_ENUM_BACK,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function qsc_forward(p){var lat,lon,theta,phi,t,mu,xy={x:0,y:0},area={value:0};if(p.x-=this.long0,lat=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(p.y)):p.y,lon=p.x,this.face===FACE_ENUM_TOP)phi=HALF_PI-lat,lon>=FORTPI&&lon<=HALF_PI+FORTPI?(area.value=AREA_ENUM.AREA_0,theta=lon-HALF_PI):lon>HALF_PI+FORTPI||lon<=-(HALF_PI+FORTPI)?(area.value=AREA_ENUM.AREA_1,theta=lon>0?lon-SPI:lon+SPI):lon>-(HALF_PI+FORTPI)&&lon<=-FORTPI?(area.value=AREA_ENUM.AREA_2,theta=lon+HALF_PI):(area.value=AREA_ENUM.AREA_3,theta=lon);else if(this.face===FACE_ENUM_BOTTOM)phi=HALF_PI+lat,lon>=FORTPI&&lon<=HALF_PI+FORTPI?(area.value=AREA_ENUM.AREA_0,theta=-lon+HALF_PI):lon<FORTPI&&lon>=-FORTPI?(area.value=AREA_ENUM.AREA_1,theta=-lon):lon<-FORTPI&&lon>=-(HALF_PI+FORTPI)?(area.value=AREA_ENUM.AREA_2,theta=-lon-HALF_PI):(area.value=AREA_ENUM.AREA_3,theta=lon>0?-lon+SPI:-lon-SPI);else{var q,r,s,sinlat,coslat,sinlon;this.face===FACE_ENUM_RIGHT?lon=qsc_shift_lon_origin(lon,+HALF_PI):this.face===FACE_ENUM_BACK?lon=qsc_shift_lon_origin(lon,+SPI):this.face===FACE_ENUM_LEFT&&(lon=qsc_shift_lon_origin(lon,-HALF_PI)),sinlat=Math.sin(lat),coslat=Math.cos(lat),sinlon=Math.sin(lon),q=coslat*Math.cos(lon),r=coslat*sinlon,s=sinlat,this.face===FACE_ENUM_FRONT?theta=qsc_fwd_equat_face_theta(phi=Math.acos(q),s,r,area):this.face===FACE_ENUM_RIGHT?theta=qsc_fwd_equat_face_theta(phi=Math.acos(r),s,-q,area):this.face===FACE_ENUM_BACK?theta=qsc_fwd_equat_face_theta(phi=Math.acos(-q),s,-r,area):this.face===FACE_ENUM_LEFT?theta=qsc_fwd_equat_face_theta(phi=Math.acos(-r),s,q,area):(phi=theta=0,area.value=AREA_ENUM.AREA_0)}return mu=Math.atan(12/SPI*(theta+Math.acos(Math.sin(theta)*Math.cos(FORTPI))-HALF_PI)),t=Math.sqrt((1-Math.cos(phi))/(Math.cos(mu)*Math.cos(mu))/(1-Math.cos(Math.atan(1/Math.cos(theta))))),area.value===AREA_ENUM.AREA_1?mu+=HALF_PI:area.value===AREA_ENUM.AREA_2?mu+=SPI:area.value===AREA_ENUM.AREA_3&&(mu+=1.5*SPI),xy.x=t*Math.cos(mu),xy.y=t*Math.sin(mu),xy.x=xy.x*this.a+this.x0,xy.y=xy.y*this.a+this.y0,p.x=xy.x,p.y=xy.y,p},inverse:function qsc_inverse(p){var mu,nu,cosmu,tannu,tantheta,theta,cosphi,phi,t,invert_sign,tanphi,xa,lp={lam:0,phi:0},area={value:0};if(p.x=(p.x-this.x0)/this.a,p.y=(p.y-this.y0)/this.a,nu=Math.atan(Math.sqrt(p.x*p.x+p.y*p.y)),mu=Math.atan2(p.y,p.x),p.x>=0&&p.x>=Math.abs(p.y)?area.value=AREA_ENUM.AREA_0:p.y>=0&&p.y>=Math.abs(p.x)?(area.value=AREA_ENUM.AREA_1,mu-=HALF_PI):p.x<0&&-p.x>=Math.abs(p.y)?(area.value=AREA_ENUM.AREA_2,mu=mu<0?mu+SPI:mu-SPI):(area.value=AREA_ENUM.AREA_3,mu+=HALF_PI),t=SPI/12*Math.tan(mu),tantheta=Math.sin(t)/(Math.cos(t)-1/Math.sqrt(2)),theta=Math.atan(tantheta),(cosphi=1-(cosmu=Math.cos(mu))*cosmu*(tannu=Math.tan(nu))*tannu*(1-Math.cos(Math.atan(1/Math.cos(theta)))))<-1?cosphi=-1:cosphi>1&&(cosphi=1),this.face===FACE_ENUM_TOP)phi=Math.acos(cosphi),lp.phi=HALF_PI-phi,area.value===AREA_ENUM.AREA_0?lp.lam=theta+HALF_PI:area.value===AREA_ENUM.AREA_1?lp.lam=theta<0?theta+SPI:theta-SPI:area.value===AREA_ENUM.AREA_2?lp.lam=theta-HALF_PI:lp.lam=theta;else if(this.face===FACE_ENUM_BOTTOM)phi=Math.acos(cosphi),lp.phi=phi-HALF_PI,area.value===AREA_ENUM.AREA_0?lp.lam=-theta+HALF_PI:area.value===AREA_ENUM.AREA_1?lp.lam=-theta:area.value===AREA_ENUM.AREA_2?lp.lam=-theta-HALF_PI:lp.lam=theta<0?-theta-SPI:-theta+SPI;else{var q,r,s;t=(q=cosphi)*q,r=(t+=(s=t>=1?0:Math.sqrt(1-t)*Math.sin(theta))*s)>=1?0:Math.sqrt(1-t),area.value===AREA_ENUM.AREA_1?(t=r,r=-s,s=t):area.value===AREA_ENUM.AREA_2?(r=-r,s=-s):area.value===AREA_ENUM.AREA_3&&(t=r,r=s,s=-t),this.face===FACE_ENUM_RIGHT?(t=q,q=-r,r=t):this.face===FACE_ENUM_BACK?(q=-q,r=-r):this.face===FACE_ENUM_LEFT&&(t=q,q=r,r=-t),lp.phi=Math.acos(-s)-HALF_PI,lp.lam=Math.atan2(r,q),this.face===FACE_ENUM_RIGHT?lp.lam=qsc_shift_lon_origin(lp.lam,-HALF_PI):this.face===FACE_ENUM_BACK?lp.lam=qsc_shift_lon_origin(lp.lam,-SPI):this.face===FACE_ENUM_LEFT&&(lp.lam=qsc_shift_lon_origin(lp.lam,+HALF_PI))}return 0!==this.es&&(invert_sign=lp.phi<0?1:0,tanphi=Math.tan(lp.phi),xa=this.b/Math.sqrt(tanphi*tanphi+this.one_minus_f_squared),lp.phi=Math.atan(Math.sqrt(this.a*this.a-xa*xa)/(this.one_minus_f*xa)),invert_sign&&(lp.phi=-lp.phi)),lp.lam+=this.long0,p.x=lp.lam,p.y=lp.phi,p},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]};var COEFS_X=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],COEFS_Y=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],C1=R2D/5,RC1=1/C1,poly3_val=function(coefs,x){return coefs[0]+x*(coefs[1]+x*(coefs[2]+x*coefs[3]))};const robin={init:function robin_init(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function robin_forward(ll){var lon=adjust_lon(ll.x-this.long0),dphi=Math.abs(ll.y),i=Math.floor(dphi*C1);i<0?i=0:i>=18&&(i=17);var xy={x:poly3_val(COEFS_X[i],dphi=R2D*(dphi-RC1*i))*lon,y:poly3_val(COEFS_Y[i],dphi)};return ll.y<0&&(xy.y=-xy.y),xy.x=xy.x*this.a*.8487+this.x0,xy.y=xy.y*this.a*1.3523+this.y0,xy},inverse:function robin_inverse(xy){var ll={x:(xy.x-this.x0)/(.8487*this.a),y:Math.abs(xy.y-this.y0)/(1.3523*this.a)};if(ll.y>=1)ll.x/=COEFS_X[18][0],ll.y=xy.y<0?-HALF_PI:HALF_PI;else{var i=Math.floor(18*ll.y);for(i<0?i=0:i>=18&&(i=17);;)if(COEFS_Y[i][0]>ll.y)--i;else{if(!(COEFS_Y[i+1][0]<=ll.y))break;++i}var coefs=COEFS_Y[i],t=5*(ll.y-coefs[0])/(COEFS_Y[i+1][0]-coefs[0]);t=function newton_rapshon(f_df,start,max_err,iters){for(var x=start;iters;--iters){var upd=f_df(x);if(x-=upd,Math.abs(upd)<max_err)break}return x}((function(x){return(poly3_val(coefs,x)-ll.y)/function(coefs,x){return coefs[1]+x*(2*coefs[2]+3*x*coefs[3])}(coefs,x)}),t,EPSLN,100),ll.x/=poly3_val(COEFS_X[i],t),ll.y=(5*i+t)*D2R,xy.y<0&&(ll.y=-ll.y)}return ll.x=adjust_lon(ll.x+this.long0),ll},names:["Robinson","robin"]};const geocent={init:function geocent_init(){this.name="geocent"},forward:function geocent_forward(p){return geodeticToGeocentric(p,this.es,this.a)},inverse:function geocent_inverse(p){return geocentricToGeodetic(p,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};var mode_N_POLE=0,mode_S_POLE=1,mode_EQUIT=2,mode_OBLIQ=3,params={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};const tpers={init:function tpers_init(){if(Object.keys(params).forEach(function(p){if(void 0===this[p])this[p]=params[p].def;else{if(params[p].num&&isNaN(this[p]))throw new Error("Invalid parameter value, must be numeric "+p+" = "+this[p]);params[p].num&&(this[p]=parseFloat(this[p]))}params[p].degrees&&(this[p]=this[p]*D2R)}.bind(this)),Math.abs(Math.abs(this.lat0)-HALF_PI)<EPSLN?this.mode=this.lat0<0?mode_S_POLE:mode_N_POLE:Math.abs(this.lat0)<EPSLN?this.mode=mode_EQUIT:(this.mode=mode_OBLIQ,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var omega=this.tilt,gamma=this.azi;this.cg=Math.cos(gamma),this.sg=Math.sin(gamma),this.cw=Math.cos(omega),this.sw=Math.sin(omega)},forward:function tpers_forward(p){p.x-=this.long0;var x,y,yt,ba,sinphi=Math.sin(p.y),cosphi=Math.cos(p.y),coslam=Math.cos(p.x);switch(this.mode){case mode_OBLIQ:y=this.sinph0*sinphi+this.cosph0*cosphi*coslam;break;case mode_EQUIT:y=cosphi*coslam;break;case mode_S_POLE:y=-sinphi;break;case mode_N_POLE:y=sinphi}switch(x=(y=this.pn1/(this.p-y))*cosphi*Math.sin(p.x),this.mode){case mode_OBLIQ:y*=this.cosph0*sinphi-this.sinph0*cosphi*coslam;break;case mode_EQUIT:y*=sinphi;break;case mode_N_POLE:y*=-cosphi*coslam;break;case mode_S_POLE:y*=cosphi*coslam}return ba=1/((yt=y*this.cg+x*this.sg)*this.sw*this.h1+this.cw),x=(x*this.cg-y*this.sg)*this.cw*ba,y=yt*ba,p.x=x*this.a,p.y=y*this.a,p},inverse:function tpers_inverse(p){p.x/=this.a,p.y/=this.a;var bm,bq,yt,r={x:p.x,y:p.y};yt=1/(this.pn1-p.y*this.sw),bm=this.pn1*p.x*yt,bq=this.pn1*p.y*this.cw*yt,p.x=bm*this.cg+bq*this.sg,p.y=bq*this.cg-bm*this.sg;var rh=hypot(p.x,p.y);if(Math.abs(rh)<EPSLN)r.x=0,r.y=p.y;else{var cosz,sinz;switch(sinz=1-rh*rh*this.pfact,sinz=(this.p-Math.sqrt(sinz))/(this.pn1/rh+rh/this.pn1),cosz=Math.sqrt(1-sinz*sinz),this.mode){case mode_OBLIQ:r.y=Math.asin(cosz*this.sinph0+p.y*sinz*this.cosph0/rh),p.y=(cosz-this.sinph0*Math.sin(r.y))*rh,p.x*=sinz*this.cosph0;break;case mode_EQUIT:r.y=Math.asin(p.y*sinz/rh),p.y=cosz*rh,p.x*=sinz;break;case mode_N_POLE:r.y=Math.asin(cosz),p.y=-p.y;break;case mode_S_POLE:r.y=-Math.asin(cosz)}r.x=Math.atan2(p.x,p.y)}return p.x=r.x+this.long0,p.y=r.y,p},names:["Tilted_Perspective","tpers"]};const geos={init:function geos_init(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var one_es=1-this.es,rone_es=1/one_es;this.radius_p=Math.sqrt(one_es),this.radius_p2=one_es,this.radius_p_inv2=rone_es,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function geos_forward(p){var tmp,v_x,v_y,v_z,lon=p.x,lat=p.y;if(lon-=this.long0,"ellipse"===this.shape){lat=Math.atan(this.radius_p2*Math.tan(lat));var r=this.radius_p/hypot(this.radius_p*Math.cos(lat),Math.sin(lat));if(v_x=r*Math.cos(lon)*Math.cos(lat),v_y=r*Math.sin(lon)*Math.cos(lat),v_z=r*Math.sin(lat),(this.radius_g-v_x)*v_x-v_y*v_y-v_z*v_z*this.radius_p_inv2<0)return p.x=Number.NaN,p.y=Number.NaN,p;tmp=this.radius_g-v_x,this.flip_axis?(p.x=this.radius_g_1*Math.atan(v_y/hypot(v_z,tmp)),p.y=this.radius_g_1*Math.atan(v_z/tmp)):(p.x=this.radius_g_1*Math.atan(v_y/tmp),p.y=this.radius_g_1*Math.atan(v_z/hypot(v_y,tmp)))}else"sphere"===this.shape&&(tmp=Math.cos(lat),v_x=Math.cos(lon)*tmp,v_y=Math.sin(lon)*tmp,v_z=Math.sin(lat),tmp=this.radius_g-v_x,this.flip_axis?(p.x=this.radius_g_1*Math.atan(v_y/hypot(v_z,tmp)),p.y=this.radius_g_1*Math.atan(v_z/tmp)):(p.x=this.radius_g_1*Math.atan(v_y/tmp),p.y=this.radius_g_1*Math.atan(v_z/hypot(v_y,tmp))));return p.x=p.x*this.a,p.y=p.y*this.a,p},inverse:function geos_inverse(p){var a,b,det,k,v_x=-1,v_y=0,v_z=0;if(p.x=p.x/this.a,p.y=p.y/this.a,"ellipse"===this.shape){this.flip_axis?(v_z=Math.tan(p.y/this.radius_g_1),v_y=Math.tan(p.x/this.radius_g_1)*hypot(1,v_z)):(v_y=Math.tan(p.x/this.radius_g_1),v_z=Math.tan(p.y/this.radius_g_1)*hypot(1,v_y));var v_zp=v_z/this.radius_p;if(a=v_y*v_y+v_zp*v_zp+v_x*v_x,(det=(b=2*this.radius_g*v_x)*b-4*a*this.C)<0)return p.x=Number.NaN,p.y=Number.NaN,p;k=(-b-Math.sqrt(det))/(2*a),v_x=this.radius_g+k*v_x,v_y*=k,v_z*=k,p.x=Math.atan2(v_y,v_x),p.y=Math.atan(v_z*Math.cos(p.x)/v_x),p.y=Math.atan(this.radius_p_inv2*Math.tan(p.y))}else if("sphere"===this.shape){if(this.flip_axis?(v_z=Math.tan(p.y/this.radius_g_1),v_y=Math.tan(p.x/this.radius_g_1)*Math.sqrt(1+v_z*v_z)):(v_y=Math.tan(p.x/this.radius_g_1),v_z=Math.tan(p.y/this.radius_g_1)*Math.sqrt(1+v_y*v_y)),a=v_y*v_y+v_z*v_z+v_x*v_x,(det=(b=2*this.radius_g*v_x)*b-4*a*this.C)<0)return p.x=Number.NaN,p.y=Number.NaN,p;k=(-b-Math.sqrt(det))/(2*a),v_x=this.radius_g+k*v_x,v_y*=k,v_z*=k,p.x=Math.atan2(v_y,v_x),p.y=Math.atan(v_z*Math.cos(p.x)/v_x)}return p.x=p.x+this.long0,p},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};core.defaultDatum="WGS84",core.Proj=Proj,core.WGS84=new core.Proj("WGS84"),core.Point=lib_Point,core.toPoint=toPoint,core.defs=lib_defs,core.nadgrid=function nadgrid(key,data){var view=new DataView(data),isLittleEndian=function detectLittleEndian(view){var nFields=view.getInt32(8,!1);if(11===nFields)return!1;nFields=view.getInt32(8,!0),11!==nFields&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian");return!0}(view),header=function readHeader(view,isLittleEndian){return{nFields:view.getInt32(8,isLittleEndian),nSubgridFields:view.getInt32(24,isLittleEndian),nSubgrids:view.getInt32(40,isLittleEndian),shiftType:decodeString(view,56,64).trim(),fromSemiMajorAxis:view.getFloat64(120,isLittleEndian),fromSemiMinorAxis:view.getFloat64(136,isLittleEndian),toSemiMajorAxis:view.getFloat64(152,isLittleEndian),toSemiMinorAxis:view.getFloat64(168,isLittleEndian)}}(view,isLittleEndian),subgrids=function readSubgrids(view,header,isLittleEndian){for(var gridOffset=176,grids=[],i=0;i<header.nSubgrids;i++){var subHeader=readGridHeader(view,gridOffset,isLittleEndian),nodes=readGridNodes(view,gridOffset,subHeader,isLittleEndian),lngColumnCount=Math.round(1+(subHeader.upperLongitude-subHeader.lowerLongitude)/subHeader.longitudeInterval),latColumnCount=Math.round(1+(subHeader.upperLatitude-subHeader.lowerLatitude)/subHeader.latitudeInterval);grids.push({ll:[secondsToRadians(subHeader.lowerLongitude),secondsToRadians(subHeader.lowerLatitude)],del:[secondsToRadians(subHeader.longitudeInterval),secondsToRadians(subHeader.latitudeInterval)],lim:[lngColumnCount,latColumnCount],count:subHeader.gridNodeCount,cvs:mapNodes(nodes)}),gridOffset+=176+16*subHeader.gridNodeCount}return grids}(view,header,isLittleEndian),nadgrid={header,subgrids};return loadedNadgrids[key]=nadgrid,nadgrid},core.transform=transform,core.mgrs=mgrs,core.version="__VERSION__",function proj4_projs(proj4){proj4.Proj.projections.add(tmerc),proj4.Proj.projections.add(etmerc),proj4.Proj.projections.add(utm),proj4.Proj.projections.add(sterea),proj4.Proj.projections.add(stere),proj4.Proj.projections.add(somerc),proj4.Proj.projections.add(omerc),proj4.Proj.projections.add(lcc),proj4.Proj.projections.add(krovak),proj4.Proj.projections.add(cass),proj4.Proj.projections.add(laea),proj4.Proj.projections.add(aea),proj4.Proj.projections.add(gnom),proj4.Proj.projections.add(cea),proj4.Proj.projections.add(eqc),proj4.Proj.projections.add(poly),proj4.Proj.projections.add(nzmg),proj4.Proj.projections.add(mill),proj4.Proj.projections.add(sinu),proj4.Proj.projections.add(moll),proj4.Proj.projections.add(eqdc),proj4.Proj.projections.add(vandg),proj4.Proj.projections.add(aeqd),proj4.Proj.projections.add(ortho),proj4.Proj.projections.add(qsc),proj4.Proj.projections.add(robin),proj4.Proj.projections.add(geocent),proj4.Proj.projections.add(tpers),proj4.Proj.projections.add(geos)}(core);const lib=core;function buildOpenLayersTileGrid(_x,_x2){return _buildOpenLayersTileGrid.apply(this,arguments)}function _buildOpenLayersTileGrid(){return(_buildOpenLayersTileGrid=(0,asyncToGenerator.Z)((function*(matrixSet,limits){let projection=(0,proj.U2)(matrixSet.crs);if(projection||(projection=yield(0,proj4.sM)(matrixSet.crs)),!projection)throw new Error(`[ogc-client] could not create OpenLayers tile grid, the following projection is unknown: ${matrixSet.crs}`);return function createFromCapabilitiesMatrixSet(matrixSet,extent,matrixLimits){const resolutions=[],matrixIds=[],origins=[],tileSizes=[],sizes=[];matrixLimits=void 0!==matrixLimits?matrixLimits:[];const code=matrixSet.SupportedCRS,projection=(0,proj.U2)(code),metersPerUnit=projection.getMetersPerUnit(),switchOriginXY="ne"==projection.getAxisOrientation().substr(0,2);return matrixSet.TileMatrix.sort((function(a,b){return b.ScaleDenominator-a.ScaleDenominator})),matrixSet.TileMatrix.forEach((function(elt){let matrixAvailable;if(matrixAvailable=!(matrixLimits.length>0)||matrixLimits.find((function(elt_ml){return elt.Identifier==elt_ml.TileMatrix||!elt.Identifier.includes(":")&&matrixSet.Identifier+":"+elt.Identifier===elt_ml.TileMatrix})),matrixAvailable){matrixIds.push(elt.Identifier);const resolution=28e-5*elt.ScaleDenominator/metersPerUnit,tileWidth=elt.TileWidth,tileHeight=elt.TileHeight;switchOriginXY?origins.push([elt.TopLeftCorner[1],elt.TopLeftCorner[0]]):origins.push(elt.TopLeftCorner),resolutions.push(resolution),tileSizes.push(tileWidth==tileHeight?tileWidth:[tileWidth,tileHeight]),sizes.push([elt.MatrixWidth,elt.MatrixHeight])}})),new WMTSTileGrid({extent,origins,resolutions,matrixIds,tileSizes,sizes})}({SupportedCRS:projection,TileMatrix:matrixSet.tileMatrices.map((tileMatrix=>({Identifier:tileMatrix.identifier,ScaleDenominator:tileMatrix.scaleDenominator,TopLeftCorner:tileMatrix.topLeft,TileWidth:tileMatrix.tileWidth,TileHeight:tileMatrix.tileHeight,MatrixWidth:tileMatrix.matrixWidth,MatrixHeight:tileMatrix.matrixHeight})))},null,limits.map((limit=>({TileMatrix:limit.tileMatrix}))))}))).apply(this,arguments)}(0,proj4.z2)(lib)}}]);