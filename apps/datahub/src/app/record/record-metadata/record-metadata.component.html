<div *ngIf="(metadataViewFacade.error$ | async) === null">
  <section id="about">
    <div class="container-lg px-4 mt-10 mb-16 pb-2 lg:mx-auto">
      <gn-ui-metadata-info
        class="sm:block"
        *ngIf="(metadataViewFacade.isPresent$ | async) === false"
        [metadata]="{}"
        [incomplete]="true"
      >
      </gn-ui-metadata-info>
      <div
        *ngIf="(metadataViewFacade.isPresent$ | async) === true"
        class="grid gap-8 grid-cols-1 sm:gap-6 sm:grid-cols-3"
      >
        <div class="sm:col-span-2">
          <gn-ui-metadata-info
            class="sm:block"
            [metadata]="metadataViewFacade.metadata$ | async"
            [incomplete]="metadataViewFacade.isIncomplete$ | async"
            (keyword)="onInfoKeywordClick($event)"
          >
          </gn-ui-metadata-info>
        </div>
        <div class="sm:mt-[-185px]">
          <gn-ui-image-overlay-preview
            class="block h-[185px] mb-5"
            [imageUrl]="thumbnailUrl$ | async"
            (isPlaceholderShown)="showOverlay = !$event"
            *ngIf="showOverlay"
          >
          </gn-ui-image-overlay-preview>
          <gn-ui-metadata-contact
            (organizationClick)="onOrganizationClick($event)"
            [metadata]="metadataViewFacade.metadata$ | async"
          >
          </gn-ui-metadata-contact>
          <div
            *ngIf="metadataQualityDisplay"
            class="border border-gray-300 rounded-lg py-4 px-5 mb-5"
          >
            <p class="mb-3" translate>record.metadata.quality</p>
            <gn-ui-metadata-quality
              [metadata]="metadataViewFacade.metadata$ | async"
              [metadataQualityDisplay]="metadataQualityDisplay"
            ></gn-ui-metadata-quality>
          </div>
          <gn-ui-metadata-catalog
            *ngIf="kind === 'dataset' && sourceLabel$ | async as sourceLabel"
            [sourceLabel]="sourceLabel"
          >
          </gn-ui-metadata-catalog>
          <gn-ui-button
            type="outline"
            extraClass="w-full flex flex-row justify-between"
            [style.--gn-ui-button-rounded]="'10px'"
            (buttonClick)="scrollTo('userFeedbacks')"
          >
            <span translate>service.metadata.question</span>
            <ng-icon
              class="mr-[5px] text-[1em]"
              name="matChatOutline"
            ></ng-icon>
          </gn-ui-button>
        </div>
      </div>
    </div>
  </section>

  <section id="data-preview" [ngClass]="kind === 'dataset' ? 'pb-6' : 'pb-16'">
    <datahub-record-data-preview
      *ngIf="kind === 'dataset'"
    ></datahub-record-data-preview>
    <gn-ui-service-capabilities
      *ngIf="kind === 'service'"
      [apiLinks]="metadataViewFacade.apiLinks$ | async"
    ></gn-ui-service-capabilities>
  </section>

  <section
    id="resources"
    *ngIf="
      (displayDownload$ | async) ||
      (displayOtherLinks | async) ||
      (displayApi$ | async)
    "
    class="overflow-x-hidden"
  >
    <div class="gn-ui-section-title container-lg px-4 lg:mx-auto" translate>
      record.metadata.ressources.and.links
    </div>
    <div class="container-lg px-4 pb-12 lg:mx-auto">
      <div id="downloads" class="mt-5" *ngIf="displayDownload$ | async">
        <datahub-record-downloads class="block"></datahub-record-downloads>
      </div>

      <div *ngIf="displayOtherLinks | async" id="otherlinks" class="mt-5">
        <datahub-record-otherlinks class="block"></datahub-record-otherlinks>
      </div>

      <div
        *ngIf="kind === 'dataset' && displayApi$ | async"
        id="apis"
        class="mt-5"
      >
        <datahub-record-apis class="block"></datahub-record-apis>
      </div>
    </div>
  </section>

  <ng-container *ngIf="displayDatasetHasNoLinkBlock$ | async">
    <gn-ui-error
      data-test="dataset-has-no-link-block"
      [type]="errorTypes.DATASET_HAS_NO_LINK"
    ></gn-ui-error>
  </ng-container>

  <section
    id="user-feedbacks"
    *ngIf="(metadataViewFacade.isPresent$ | async) === true"
    class="pt-6"
  >
    <div *ngIf="(metadataViewFacade.isPresent$ | async) === true">
      <div class="container-lg px-4 lg:mx-auto">
        <datahub-record-user-feedbacks
          [organisationName$]="organisationName$"
          [metadataUuid]="metadataUuid$ | async"
        ></datahub-record-user-feedbacks>
      </div>
    </div>
  </section>
  <section id="related" *ngIf="displayRelated$ | async" class="pt-6">
    <div class="py-16 mt-[32px] bg-gray-100">
      <div class="container-lg px-4 lg:mx-auto">
        <datahub-record-related-records
          [records]="metadataViewFacade.related$ | async"
        ></datahub-record-related-records>
      </div>
    </div>
  </section>
</div>
<div
  class="mt-12 p-4 max-w-[600px] m-auto text-[13px]"
  *ngIf="metadataViewFacade.error$ | async as error"
>
  <gn-ui-error
    *ngIf="error.notFound"
    [type]="errorTypes.RECORD_NOT_FOUND"
    [recordId]="(metadataViewFacade.metadata$ | async).uniqueIdentifier"
  ></gn-ui-error>
  <gn-ui-error
    *ngIf="error.otherError"
    [type]="errorTypes.RECEIVED_ERROR"
    [error]="error.otherError"
  ></gn-ui-error>
</div>
