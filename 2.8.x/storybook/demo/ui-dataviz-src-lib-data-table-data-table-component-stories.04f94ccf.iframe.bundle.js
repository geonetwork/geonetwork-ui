(self.webpackChunkgeonetwork_ui=self.webpackChunkgeonetwork_ui||[]).push([[7124],{"./libs/ui/dataviz/src/lib/data-table/data-table.component.css?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,"table {\n  width: 100%;\n  background: white;\n}\nth.mat-mdc-header-cell,\ntd.mat-mdc-cell,\ntd.mat-mdc-footer-cell {\n  padding-right: 20px;\n}\ntr.mat-mdc-row,\ntr.mat-mdc-footer-row {\n  height: 36px;\n}\ntr:hover {\n  background: whitesmoke;\n}\ntr.mat-mdc-header-row {\n  height: 48px;\n}\n\n[mat-header-cell] {\n  color: #0000008a;\n  font-size: 12px;\n  font-weight: 500;\n}\ntr {\n  cursor: pointer;\n}\n\n.active .mat-mdc-cell {\n  color: var(--color-primary);\n}\n\n.mat-mdc-paginator {\n  background: none;\n}\n",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./libs/ui/dataviz/src/lib/data-table/data-table.component.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{MockBaseReader:()=>MockBaseReader,Primary:()=>Primary,WithGeojson:()=>WithGeojson,WithWfs:()=>WithWfs,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _home_runner_work_geonetwork_ui_geonetwork_ui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),_angular_common_http__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@angular/common/fesm2022/module.mjs"),_storybook_angular__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@storybook/angular/dist/index.mjs"),_geonetwork_ui_util_i18n__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./libs/util/i18n/src/index.ts"),_data_table_component__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./libs/ui/dataviz/src/lib/data-table/data-table.component.ts"),_angular_platform_browser_animations__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@angular/platform-browser/fesm2022/animations.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler.mjs"),_data_table_fixtures__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./libs/ui/dataviz/src/lib/data-table/data-table.fixtures.ts"),_geonetwork_ui_data_fetcher__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./libs/util/data-fetcher/src/index.ts");const __WEBPACK_DEFAULT_EXPORT__={title:"Dataviz/DataTableComponent",component:_data_table_component__WEBPACK_IMPORTED_MODULE_4__.u,decorators:[(0,_storybook_angular__WEBPACK_IMPORTED_MODULE_2__.L4)({providers:[(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.oKB)(_angular_platform_browser_animations__WEBPACK_IMPORTED_MODULE_5__.BrowserAnimationsModule),(0,_angular_common_http__WEBPACK_IMPORTED_MODULE_1__.$R)(),(0,_geonetwork_ui_util_i18n__WEBPACK_IMPORTED_MODULE_3__.GN)()]}),(0,_storybook_angular__WEBPACK_IMPORTED_MODULE_2__.Ap)(story=>`<div class="border border-gray-300 h-[500px] w-[800px] p-[10px] overflow-auto resize">${story}</div>`)]};class MockBaseReader extends _geonetwork_ui_data_fetcher__WEBPACK_IMPORTED_MODULE_8__.Vw{getData(){return Promise.resolve(_data_table_fixtures__WEBPACK_IMPORTED_MODULE_7__.w)}}const Primary={args:{dataset:new MockBaseReader("")}},WithGeojson={loaders:[(0,_home_runner_work_geonetwork_ui_geonetwork_ui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__.A)(function*(){return{dataset:yield(0,_geonetwork_ui_data_fetcher__WEBPACK_IMPORTED_MODULE_8__.Jp)("https://france-geojson.gregoiredavid.fr/repo/departements.geojson","geojson")}})],render:(args,{loaded})=>({props:loaded})},WithWfs={loaders:[(0,_home_runner_work_geonetwork_ui_geonetwork_ui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__.A)(function*(){return{dataset:yield(0,_geonetwork_ui_data_fetcher__WEBPACK_IMPORTED_MODULE_8__.Jp)("https://www.geo2france.fr/geoserver/cr_hdf/ows","wfs",{wfsFeatureType:"accidento_hdf_L93"})}})],render:(args,{loaded})=>({props:loaded})},__namedExportsOrder=["MockBaseReader","Primary","WithGeojson","WithWfs"]},"./libs/ui/dataviz/src/lib/data-table/data-table.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{u:()=>DataTableComponent});var asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var data_table_componentngResource=__webpack_require__("./libs/ui/dataviz/src/lib/data-table/data-table.component.css?ngResource"),data_table_componentngResource_default=__webpack_require__.n(data_table_componentngResource),scrolling=__webpack_require__("./node_modules/@angular/cdk/fesm2022/scrolling.mjs"),root_effect_scheduler=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler.mjs"),debug_node=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),sort=__webpack_require__("./node_modules/@angular/material/fesm2022/sort.mjs"),table=__webpack_require__("./node_modules/@angular/material/fesm2022/table.mjs"),ngx_translate_core=__webpack_require__("./node_modules/@ngx-translate/core/fesm2022/ngx-translate-core.mjs"),BehaviorSubject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/BehaviorSubject.js"),map=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js");class DataTableDataSource{constructor(){this.dataItems$=new BehaviorSubject.t([])}connect(){return this.dataItems$.asObservable().pipe((0,map.T)(items=>items.map(item=>({id:item.id,...item.properties}))))}disconnect(){this.dataItems$.complete()}showData(itemsPromise){var _this=this;return(0,asyncToGenerator.A)(function*(){const items=yield itemsPromise;_this.dataItems$.next(items)})()}clearData(){this.dataItems$.next([])}}var _staticBlock,src=__webpack_require__("./libs/util/data-fetcher/src/index.ts"),paginator=__webpack_require__("./node_modules/@angular/material/fesm2022/paginator.mjs"),Subject=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subject.js");let CustomMatPaginatorIntl=(class CustomMatPaginatorIntl extends paginator.xX{constructor(){super(),this.translate=(0,root_effect_scheduler.WQX)(ngx_translate_core.c$),this.changes=new Subject.B,this.setLabels(),this.translate.onLangChange.subscribe(()=>{this.setLabels(),this.changes.next()})}setLabels(){this.itemsPerPageLabel=this.translate.instant("table.paginator.itemsPerPage"),this.nextPageLabel=this.translate.instant("table.paginator.nextPage"),this.previousPageLabel=this.translate.instant("table.paginator.previousPage"),this.firstPageLabel=this.translate.instant("table.paginator.firstPage"),this.lastPageLabel=this.translate.instant("table.paginator.lastPage"),this.getRangeLabel=this.getRangeLabelIntl,this.changes.next()}getRangeLabelIntl(page,pageSize,length){if(0===length||0===pageSize)return this.translate.instant("table.paginator.rangeLabel",{startIndex:0,endIndex:0,length});const startIndex=page*pageSize,endIndex=startIndex<length?Math.min(startIndex+pageSize,length):startIndex+pageSize;return this.translate.instant("table.paginator.rangeLabel",{startIndex:startIndex+1,endIndex,length})}static#_=_staticBlock=()=>(this.ctorParameters=()=>[],this)},_staticBlock());CustomMatPaginatorIntl=(0,tslib_es6.Cg)([(0,debug_node._qm)(),(0,tslib_es6.Sn)("design:paramtypes",[])],CustomMatPaginatorIntl);var data_table_component_staticBlock,common_module=__webpack_require__("./node_modules/@angular/common/fesm2022/common_module.mjs"),firstValueFrom=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/firstValueFrom.js"),filter=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/filter.js"),widgets_src=__webpack_require__("./libs/ui/widgets/src/index.ts"),ngrx_component=__webpack_require__("./node_modules/@ngrx/component/fesm2022/ngrx-component.mjs");let DataTableComponent=(class DataTableComponent{constructor(){this.eltRef=(0,root_effect_scheduler.WQX)(debug_node.aKT),this.cdr=(0,root_effect_scheduler.WQX)(core.ChangeDetectorRef),this.translateService=(0,root_effect_scheduler.WQX)(ngx_translate_core.c$),this._featureAttributes=[],this.selected=new debug_node.bkB,this.properties$=new BehaviorSubject.t(null),this.loading$=new BehaviorSubject.t(!1),this.error=null}set featureAttributes(value){this._featureAttributes=value,this.properties$.next(value.map(attr=>attr.value))}set dataset(value){this.dataset_=value,this.dataset_.load(),this.dataset_.info.then(info=>this.count=info.itemsCount)}ngOnInit(){this.dataSource=new DataTableDataSource}ngAfterViewInit(){this.headerHeight=this.eltRef.nativeElement.querySelector("thead").offsetHeight,this.setPagination(),this.cdr.detectChanges()}ngOnChanges(){this.setPagination()}setSort(sort){this.dataset_&&(sort.active?this.dataset_.orderBy([sort.direction||"asc",sort.active]):this.dataset_.orderBy(),this.readData())}setPagination(){this.paginator&&this.dataset_&&(this.dataset_.limit(this.paginator.pageIndex*this.paginator.pageSize,this.paginator.pageSize),this.readData())}readData(){var _this=this;return(0,asyncToGenerator.A)(function*(){_this.loading$.next(!0);const propsWithoutGeom=(yield(0,firstValueFrom._)(_this.properties$.pipe((0,filter.p)(p=>!!p)))).filter(p=>!p.toLowerCase().startsWith("geom"));_this.dataset_.select(...propsWithoutGeom);try{yield _this.dataSource.showData(_this.dataset_.read()),_this.error=null}catch(error){_this.handleError(error)}_this.loading$.next(!1)})()}scrollToItem(itemId){const row=this.eltRef.nativeElement.querySelector(`#${this.getRowEltId(itemId)}`);this.eltRef.nativeElement.scrollTop=row.offsetTop-this.headerHeight}getRowEltId(id){return"table-item-"+id}handleError(error){this.dataSource.clearData(),error instanceof src.fk?(this.error=this.translateService.instant(`dataset.error.${error.type}`,{info:error.info}),console.warn(error.message)):(this.error=this.translateService.instant(error.message),console.warn(error.stack||error))}static#_=data_table_component_staticBlock=()=>(this.propDecorators={featureAttributes:[{type:debug_node.pde}],dataset:[{type:debug_node.pde}],activeId:[{type:debug_node.pde}],selected:[{type:debug_node.k7i}],sort:[{type:core.ViewChild,args:[sort.B4]}],paginator:[{type:core.ViewChild,args:[paginator.iy]}]},this)},data_table_component_staticBlock());DataTableComponent=(0,tslib_es6.Cg)([(0,debug_node.uAl)({standalone:!0,imports:[table.tP,sort.NQ,paginator.Ou,scrolling.E9,common_module.MD,widgets_src.OR,widgets_src.oz,ngrx_component.Nj,ngx_translate_core.D9,ngx_translate_core.Mm],providers:[{provide:paginator.xX,useClass:CustomMatPaginatorIntl}],selector:"gn-ui-data-table",template:'<div class="flex flex-col border border-gray-300 rounded-lg bg-white h-full">\n  <div class="flex-1 overflow-y-hidden overflow-x-auto rounded-lg relative">\n    <table\n      mat-table\n      [dataSource]="dataSource"\n      matSort\n      (matSortChange)="setSort($event)"\n      [matSortDisableClear]="true"\n      *ngrxLet="properties$ as properties"\n    >\n      @for (attr of _featureAttributes; track attr) {\n        <ng-container [matColumnDef]="attr.value">\n          <th\n            mat-header-cell\n            *matHeaderCellDef\n            mat-sort-header\n            class="text-sm text-black bg-white"\n          >\n            {{ attr.label }}\n          </th>\n          <td\n            mat-cell\n            *matCellDef="let element"\n            class="whitespace-nowrap pr-1 truncate"\n          >\n            {{ element[attr.value] }}\n          </td>\n        </ng-container>\n      }\n\n      <tr mat-header-row *matHeaderRowDef="properties; sticky: true"></tr>\n      <tr\n        [id]="getRowEltId(row.id)"\n        mat-row\n        *matRowDef="let row; columns: properties"\n        (click)="selected.emit(row)"\n        [class.active]="\n          activeId !== undefined && activeId !== null && row.id === activeId\n        "\n      ></tr>\n    </table>\n    @if (loading$ | async) {\n      <gn-ui-loading-mask\n        class="sticky inset-0"\n        [message]="\'table.loading.data\' | translate"\n      ></gn-ui-loading-mask>\n    }\n    @if (error) {\n      <gn-ui-popup-alert\n        type="warning"\n        icon="matErrorOutlineOutline"\n        class="absolute m-2 inset-0 z-[100]"\n      >\n        <span translate>{{ error }}</span>\n      </gn-ui-popup-alert>\n    }\n  </div>\n  <div class="flex justify-between items-center overflow-hidden">\n    <div class="text-gray-900 px-4 py-2 text-sm">\n      <span class="count font-extrabold text-primary">{{ count }}</span\n      >&nbsp;<span translate>table.object.count</span>.\n    </div>\n\n    <mat-paginator\n      class="my-[-16px]"\n      (page)="setPagination()"\n      [length]="count"\n      [pageSize]="10"\n      [showFirstLastButtons]="true"\n      [hidePageSize]="true"\n    ></mat-paginator>\n  </div>\n</div>\n',changeDetection:debug_node.Ngq.OnPush,styles:[data_table_componentngResource_default()]})],DataTableComponent)},"./libs/ui/dataviz/src/lib/data-table/data-table.fixtures.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{w:()=>tableItemsFixture});const tableItemsFixture={items:[{type:"Feature",geometry:null,properties:{id:"0001",firstName:"John",lastName:"Lennon"}},{type:"Feature",geometry:null,properties:{id:"0002",firstName:"Ozzy",lastName:"Osbourne"}},{type:"Feature",geometry:null,properties:{id:"0003",firstName:"Claude",lastName:"FranÃ§ois"}}],properties:[{name:"id",label:"id",type:"string"},{name:"firstName",label:"Firstname",type:"string"},{name:"lastName",label:"Lastname",type:"string"}]}},"./libs/ui/widgets/src/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{OR:()=>_lib_loading_mask_loading_mask_component__WEBPACK_IMPORTED_MODULE_2__.O,aD:()=>_lib_progress_bar_progress_bar_component__WEBPACK_IMPORTED_MODULE_0__.a,n0:()=>_lib_spinning_loader_spinning_loader_component__WEBPACK_IMPORTED_MODULE_5__.n,oz:()=>_lib_popup_alert_popup_alert_component__WEBPACK_IMPORTED_MODULE_4__.o,r3:()=>_lib_popover_popover_component__WEBPACK_IMPORTED_MODULE_1__.r});var _lib_progress_bar_progress_bar_component__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./libs/ui/widgets/src/lib/progress-bar/progress-bar.component.ts"),_lib_popover_popover_component__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./libs/ui/widgets/src/lib/popover/popover.component.ts"),_lib_loading_mask_loading_mask_component__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./libs/ui/widgets/src/lib/loading-mask/loading-mask.component.ts"),_lib_popup_alert_popup_alert_component__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__("./libs/ui/widgets/src/lib/color-scale/color-scale.component.ts"),__webpack_require__("./libs/ui/widgets/src/lib/popup-alert/popup-alert.component.ts")),_lib_spinning_loader_spinning_loader_component__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./libs/ui/widgets/src/lib/spinning-loader/spinning-loader.component.ts")},"./libs/ui/widgets/src/lib/color-scale/color-scale.component.css?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,"",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./libs/ui/widgets/src/lib/color-scale/color-scale.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{r:()=>ColorScaleComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var color_scale_componentngResource=__webpack_require__("./libs/ui/widgets/src/lib/color-scale/color-scale.component.css?ngResource"),color_scale_componentngResource_default=__webpack_require__.n(color_scale_componentngResource),debug_node=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node.mjs");let ColorScaleComponent=class ColorScaleComponent{};ColorScaleComponent=(0,tslib_es6.Cg)([(0,debug_node.uAl)({selector:"gn-ui-color-scale",template:'<div class="flex flex-row items-center">\n  <div class="text-xs text-gray-700 font-bold m-2 w-32 text-right">primary</div>\n  <div\n    class="shadow-md rounded w-6 h-6 m-2 bg-primary-black"\n    title="primary-black"\n  ></div>\n  <div\n    class="shadow-md rounded w-6 h-6 m-2 bg-primary-darkest"\n    title="primary-darkest"\n  ></div>\n  <div\n    class="shadow-md rounded w-6 h-6 m-2 bg-primary-darker"\n    title="primary-darker"\n  ></div>\n  <div\n    class="shadow-md rounded w-6 h-6 m-2 bg-primary border-2 border-primary-darkest"\n    title="primary"\n  ></div>\n  <div\n    class="shadow-md rounded w-6 h-6 m-2 bg-primary-lighter"\n    title="primary-lighter"\n  ></div>\n  <div\n    class="shadow-md rounded w-6 h-6 m-2 bg-primary-lightest"\n    title="primary-lightest"\n  ></div>\n  <div\n    class="shadow-md rounded w-6 h-6 m-2 bg-primary-white"\n    title="primary-white"\n  ></div>\n</div>\n<div class="flex flex-row">\n  <div class="text-xs text-gray-700 font-bold m-2 w-32 text-right">\n    secondary\n  </div>\n  <div\n    class="shadow-md rounded w-6 h-6 m-2 bg-secondary-black"\n    title="secondary-black"\n  ></div>\n  <div\n    class="shadow-md rounded w-6 h-6 m-2 bg-secondary-darkest"\n    title="secondary-darkest"\n  ></div>\n  <div\n    class="shadow-md rounded w-6 h-6 m-2 bg-secondary-darker"\n    title="secondary-darker"\n  ></div>\n  <div\n    class="shadow-md rounded w-6 h-6 m-2 bg-secondary border-2 border-secondary-darkest"\n    title="secondary"\n  ></div>\n  <div\n    class="shadow-md rounded w-6 h-6 m-2 bg-secondary-lighter"\n    title="secondary-lighter"\n  ></div>\n  <div\n    class="shadow-md rounded w-6 h-6 m-2 bg-secondary-lightest"\n    title="secondary-lightest"\n  ></div>\n  <div\n    class="shadow-md rounded w-6 h-6 m-2 bg-secondary-white"\n    title="secondary-white"\n  ></div>\n</div>\n<div class="flex flex-row">\n  <div class="text-xs text-gray-700 font-bold m-2 w-32 text-right">main</div>\n  <div class="shadow-md rounded w-6 h-6 m-2 bg-main" title="main"></div>\n  <div class="shadow-md rounded w-6 h-6 m-2 bg-gray-900" title="gray-900"></div>\n  <div class="shadow-md rounded w-6 h-6 m-2 bg-gray-800" title="gray-800"></div>\n  <div class="shadow-md rounded w-6 h-6 m-2 bg-gray-700" title="gray-700"></div>\n  <div class="shadow-md rounded w-6 h-6 m-2 bg-gray-600" title="gray-600"></div>\n  <div class="shadow-md rounded w-6 h-6 m-2 bg-gray-500" title="gray-500"></div>\n  <div class="shadow-md rounded w-6 h-6 m-2 bg-gray-400" title="gray-400"></div>\n  <div class="shadow-md rounded w-6 h-6 m-2 bg-gray-300" title="gray-300"></div>\n  <div class="shadow-md rounded w-6 h-6 m-2 bg-gray-200" title="gray-200"></div>\n  <div class="shadow-md rounded w-6 h-6 m-2 bg-gray-100" title="gray-100"></div>\n  <div class="shadow-md rounded w-6 h-6 m-2 bg-gray-50" title="gray-50"></div>\n  <div\n    class="shadow-md rounded w-6 h-6 m-2 bg-background"\n    title="background"\n  ></div>\n  <div class="text-xs text-gray-700 font-bold m-2 w-32">background</div>\n</div>\n',standalone:!0,styles:[color_scale_componentngResource_default()]})],ColorScaleComponent)},"./libs/ui/widgets/src/lib/loading-mask/loading-mask.component.css?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,"/* this overrides the spinner color with a CSS variable to match the theme */\n::ng-deep .mat-spinner circle {\n  stroke: var(--color-gray-700);\n  opacity: 0.5;\n}\n\n.backdrop {\n  background-color: rgba(255, 255, 255, 0.4);\n}\n\n@supports ((-webkit-backdrop-filter: blur()) or (backdrop-filter: blur())) {\n  .backdrop {\n    background-color: transparent;\n    -webkit-backdrop-filter: blur(4px);\n            backdrop-filter: blur(4px);\n  }\n}\n\n.background {\n  opacity: 0.7;\n}\n",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./libs/ui/widgets/src/lib/loading-mask/loading-mask.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{O:()=>LoadingMaskComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var _staticBlock,loading_mask_componentngResource=__webpack_require__("./libs/ui/widgets/src/lib/loading-mask/loading-mask.component.css?ngResource"),loading_mask_componentngResource_default=__webpack_require__.n(loading_mask_componentngResource),debug_node=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node.mjs"),progress_spinner=__webpack_require__("./node_modules/@angular/material/fesm2022/progress-spinner.mjs");let LoadingMaskComponent=(class LoadingMaskComponent{static#_=_staticBlock=()=>(this.propDecorators={message:[{type:debug_node.pde}]},this)},_staticBlock());LoadingMaskComponent=(0,tslib_es6.Cg)([(0,debug_node.uAl)({selector:"gn-ui-loading-mask",template:'<div class="h-full flex flex-col justify-center items-center relative backdrop">\n  <div class="absolute background bg-white inset-0"></div>\n  <mat-spinner [diameter]="28" class="relative"></mat-spinner>\n  <span class="text-sm text-gray-700 mt-3 relative">{{ message }}</span>\n</div>\n',changeDetection:debug_node.Ngq.OnPush,imports:[progress_spinner.D6],standalone:!0,styles:[loading_mask_componentngResource_default()]})],LoadingMaskComponent)},"./libs/ui/widgets/src/lib/popover/popover.component.css?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,"",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./libs/ui/widgets/src/lib/popover/popover.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{r:()=>PopoverComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var _staticBlock,popover_componentngResource=__webpack_require__("./libs/ui/widgets/src/lib/popover/popover.component.css?ngResource"),popover_componentngResource_default=__webpack_require__.n(popover_componentngResource),root_effect_scheduler=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler.mjs"),debug_node=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),tippy_esm=__webpack_require__("./node_modules/tippy.js/dist/tippy.esm.js");let PopoverComponent=(class PopoverComponent{constructor(){this.viewContainerRef=(0,root_effect_scheduler.WQX)(debug_node.c1b),this.renderer=(0,root_effect_scheduler.WQX)(debug_node.sFG)}getContent(){if(this.content instanceof debug_node.C4Q){this.view&&this.view.destroy(),this.view=this.viewContainerRef.createEmbeddedView(this.content),this.view.detectChanges();const wrapper=this.renderer.createElement("div");return this.view.rootNodes.forEach(node=>{this.renderer.appendChild(wrapper,node)}),wrapper}return this.content}ngAfterViewInit(){this.tippyInstance=(0,tippy_esm.Ay)(this.popoverContent.nativeElement,{content:this.getContent(),allowHTML:!0,theme:this.theme})}ngOnChanges(changes){changes.theme&&(this.theme=changes.theme.currentValue,this.tippyInstance&&this.tippyInstance.setProps({theme:this.theme})),changes.content&&(this.content=changes.content.currentValue,this.tippyInstance&&this.tippyInstance.setContent(this.getContent()))}ngOnDestroy(){this.tippyInstance&&this.tippyInstance.destroy(),this.view&&this.view.destroy()}static#_=_staticBlock=()=>(this.propDecorators={popoverContent:[{type:core.ViewChild,args:["popoverContent",{static:!1}]}],content:[{type:debug_node.pde}],theme:[{type:debug_node.pde}]},this)},_staticBlock());PopoverComponent=(0,tslib_es6.Cg)([(0,debug_node.uAl)({selector:"gn-ui-popover",template:"<span #popoverContent>\n  <ng-content></ng-content>\n</span>\n",standalone:!0,imports:[],styles:[popover_componentngResource_default()]})],PopoverComponent)},"./libs/ui/widgets/src/lib/popup-alert/popup-alert.component.css?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,":host {\n  pointer-events: none;\n}\n.container {\n  filter: drop-shadow(0px 4px 3px rgba(0, 0, 0, 0.2));\n}\n.message {\n  transition: clip-path 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);\n}\n.message.expanded {\n  clip-path: circle(100%);\n}\n.position-top {\n  clip-path: circle(19px at 20px 20px);\n  align-items: start;\n  top: 0;\n  left: 0;\n}\n.position-bottom {\n  clip-path: circle(19px at 20px calc(100% - 20px));\n  align-items: end;\n  bottom: 0;\n  left: 0;\n}\n\n/* style links inside message */\n.container ::ng-deep a {\n  text-decoration: underline;\n  font-weight: bold;\n}\n.container ::ng-deep a:hover {\n  opacity: 0.85;\n}\n",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./libs/ui/widgets/src/lib/popup-alert/popup-alert.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{o:()=>PopupAlertComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var _staticBlock,popup_alert_componentngResource=__webpack_require__("./libs/ui/widgets/src/lib/popup-alert/popup-alert.component.css?ngResource"),popup_alert_componentngResource_default=__webpack_require__.n(popup_alert_componentngResource),root_effect_scheduler=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),debug_node=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node.mjs"),common_module=__webpack_require__("./node_modules/@angular/common/fesm2022/common_module.mjs"),ng_icons_core=__webpack_require__("./node_modules/@ng-icons/core/fesm2022/ng-icons-core.mjs"),ng_icons_material_icons_outline=__webpack_require__("./node_modules/@ng-icons/material-icons/fesm2022/ng-icons-material-icons-outline.mjs");let PopupAlertComponent=(class PopupAlertComponent{constructor(){this.changeDetector=(0,root_effect_scheduler.WQX)(core.ChangeDetectorRef),this.type="info",this.position="top",this.expanded=!1,this.timeout=null}get showDuration(){const chars=this.content.nativeElement.innerHTML.length;return Math.max(3e3,20*chars)}ngOnInit(){this.expandAndClose()}expand(){this.expanded=!0,this.changeDetector.detectChanges(),clearTimeout(this.timeout)}expandAndClose(){this.expanded=!0,this.changeDetector.detectChanges(),clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.expanded=!1,this.changeDetector.detectChanges()},this.showDuration)}static#_=_staticBlock=()=>(this.propDecorators={icon:[{type:debug_node.pde}],type:[{type:debug_node.pde}],position:[{type:debug_node.pde}],content:[{type:core.ViewChild,args:["content"]}]},this)},_staticBlock());PopupAlertComponent=(0,tslib_es6.Cg)([(0,debug_node.uAl)({selector:"gn-ui-popup-alert",template:"<div class=\"h-full relative container\">\n  <div\n    class=\"pointer-events-auto absolute text-white flex flex-row p-2 rounded message\"\n    role=\"alert\"\n    [ngClass]=\"{\n      'position-bottom': position === 'bottom',\n      'position-top': position === 'top',\n      expanded: this.expanded,\n      'bg-red-500': type === 'danger',\n      'bg-yellow-500': type === 'warning',\n      'bg-blue-500': type === 'info',\n    }\"\n    (mouseenter)=\"expand()\"\n    (mouseleave)=\"expandAndClose()\"\n  >\n    <ng-icon class=\"mr-2 shrink-0 select-none\" [name]=\"icon\"></ng-icon>\n    <div class=\"grow\" #content [ngClass]=\"{ invisible: !expanded }\">\n      <ng-content></ng-content>\n    </div>\n  </div>\n</div>\n",changeDetection:debug_node.Ngq.OnPush,standalone:!0,imports:[common_module.MD,ng_icons_core.Uq],providers:[(0,ng_icons_core.EB)({matErrorOutlineOutline:ng_icons_material_icons_outline.Bak}),(0,ng_icons_core.PG)({size:"1.5em"})],styles:[popup_alert_componentngResource_default()]})],PopupAlertComponent)},"./libs/ui/widgets/src/lib/progress-bar/progress-bar.component.css?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,".font-bold {\n  font-weight: var(--progress-bar-font-weight, 'bold');\n}\n",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./libs/ui/widgets/src/lib/progress-bar/progress-bar.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{a:()=>ProgressBarComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var _staticBlock,progress_bar_componentngResource=__webpack_require__("./libs/ui/widgets/src/lib/progress-bar/progress-bar.component.css?ngResource"),progress_bar_componentngResource_default=__webpack_require__.n(progress_bar_componentngResource),debug_node=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node.mjs");let ProgressBarComponent=(class ProgressBarComponent{constructor(){this.value=0,this.type="default"}get progress(){return this.value>0?this.value<100?this.value:100:0}get color(){switch(this.type){case"default":return{outerBar:"bg-gray-200",innerBar:"bg-gray-100",text:"text-gray-900"};case"primary":return{outerBar:"bg-primary",innerBar:"bg-primary-lighter",text:"text-white"};case"secondary":return{outerBar:"bg-secondary",innerBar:"bg-secondary-lighter",text:"text-white"};case"light":return{outerBar:"bg-primary-white",innerBar:"bg-primary",text:"text-main"}}}static#_=_staticBlock=()=>(this.propDecorators={value:[{type:debug_node.pde}],type:[{type:debug_node.pde}]},this)},_staticBlock());ProgressBarComponent=(0,tslib_es6.Cg)([(0,debug_node.uAl)({selector:"gn-ui-progress-bar",template:'@switch (type) {\n  \x3c!-- Light Theme --\x3e\n  @case (\'light\') {\n    <div class="flex items-center relative">\n      <div\n        class="flex-shrink-0 {{ color.text }} font-medium mr-2\n             text-opacity-100 !text-slate-800"\n        data-cy="progressPercentage"\n      >\n        {{ progress }}%\n      </div>\n      <div class="flex-grow h-[4px] w-[52px] {{ color.outerBar }} rounded-full">\n        <div\n          [style.width.%]="progress"\n          class="{{ color.innerBar }} transition-width duration-500\n               ease-in-out rounded-full shadow-sm w-[52px] h-[4px]"\n        ></div>\n      </div>\n    </div>\n  }\n  \x3c!-- Default / Primary / Secondary Themes --\x3e\n  @default {\n    <div class="flex h-full {{ color.outerBar }} rounded-t-lg rounded-b-lg">\n      <div\n        [style.width.%]="progress"\n        class="flex {{ color.innerBar }} my-1 mx-1 transition-width\n               duration-500 ease-in-out rounded-t-md rounded-b-md shadow-xl"\n      >\n        <div\n          class="flex items-center pl-2 py-1 {{ color.text }} font-bold text-4"\n        >\n          {{ progress }}%\n        </div>\n      </div>\n    </div>\n  }\n}\n',standalone:!0,imports:[],styles:[progress_bar_componentngResource_default()]})],ProgressBarComponent)},"./libs/ui/widgets/src/lib/spinning-loader/spinning-loader.component.css?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,"",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./libs/ui/widgets/src/lib/spinning-loader/spinning-loader.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{n:()=>SpinningLoaderComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var spinning_loader_componentngResource=__webpack_require__("./libs/ui/widgets/src/lib/spinning-loader/spinning-loader.component.css?ngResource"),spinning_loader_componentngResource_default=__webpack_require__.n(spinning_loader_componentngResource),debug_node=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node.mjs");let SpinningLoaderComponent=class SpinningLoaderComponent{};SpinningLoaderComponent=(0,tslib_es6.Cg)([(0,debug_node.uAl)({selector:"gn-ui-spinning-loader",template:'<span>\n  <svg\n    class="animate-spin h-8 w-8 text-primary"\n    xmlns="http://www.w3.org/2000/svg"\n    fill="none"\n    viewBox="0 0 24 24"\n  >\n    <circle\n      class="opacity-25"\n      cx="12"\n      cy="12"\n      r="10"\n      stroke="currentColor"\n      stroke-width="4"\n    ></circle>\n    <path\n      class="opacity-75"\n      fill="currentColor"\n      d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"\n    ></path>\n  </svg>\n</span>\n',standalone:!0,styles:[spinning_loader_componentngResource_default()]})],SpinningLoaderComponent)},"./libs/util/data-fetcher/src/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Vw:()=>BaseFileReader,fk:()=>model_FetchError,S5:()=>SupportedTypes,PJ:()=>getJsonDataItemsProxy,Jp:()=>openDataset});var asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js");class model_FetchError{constructor(type,info,httpStatus=0){this.type=type,this.info=info,this.httpStatus=httpStatus,this.stack=null,this.message=`An error happened in the data fetcher, type: ${type}, info: ${info}`}static http(code,body){return new model_FetchError("http",body?`Error ${code}\n${body}`:`${code}`,code)}static forbidden(code){return new model_FetchError("forbidden","",code)}static corsOrNetwork(message){return new model_FetchError("network",message,0)}static parsingFailed(info){return new model_FetchError("parse",info,0)}static unsupportedType(mimeType){return new model_FetchError("unsupportedType",mimeType,0)}static unknownType(){return new model_FetchError("unknown","",0)}}const SupportedTypes=["csv","json","geojson","excel","gml","wfs"],AllMimeTypes={csv:["text/csv","application/csv"],json:["application/json"],geojson:["application/geo+json","application/vnd.geo+json"],excel:["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],gml:["application/gml+xml"]};var papaparse_min=__webpack_require__("./node_modules/papaparse/papaparse.min.js"),dist_node=__webpack_require__("./node_modules/@camptocamp/ogc-client/dist/dist-node.js"),parse=__webpack_require__("./node_modules/date-fns/parse.js"),parseISO=__webpack_require__("./node_modules/date-fns/parseISO.js");function _inferDatasetType(){return(_inferDatasetType=(0,asyncToGenerator.A)(function*(url,typeHint){const fileExtensionMatches=new URL(url,"undefined"!=typeof window?window.location.toString():void 0).pathname.match(/\.(.+)$/),fileExtension=fileExtensionMatches&&fileExtensionMatches.length?fileExtensionMatches[1].toLowerCase():null;if(typeHint)return Promise.resolve(typeHint);const headers=yield function fetchHeaders(url){return(0,dist_node.cB)(url,"HEAD").catch(error=>{throw model_FetchError.corsOrNetwork(error.message)}).then(response=>{if(!response.ok)throw model_FetchError.http(response.status);return function headers_parseHeaders(httpHeaders){const result={};if(httpHeaders.has("Content-Type")){result.mimeType=httpHeaders.get("Content-Type").split(";")[0];const supported=SupportedTypes.filter(type=>"wfs"!==type).filter(type=>AllMimeTypes[type].indexOf(result.mimeType)>-1)[0]||null;null!==supported&&(result.supportedType=supported)}if(httpHeaders.has("Content-Length")&&(result.fileSizeBytes=parseInt(httpHeaders.get("Content-Length"))),httpHeaders.has("Last-Modified")){const date=new Date(httpHeaders.get("Last-Modified"));Number.isNaN(date.valueOf())?result.lastUpdateInvalid=!0:result.lastUpdate=date}return result}(response.headers)})}(url);if("supportedType"in headers)return headers.supportedType;if(SupportedTypes.indexOf(fileExtension)>-1)return fileExtension;throw"mimeType"in headers?model_FetchError.unsupportedType(headers.mimeType):model_FetchError.unknownType()})).apply(this,arguments)}function fetchDataAsText(url,cacheActive){const fetchFactory=()=>(0,dist_node.cB)(url).catch(error=>{throw model_FetchError.corsOrNetwork(error.message)}).then(function(){var _ref=(0,asyncToGenerator.A)(function*(response){if(!response.ok){const clonedResponse=response.clone();throw model_FetchError.http(response.status,yield clonedResponse.text())}return response.clone().text()});return function(_x3){return _ref.apply(this,arguments)}}());return cacheActive?(0,dist_node.E6)(fetchFactory,url,"asText"):fetchFactory()}function tryParseDate(input){if("string"!=typeof input)return null;function tryFormat(value,format){const parsed=(0,parse.qg)(value,format,new Date);return isNaN(parsed.getDate())?null:parsed}return function tryIso(value){const parsed=(0,parseISO.H)(value);return isNaN(parsed.getDate())?null:parsed}(input)||tryFormat(input,"dd/MM/yyyy")||tryFormat(input,"dd.MM.yyyy")||tryFormat(input,"MM/dd/yyyy")||null}function tryParseNumber(input){if(isNaN(input))return null;const parsed=parseFloat(input);return isNaN(parsed)?null:parsed}function jsonToGeojsonFeature(object){const{id,properties}=Object.keys(object).map(property=>property||"unknown").reduce((prev,curr)=>curr.toLowerCase().endsWith("id")?{...prev,id:object[curr]}:{...prev,properties:{...prev.properties,[curr]:object[curr]}},{id:void 0,properties:{}});return{type:"Feature",geometry:null,properties,...void 0!==id&&{id}}}function processItemProperties(items,inferTypes=!1){const foundFields={};for(let i=0,ii=Math.min(20,items.length);i<ii;i++){const item=items[i],fields=Object.keys(item.properties);for(const field of fields){field in foundFields||(foundFields[field]={label:field,name:field,type:null});const value=item.properties[field],info=foundFields[field];if(void 0===value||""===value||null===value)continue;if(!inferTypes){null===info.type&&"number"==typeof value?info.type="number":"number"===info.type&&"number"!=typeof value&&(info.type="string");continue}const parsedNumber=tryParseNumber(value);if(null===info.type&&null!==parsedNumber){info.type="number";continue}if("number"===info.type&&null===parsedNumber){info.type="string";continue}const parsedDate=tryParseDate(value);null===info.type&&null!==parsedDate?info.type="date":"date"===info.type&&null===parsedDate&&(info.type="string")}}const properties=[],mutators={};for(const field in foundFields){const info=foundFields[field];"number"===info.type?mutators[field]=tryParseNumber:"date"===info.type&&(mutators[field]=tryParseDate),properties.push({...info,type:info.type||"string"})}return inferTypes&&function mutateProperties(items,mutators){const mutatorKeys=Object.keys(mutators);for(let i=0,ii=items.length;i<ii;i++){const item=items[i];for(const mutatorField of mutatorKeys)mutatorField in item.properties&&(item.properties[mutatorField]=mutators[mutatorField](item.properties[mutatorField]))}return items}(items,mutators),{items,properties}}function getJsonDataItemsProxy(items){return new Proxy(items,{get:(target,p)=>"string"==typeof p&&!Number.isNaN(parseInt(p))&&target[p]?.properties?target[p].properties:target[p],set(){throw new Error("This object is read-only")}})}function filterToSql(filter){const operator=filter[0],args=filter.slice(1);function valueToSql(value){return"number"==typeof value?value:`'${value}'`}switch(operator){case"<":case"<=":case">":case">=":case"=":case"!=":case"like":return`[${args[0]}] ${operator.toUpperCase()} ${valueToSql(args[1])}`;case"in":{const values=args.slice(1);return`[${args[0]}] IN (${values.map(valueToSql).join(", ")})`}case"and":case"or":return`(${args.map(filterToSql).join(` ${operator.toUpperCase()} `)})`;case"not":return`NOT (${filterToSql(args[0])})`}throw new Error(`Could not generate SQL query, operator not recognized: ${operator}`)}function aggregationToSql(aggregation){const operation=aggregation[0],field=aggregation[1];switch(operation){case"average":return`AVG([${field}]) as [average(${field})]`;case"sum":case"max":case"min":return`${operation.toUpperCase()}([${field}]) as [${operation}(${field})]`;case"count":return"COUNT(*) as [count()]"}}function generateSqlQuery(selected=null,filter=null,sort=null,startIndex=null,count=null,groupBy=null,aggregations=null){let sqlSelect="SELECT *";let sqlOrderBy="",sqlWhere="",sqlLimit="",sqlGroupBy="";if(null!==selected&&(sqlSelect=`SELECT ${selected.map(name=>`[${name}]`).join(", ")}`),null!==filter&&(sqlWhere=` WHERE ${filterToSql(filter)}`),sort?.length&&(sqlOrderBy=` ORDER BY ${sort.map(sort=>`[${sort[1]}] ${sort[0].toUpperCase()}`).join(", ")}`),null!==startIndex&&null!==count&&(sqlLimit=` LIMIT ${count} OFFSET ${startIndex}`),null!==groupBy&&null!==aggregations){sqlSelect=`SELECT ${aggregations.map(aggregationToSql).join(", ")}`;const groupedByDistinct=groupBy.filter(group=>"distinct"===group[0]),sqlGroupByFields=groupedByDistinct.map(group=>`[${group[1]}]`).join(", "),sqlGroupBySelect=groupedByDistinct.map(group=>`[${group[1]}] as [distinct(${group[1]})]`).join(", ");sqlGroupByFields&&sqlGroupBySelect&&(sqlGroupBy=` GROUP BY ${sqlGroupByFields}`,sqlSelect+=`, ${sqlGroupBySelect}`)}return sqlSelect+" FROM ?"+sqlGroupBy+sqlOrderBy+sqlWhere+sqlLimit}class BaseReader{constructor(url){this.url=url,this.selected=null,this.groupedBy=null,this.aggregations=null,this.filter=null,this.sort=null,this.startIndex=null,this.count=null}load(){throw new Error("not implemented")}get properties(){throw new Error("not implemented")}get info(){throw new Error("not implemented")}read(){throw new Error("not implemented")}selectAll(){return this.groupedBy=null,this.aggregations=null,this.selected=null,this.filter=null,this.startIndex=null,this.count=null,this}select(...selectedFields){return this.selected=selectedFields,this.aggregations=null,this.groupedBy=null,this}groupBy(...groupBy){return this.groupedBy=groupBy,this.selected=null,this}aggregate(...aggregations){return this.aggregations=aggregations,this}where(filter){return this.filter=filter,this}orderBy(...fieldSorts){return this.sort=fieldSorts,this}limit(startIndex,count){return this.startIndex=startIndex,this.count=count,this}}class BaseCacheReader extends BaseReader{constructor(url,cacheActive=!0){super(url),this.url=url,this.cacheActive=cacheActive}setCacheActive(value){this.cacheActive=value}}class BaseFileReader extends BaseCacheReader{getData(){throw new Error("not implemented")}load(){this.parseResult_=this.getData()}get properties(){return this.parseResult_.then(result=>result.properties)}get info(){return this.parseResult_.then(result=>({itemsCount:result.items.length}))}read(){var _this=this;return(0,asyncToGenerator.A)(function*(){const items=(yield _this.parseResult_).items;if(null==_this.groupedBy&&null==_this.aggregations&&null==_this.selected&&null==_this.sort&&null==_this.filter&&null==_this.startIndex&&null==_this.count)return items;const jsonItems=getJsonDataItemsProxy(items),query=generateSqlQuery(_this.selected,_this.filter,_this.sort,_this.startIndex,_this.count,_this.groupedBy,_this.aggregations);return(yield __webpack_require__.e(6046).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/alasql/dist/alasql.min.js",23)).then(module=>module.default(query,[jsonItems]))).map(jsonToGeojsonFeature)})()}}function parseCsv(text){let delimiter;try{const header=text.split("\n")[0];delimiter=papaparse_min.parse(header,{header:!1}).meta.delimiter}catch(e){throw new Error("CSV parsing failed: the delimiter could not be guessed")}const parsed=papaparse_min.parse(text,{header:!0,skipEmptyLines:!0,delimiter});if(parsed.errors.length)throw new Error("CSV parsing failed for the following reasons:\n"+parsed.errors.map(error=>`* ${error.message} at row ${error.row}, column ${error.index}`).join("\n"));return processItemProperties(parsed.data.map(jsonToGeojsonFeature),!0)}class CsvReader extends BaseFileReader{getData(){return fetchDataAsText(this.url,this.cacheActive).then(parseCsv)}}function parseJson(text){const parsed=JSON.parse(text);if(!Array.isArray(parsed))throw new Error("Could not parse JSON, expected an array at root level");return processItemProperties(parsed.map(jsonToGeojsonFeature))}class JsonReader extends BaseFileReader{getData(){return fetchDataAsText(this.url,this.cacheActive).then(parseJson)}}function parseGeojson(text){const parsed=JSON.parse(text),features="FeatureCollection"===parsed.type?parsed.features:parsed;if(!Array.isArray(features))throw new Error("Could not parse GeoJSON, expected a features collection or an array of features at root level");return processItemProperties(features)}class GeojsonReader extends BaseFileReader{getData(){return fetchDataAsText(this.url,this.cacheActive).then(parseGeojson)}}function parseExcel(buffer){return __webpack_require__.e(6793).then(__webpack_require__.bind(__webpack_require__,"./node_modules/xlsx/xlsx.mjs")).then(({read,utils})=>{const workbook=read(buffer),sheet=workbook.Sheets[workbook.SheetNames[0]];let json=utils.sheet_to_json(sheet);return json.length||(json=[]),processItemProperties(json.map(jsonToGeojsonFeature),!0)})}class ExcelReader extends BaseFileReader{getData(){return function fetchDataAsArrayBuffer(url,cacheActive){const fetchFactory=()=>(0,dist_node.cB)(url).catch(error=>{throw model_FetchError.corsOrNetwork(error.message)}).then(function(){var _ref2=(0,asyncToGenerator.A)(function*(response){if(!response.ok)throw model_FetchError.http(response.status,yield response.text());return Array.from(new Uint8Array(yield response.arrayBuffer()))});return function(_x4){return _ref2.apply(this,arguments)}}());return(cacheActive?(0,dist_node.E6)(fetchFactory,url,"asArrayBuffer"):fetchFactory()).then(array=>new Uint8Array(array).buffer)}(this.url,this.cacheActive).then(parseExcel)}}var WFS=__webpack_require__("./node_modules/ol/format/WFS.js"),GeoJSON=__webpack_require__("./node_modules/ol/format/GeoJSON.js");function parseGml(text,namespace,version){const splittedNamespace=namespace.split(":"),match=new RegExp(`xmlns:${splittedNamespace[0]}=["']([^'"]*)["']`).exec(text);if(match&&match.length>=2){const wf=new WFS.A({featureNS:match[1],featureType:splittedNamespace[1],version});let features;try{features=wf.readFeatures(text)}catch(e){throw Error("Couldn't parse WFS with GML features")}return processItemProperties((new GeoJSON.A).writeFeaturesObject(features).features,!0)}throw Error("Couldn't retrieve namespace url")}class GmlReader extends BaseFileReader{constructor(url,namespace,version,cacheActive=!0){super(url),this.url=url,this.namespace=namespace,this.version=version,this.cacheActive=cacheActive}getData(){return fetchDataAsText(this.url,this.cacheActive).then(text=>parseGml(text,this.namespace,this.version))}}function _getWfsEndpoint(){return(_getWfsEndpoint=(0,asyncToGenerator.A)(function*(wfsUrl){try{return yield new dist_node.ym(wfsUrl).isReady()}catch(e){if(e instanceof Error&&"isCrossOriginRelated"in e&&"httpStatus"in e){const error=e;if(!0===error.isCrossOriginRelated)throw new Error("wfs.unreachable.cors");throw 401===error.httpStatus||403===error.httpStatus?model_FetchError.forbidden(error.httpStatus):400===error.httpStatus||error.httpStatus>403?model_FetchError.http(error.httpStatus):model_FetchError.unknownType()}throw model_FetchError.unknownType()}})).apply(this,arguments)}class WfsReader extends BaseCacheReader{constructor(url,wfsEndpoint,featureTypeName,cacheActive){super(url,cacheActive),this.endpoint=wfsEndpoint,this.featureTypeName=featureTypeName,this.version=this.endpoint.getVersion()}get properties(){return this.endpoint.getFeatureTypeFull(this.featureTypeName).then(featureType=>Object.keys(featureType.properties).map(prop=>{const originalType=featureType.properties[prop];return{name:prop,label:prop,type:"float"===originalType||"integer"===originalType?"number":originalType}}))}get info(){return this.endpoint.getFeatureTypeFull(this.featureTypeName).then(result=>({itemsCount:result.objectCount}))}static createReader(wfsUrlEndpoint,featureTypeName){return(0,asyncToGenerator.A)(function*(){const wfsEndpoint=yield function getWfsEndpoint(_x){return _getWfsEndpoint.apply(this,arguments)}(wfsUrlEndpoint),featureTypes=wfsEndpoint.getFeatureTypes(),featureType=wfsEndpoint.getFeatureTypeSummary(1!==featureTypes.length||featureTypeName?featureTypeName:featureTypes[0].name);if(!featureType)throw new Error("wfs.featuretype.notfound");if(wfsEndpoint.supportsStartIndex())return new WfsReader(wfsUrlEndpoint,wfsEndpoint,featureType.name);if(wfsEndpoint.supportsJson(featureType.name))return new GeojsonReader(wfsEndpoint.getFeatureUrl(featureType.name,{asJson:!0,outputCrs:"EPSG:4326"}));if(featureType.outputFormats.find(f=>f.toLowerCase().includes("gml"))&&("EPSG:4326"===featureType.defaultCrs||featureType.otherCrs?.includes("EPSG:4326")))return new GmlReader(wfsEndpoint.getFeatureUrl(featureType.name,{outputFormat:featureType.outputFormats.find(f=>f.toLowerCase().includes("gml")),outputCrs:"EPSG:4326"}),featureType.name,wfsEndpoint.getVersion());throw new Error("wfs.geojsongml.notsupported")})()}getData(aggregation,groupedBy){var _this=this;return(0,asyncToGenerator.A)(function*(){if(aggregation||groupedBy)return{items:yield _this.getQueryData()};const asJson=_this.endpoint.supportsJson(_this.featureTypeName),attributes=_this.selected??void 0;let url=_this.endpoint.getFeatureUrl(_this.featureTypeName,{...null!==_this.startIndex&&{startIndex:_this.startIndex},...null!==_this.count&&{maxFeatures:_this.count},asJson,outputCrs:"EPSG:4326",attributes});if(Array.isArray(_this.sort)&&_this.sort.length>0){const finalUrl=new URL(url),sorts=_this.sort.map(fieldSort=>`${fieldSort[1]}+${"asc"===fieldSort[0]?"A":"D"}`).join(",");url=`${url}${finalUrl.search?"&":""}SORTBY=${sorts}`}return fetchDataAsText(url,_this.cacheActive).then(text=>asJson?parseGeojson(text):parseGml(text,_this.featureTypeName,_this.version))})()}getQueryData(){var _this2=this;return(0,asyncToGenerator.A)(function*(){const jsonItems=getJsonDataItemsProxy((yield _this2.getData()).items),query=generateSqlQuery(_this2.selected,_this2.filter,_this2.sort,_this2.startIndex,_this2.count,_this2.groupedBy,_this2.aggregations);return(yield __webpack_require__.e(6046).then(__webpack_require__.t.bind(__webpack_require__,"./node_modules/alasql/dist/alasql.min.js",23)).then(module=>module.default(query,[jsonItems]))).map(jsonToGeojsonFeature)})()}load(){}read(){var _this3=this;return(0,asyncToGenerator.A)(function*(){return(yield _this3.getData(_this3.aggregations,_this3.groupedBy)).items})()}}function openDataset(_x,_x2,_x3,_x4){return _openDataset.apply(this,arguments)}function _openDataset(){return _openDataset=(0,asyncToGenerator.A)(function*(url,typeHint,options,cacheActive){const fileType=yield function inferDatasetType(_x,_x2){return _inferDatasetType.apply(this,arguments)}(url,typeHint);let reader;try{switch(fileType){case"csv":reader=new CsvReader(url);break;case"json":reader=new JsonReader(url);break;case"geojson":reader=new GeojsonReader(url);break;case"excel":reader=new ExcelReader(url);break;case"gml":reader=new GmlReader(url,options.namespace,options.wfsVersion);break;case"wfs":reader=yield WfsReader.createReader(url,options.wfsFeatureType)}return reader.setCacheActive(cacheActive),reader.load(),reader}catch(e){throw e instanceof model_FetchError?e:model_FetchError.parsingFailed(e.message)}}),_openDataset.apply(this,arguments)}},"./node_modules/@angular/cdk/fesm2022/selection-model.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{C:()=>SelectionModel});var rxjs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subject.js");class SelectionModel{_multiple;_emitChanges;compareWith;_selection=new Set;_deselectedToEmit=[];_selectedToEmit=[];_selected;get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}changed=new rxjs__WEBPACK_IMPORTED_MODULE_0__.B;constructor(_multiple=!1,initiallySelectedValues,_emitChanges=!0,compareWith){this._multiple=_multiple,this._emitChanges=_emitChanges,this.compareWith=compareWith,initiallySelectedValues&&initiallySelectedValues.length&&(_multiple?initiallySelectedValues.forEach(value=>this._markSelected(value)):this._markSelected(initiallySelectedValues[0]),this._selectedToEmit.length=0)}select(...values){this._verifyValueAssignment(values),values.forEach(value=>this._markSelected(value));const changed=this._hasQueuedChanges();return this._emitChangeEvent(),changed}deselect(...values){this._verifyValueAssignment(values),values.forEach(value=>this._unmarkSelected(value));const changed=this._hasQueuedChanges();return this._emitChangeEvent(),changed}setSelection(...values){this._verifyValueAssignment(values);const oldValues=this.selected,newSelectedSet=new Set(values.map(value=>this._getConcreteValue(value)));values.forEach(value=>this._markSelected(value)),oldValues.filter(value=>!newSelectedSet.has(this._getConcreteValue(value,newSelectedSet))).forEach(value=>this._unmarkSelected(value));const changed=this._hasQueuedChanges();return this._emitChangeEvent(),changed}toggle(value){return this.isSelected(value)?this.deselect(value):this.select(value)}clear(flushEvent=!0){this._unmarkAll();const changed=this._hasQueuedChanges();return flushEvent&&this._emitChangeEvent(),changed}isSelected(value){return this._selection.has(this._getConcreteValue(value))}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(predicate){this._multiple&&this.selected&&this._selected.sort(predicate)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(value){value=this._getConcreteValue(value),this.isSelected(value)||(this._multiple||this._unmarkAll(),this.isSelected(value)||this._selection.add(value),this._emitChanges&&this._selectedToEmit.push(value))}_unmarkSelected(value){value=this._getConcreteValue(value),this.isSelected(value)&&(this._selection.delete(value),this._emitChanges&&this._deselectedToEmit.push(value))}_unmarkAll(){this.isEmpty()||this._selection.forEach(value=>this._unmarkSelected(value))}_verifyValueAssignment(values){if(values.length>1&&!this._multiple&&("undefined"==typeof ngDevMode||ngDevMode))throw function getMultipleValuesInSingleSelectionError(){return Error("Cannot pass multiple values into SelectionModel with single-value mode.")}()}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}_getConcreteValue(inputValue,selection){if(this.compareWith){selection=selection??this._selection;for(let selectedValue of selection)if(this.compareWith(inputValue,selectedValue))return selectedValue;return inputValue}return inputValue}}},"./node_modules/@angular/material/fesm2022/tooltip-module.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{u:()=>MatTooltipModule});var _angular_core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/core/fesm2022/root_effect_scheduler.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@angular/core/fesm2022/debug_node.mjs"),_angular_cdk_a11y__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@angular/cdk/fesm2022/a11y-module.mjs"),_angular_cdk_overlay__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@angular/cdk/fesm2022/overlay-module.mjs"),_angular_cdk_scrolling__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@angular/cdk/fesm2022/scrolling.mjs"),_tooltip2_mjs__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@angular/material/fesm2022/tooltip2.mjs"),_common_module_mjs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@angular/material/fesm2022/common-module.mjs");class MatTooltipModule{static Éµfac=function MatTooltipModule_Factory(__ngFactoryType__){return new(__ngFactoryType__||MatTooltipModule)};static Éµmod=_angular_core__WEBPACK_IMPORTED_MODULE_1__.$C({type:MatTooltipModule,imports:[_angular_cdk_a11y__WEBPACK_IMPORTED_MODULE_2__.Pd,_angular_cdk_overlay__WEBPACK_IMPORTED_MODULE_3__.z_,_common_module_mjs__WEBPACK_IMPORTED_MODULE_6__.y,_tooltip2_mjs__WEBPACK_IMPORTED_MODULE_5__.oV,_tooltip2_mjs__WEBPACK_IMPORTED_MODULE_5__.b6],exports:[_tooltip2_mjs__WEBPACK_IMPORTED_MODULE_5__.oV,_tooltip2_mjs__WEBPACK_IMPORTED_MODULE_5__.b6,_common_module_mjs__WEBPACK_IMPORTED_MODULE_6__.y,_angular_cdk_scrolling__WEBPACK_IMPORTED_MODULE_4__.Gj]});static Éµinj=_angular_core__WEBPACK_IMPORTED_MODULE_0__.G2t({providers:[_tooltip2_mjs__WEBPACK_IMPORTED_MODULE_5__.YZ],imports:[_angular_cdk_a11y__WEBPACK_IMPORTED_MODULE_2__.Pd,_angular_cdk_overlay__WEBPACK_IMPORTED_MODULE_3__.z_,_common_module_mjs__WEBPACK_IMPORTED_MODULE_6__.y,_common_module_mjs__WEBPACK_IMPORTED_MODULE_6__.y,_angular_cdk_scrolling__WEBPACK_IMPORTED_MODULE_4__.Gj]})}("undefined"==typeof ngDevMode||ngDevMode)&&_angular_core__WEBPACK_IMPORTED_MODULE_1__.cDI(MatTooltipModule,[{type:_angular_core__WEBPACK_IMPORTED_MODULE_1__.UQu,args:[{imports:[_angular_cdk_a11y__WEBPACK_IMPORTED_MODULE_2__.Pd,_angular_cdk_overlay__WEBPACK_IMPORTED_MODULE_3__.z_,_common_module_mjs__WEBPACK_IMPORTED_MODULE_6__.y,_tooltip2_mjs__WEBPACK_IMPORTED_MODULE_5__.oV,_tooltip2_mjs__WEBPACK_IMPORTED_MODULE_5__.b6],exports:[_tooltip2_mjs__WEBPACK_IMPORTED_MODULE_5__.oV,_tooltip2_mjs__WEBPACK_IMPORTED_MODULE_5__.b6,_common_module_mjs__WEBPACK_IMPORTED_MODULE_6__.y,_angular_cdk_scrolling__WEBPACK_IMPORTED_MODULE_4__.Gj],providers:[_tooltip2_mjs__WEBPACK_IMPORTED_MODULE_5__.YZ]}]}],null,null)},"./node_modules/rxjs/dist/esm5/internal/firstValueFrom.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{_:()=>firstValueFrom});var _util_EmptyError__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/util/EmptyError.js"),_Subscriber__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/Subscriber.js");function firstValueFrom(source,config){var hasConfig="object"==typeof config;return new Promise(function(resolve,reject){var subscriber=new _Subscriber__WEBPACK_IMPORTED_MODULE_1__.Ms({next:function(value){resolve(value),subscriber.unsubscribe()},error:reject,complete:function(){hasConfig?resolve(config.defaultValue):reject(new _util_EmptyError__WEBPACK_IMPORTED_MODULE_0__.G)}});source.subscribe(subscriber)})}}}]);