<div class="flex items-center mb-5">
  <gn-ui-text-input
    [(value)]="wmsUrl"
    (valueChange)="urlChange.next($event)"
    [placeholder]="'map.wms.urlInput.hint' | translate"
    class="w-96"
  >
  </gn-ui-text-input>
</div>

@if (errorMessage) {
  <div class="text-red-500 mt-2">
    {{ errorMessage }}
  </div>
}

@if (loading) {
  <div>
    <p class="loading-message" translate>map.loading.service</p>
  </div>
}

@if (!loading && layers.length > 0) {
  <div>
    <h2 class="font-bold" translate>map.layers.available</h2>
    @for (layer of layers; track layer) {
      <ng-container
        [ngTemplateOutlet]="layerTreeItem"
        [ngTemplateOutletContext]="{
          layer: layer,
        }"
      ></ng-container>
    }
  </div>
}

<ng-template #layerTreeItem let-layer="layer">
  <div class="flex items-center justify-between layer-tree-item my-2">
    <p class="max-w-xs overflow-hidden overflow-ellipsis whitespace-nowrap">
      {{ layer.title }}
    </p>
    @if (layer.name) {
      <gn-ui-button
        class="layer-add-btn"
        type="primary"
        (buttonClick)="addLayer(layer)"
        extraClass="text-sm !px-2 !py-1"
        translate
        ><span translate> map.layer.add </span></gn-ui-button
      >
    }
  </div>
  @if (layer.children?.length > 0) {
    <div class="ml-4">
      @for (child of layer.children; track child) {
        <ng-container
          [ngTemplateOutlet]="layerTreeItem"
          [ngTemplateOutletContext]="{
            layer: child,
          }"
        >
        </ng-container>
      }
    </div>
  }
</ng-template>
