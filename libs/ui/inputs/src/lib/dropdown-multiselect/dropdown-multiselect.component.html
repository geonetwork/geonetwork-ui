<div
  [attr.aria-owns]="'todo'"
  (click)="panelOpen = true"
  cdkOverlayOrigin
  #overlayOrigin="cdkOverlayOrigin"
>
  <span class="">{{ title }}</span>
  <div>
    <!-- Use an inline SVG, because it works better than a CSS triangle in high contrast mode. -->
    <svg viewBox="0 0 24 24" width="24px" height="24px" focusable="false">
      <path d="M7 10l5 5 5-5z" />
    </svg>
  </div>
</div>

<ng-template
  cdkConnectedOverlay
  cdkConnectedOverlayLockPosition
  cdkConnectedOverlayHasBackdrop
  cdkConnectedOverlayBackdropClass="cdk-overlay-transparent-backdrop"
  [cdkConnectedOverlayOrigin]="overlayOrigin"
  [cdkConnectedOverlayOpen]="panelOpen"
  [cdkConnectedOverlayPositions]="overlayPositions"
  [cdkConnectedOverlayWidth]="'400px'"
  (backdropClick)="panelOpen = false"
  (attach)="attach()"
  (detach)="detach()"
>
  <div
    #panel
    class="bg-white border border-grey-400 p-3 shadow-lg rounded"
    role="listbox"
    tabindex="-1"
    [attr.id]="'todo'"
    [attr.aria-multiselectable]="true"
    [attr.aria-label]="'todo'"
    [attr.aria-labelledby]="'todo'"
    (keydown)="handleKeyDown($event)"
  >
    <div *ngFor="let choice of choices">
      <mat-checkbox
        [aria-label]="'todo'"
        [checked]="isSelected(choice)"
        (change)="select(choice, $event)"
      >
        {{ choice.label }}
      </mat-checkbox>
    </div>
  </div>
</ng-template>
